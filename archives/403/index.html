<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="max-image-preview:large">
<title>åœ¨ x86 ä¸Šæ„å»º Linux L3 äº¤æ¢æœº/è·¯ç”±å™¨ - éƒ­æ™ºæ»¡çš„éƒ¨è½ï¼</title>
<meta name="description" content="ç¬¬ 1 éƒ¨åˆ† - ä»‹ç» 1.&nbsp;æ„å»º L3 äº¤æ¢æœºçš„æ•™ç¨‹éƒ½æä¾›äº†ä»€ä¹ˆå†…å®¹ï¼Ÿ å¦ç™½åœ°è¯´ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨æƒ³å­¦ä¹ å¦‚ä½•ä»å¤´å¼€å§‹æ„å»ºæˆ‘ä»¬è‡ªå·±çš„ Linux&nbsp;å¤šå±‚äº¤æ¢æœº/è·¯ç”±å™¨ï¼Œæ¥ä¸‹æ¥çš„å‡ ä¸ªæ•™ç¨‹å¯èƒ½ä¼šå¯¹æ‚¨...">
<link rel="dns-prefetch" href="//at.alicdn.com">
<link rel="stylesheet" id="wp-block-library-css" href="/wp-includes/css/dist/block-library/style.min.css?ver=6.6" type="text/css" media="all">
<style id="classic-theme-styles-inline-css" type="text/css">/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}</style>
<style id="global-styles-inline-css" type="text/css">:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}</style>
<link rel="stylesheet" id="cxm2-bootstrap-css" href="/wp-content/themes/meteor/assets/css/bootstrap.min.css?ver=1.2" type="text/css" media="all">
<link rel="stylesheet" id="cxm2-swiper-css" href="/wp-content/themes/meteor/assets/css/swiper-bundle.min.css?ver=1.2" type="text/css" media="all">
<link rel="stylesheet" id="cxm2-icons-css" href="//at.alicdn.com/t/c/font_1989294_lbwlt58uzfn.css?ver=1.2" type="text/css" media="all">
<link rel="stylesheet" id="cxm2-main-css" href="/wp-content/themes/meteor/style.css?ver=1.2" type="text/css" media="all">
<style id="cxm2-main-inline-css" type="text/css">:root, [data-bs-theme=light]{ --bs-link-hover-color:#fe4f70; --cbg-color:#fe5872; --cbg-gradient:var(--cx-gradient-rad); } [data-bs-theme=dark] { --bs-link-hover-color: #fe4f70; }</style>
<link rel="canonical" href="/archives/403">
</head>

<body class="post-template-default single single-post postid-403 single-format-standard cxtheme-body cxtheme-width-theme" x-data="MeteorData" :data-bs-theme="darkMode ? 'dark' : ''" :class="{'dark': darkMode,'overflow-y-hidden':popBgshow || searchPopup}">
    <div class="site-wrapper">
        <header class="header-s1" :class="{'onfixed' : searchPopup}">
            <div class="headnav">
                <div class="container-xl h-container">
                    <div class="cxlogo">
                                                <a href="/">
                            <img src="http://www.guozhiman.top/wp-content/uploads/2024/07/202406201718847016352278-1.png" alt="éƒ­æ™ºæ»¡çš„éƒ¨è½ï¼" class="c-light" width="120" height="60">
                            <img src="http://www.guozhiman.top/wp-content/uploads/2024/07/202406201718847016352278-2.png" alt="éƒ­æ™ºæ»¡çš„éƒ¨è½ï¼" class="c-dark" width="120" height="60">
                        </a>
                    </div>
                    <nav class="head-menu d-lg-flex">
                        <ul id="menu-main-menu" class="navbar-nav">
                        <li class="menu-item"><a href="/archives/category/meirifenxiang">æ¯æ—¥åˆ†äº«</a></li>
<li class="menu-item"><a href="/archives/category/qianduan">å‰ç«¯</a></li>
<li class="menu-item"><a href="/archives/category/kaiyuan">å¼€æº</a></li>
<li class="menu-item"><a href="/archives/category/docker">Docker</a></li>
<li class="menu-item current-post-ancestor current-menu-parent"><a href="/archives/category/%e6%8a%80%e6%9c%af%e6%96%87%e7%ab%a0">æŠ€æœ¯æ–‡ç« </a></li>
<li class="menu-item"><a href="/archives/category/wangluoanquan">ç½‘ç»œå®‰å…¨</a></li>
<li class="menu-item menu-has-children">
<a href="/archives/category/caozuoxitong">æ“ä½œç³»ç»Ÿ <i class="cxicon cxicon-chevron-down menu-children-icon"></i></a>
<ul class="sub-menu">
	<li class="menu-item"><a href="/archives/category/caozuoxitong/windows">Winç³»ç»Ÿ</a></li>
	<li class="menu-item"><a href="/archives/category/caozuoxitong/linuxunix">Linux/Unix</a></li>
	<li class="menu-item"><a href="/archives/category/caozuoxitong/guochanxitong">å›½äº§ç³»ç»Ÿ</a></li>
</ul>
</li>
                        </ul>
                    </nav>
                    <div class="header-r">
                        <ul class="h-btnbox sm-cnone">
                            <li class="list-inline-item">
                                <a href="/archives/403">
                                    <i class="cxicon cxicon-ranking"></i>
                                </a>
                            </li>
                            <li class="list-inline-item">
                                <a href="javascript:;" @click="darkMode = !darkMode;localStorage.setItem('darkMode', darkMode);">
                                    <i class="cxicon cxicon-sunlight" :class="{'d-none':darkMode}"></i>
                                    <i class="cxicon cxicon-moon" :class="{'d-none':!darkMode}"></i>
                                </a>
                            </li>
                        </ul>
                        <div class="h-buttons">
                            <button type="button" class="search btn-default icon-button" @click="searchPopup = !searchPopup" title="Search Btn">
                                <i class="cxicon cxicon-search font-inherit" :class=" searchPopup ? 'cxicon-error' : 'cxicon-search'"></i>
                            </button>
                            <!-- ç§»åŠ¨ç«¯èœå• -->
                            <button type="button" class="search btn-default icon-button" @click="moibleMenu = popBgshow = true" title="Menu Btn">
                                <i class="cxicon cxicon-menu3 font-inherit"></i>
                            </button>
                        </div>
                    </div>

                </div>
            </div>            
        </header><!-- header.end-->
        <!-- Moible Nav -->
        <div class="mobile-navbox trans_2ms" :class="{'visible': moibleMenu}">
            <button type="button" class="btn-close" aria-label="å…³é—­" @click="popBgshow = moibleMenu = false"></button>
            <div class="m-menulogo p-4 pt-3"></div>
            <div class="m-navbox p-4 pt-0">
                <ul id="moible-menu" class="m-nav pe-4">
                <li class="menu-item"><a href="/archives/category/meirifenxiang">æ¯æ—¥åˆ†äº«</a></li>
<li class="menu-item"><a href="/archives/category/qianduan">å‰ç«¯</a></li>
<li class="menu-item"><a href="/archives/category/kaiyuan">å¼€æº</a></li>
<li class="menu-item"><a href="/archives/category/docker">Docker</a></li>
<li class="menu-item current-post-ancestor current-menu-parent"><a href="/archives/category/%e6%8a%80%e6%9c%af%e6%96%87%e7%ab%a0">æŠ€æœ¯æ–‡ç« </a></li>
<li class="menu-item"><a href="/archives/category/wangluoanquan">ç½‘ç»œå®‰å…¨</a></li>
<li class="menu-item menu-has-children">
<a href="/archives/category/caozuoxitong">æ“ä½œç³»ç»Ÿ <i class="cxicon cxicon-chevron-down menu-children-icon"></i></a>
<ul class="sub-menu">
	<li class="menu-item"><a href="/archives/category/caozuoxitong/windows">Winç³»ç»Ÿ</a></li>
	<li class="menu-item"><a href="/archives/category/caozuoxitong/linuxunix">Linux/Unix</a></li>
	<li class="menu-item"><a href="/archives/category/caozuoxitong/guochanxitong">å›½äº§ç³»ç»Ÿ</a></li>
</ul>
</li>
                </ul>
            </div>
        </div>
        <!-- MN.end -->
        

        <main class="main-container" role="main">
<div class="banner trem-banner mb-4">
    <div class="container-xl">
        
            <nav class="breadcrumbs" aria-label="é¢åŒ…å±‘å¯¼èˆª">
                <ol class="breadcrumb flex-nowrap">
                
        <li class="item-home flex-shrink-0">
            <a href="/" title="éƒ­æ™ºæ»¡çš„éƒ¨è½ï¼">
                <span>é¦–é¡µ</span>
            </a>
        </li>

        <li class="item-category flex-shrink-0">
            <a href="/archives/category/%e6%8a%80%e6%9c%af%e6%96%87%e7%ab%a0" title="æŠ€æœ¯æ–‡ç« ">
                <span>æŠ€æœ¯æ–‡ç« </span>
            </a>
        </li>

        <li class="item-current line-one pe-4">
            <a href="/archives/403" title="åœ¨ x86 ä¸Šæ„å»º Linux L3 äº¤æ¢æœº/è·¯ç”±å™¨">
                <span>åœ¨ x86 ä¸Šæ„å»º Linux L3 äº¤æ¢æœº/è·¯ç”±å™¨</span>
            </a>
        </li>
                </ol>
            </nav>
                </div>
</div>
<!-- 3 -->
<section class="wi widget-coltow">
    <div class="container-xl">
        <div class="row cxrow">
            <div class="col-left">
                <div class="rowleft">
                    <div class="main-content pe-xl-4">
                        <article id="post-43" class="post is-single post-content status-publish" x-data="cxm2_Postmeta">
    <!-- æ–‡ç« æ ‡é¢˜ -->
    <header class="post-header">
        <h1 class="post-title mt-3 mb-4 fs-2">åœ¨ x86 ä¸Šæ„å»º Linux L3 äº¤æ¢æœº/è·¯ç”±å™¨</h1>        <!-- æ–‡ç« å…ƒä¿¡æ¯ï¼ˆå¦‚ä½œè€…ã€å‘å¸ƒæ—¶é—´ã€åˆ†ç±»ã€æ ‡ç­¾ç­‰ï¼‰ -->
        <div class="article-meta">
<ul class="meta-itembox">
<li class="list-inline-item"><a class="author me-0" href="/archives/author/guozhiman"><figure class="figure-avatar  btn-default userid-1"><img alt="" src="http://cn.cravatar.com/avatar/740a87cfff4579440e19183a73f02b68?s=30&#038;d=mm&#038;r=g" srcset="http://cn.cravatar.com/avatar/740a87cfff4579440e19183a73f02b68?s=60&#038;d=mm&#038;r=g 2x" class="avatar avatar-30 photo" height="30" width="30" decoding="async"></figure>guozhiman</a></li>
<li class="list-inline-item"><a href="/archives/category/%e6%8a%80%e6%9c%af%e6%96%87%e7%ab%a0" rel="category tag">æŠ€æœ¯æ–‡ç« </a></li>
<li class="list-inline-item">2024å¹´7æœˆ22æ—¥</li>
</ul>
</div>    </header>

    <!-- æ–‡ç« æ­£æ–‡ -->
    <div class="article-body mb-4">
        
<h1 class="wp-block-heading"><strong>ç¬¬ 1 éƒ¨åˆ† &#8211; ä»‹ç»</strong></h1>



<p><strong>1.&nbsp;</strong><strong>æ„å»º L3 äº¤æ¢æœºçš„æ•™ç¨‹éƒ½æä¾›äº†ä»€ä¹ˆå†…å®¹ï¼Ÿ</strong></p>



<p>å¦ç™½åœ°è¯´ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨æƒ³å­¦ä¹ å¦‚ä½•ä»å¤´å¼€å§‹æ„å»ºæˆ‘ä»¬è‡ªå·±çš„ Linux&nbsp;å¤šå±‚äº¤æ¢æœº/è·¯ç”±å™¨ï¼Œæ¥ä¸‹æ¥çš„å‡ ä¸ªæ•™ç¨‹å¯èƒ½ä¼šå¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ã€‚</p>



<p><strong>2.</strong><strong>&nbsp;</strong><strong>ä¸ºä»€ä¹ˆæˆ‘è¦èŠ±è´¹æ—¶é—´é˜…è¯»å‘¢ï¼Ÿ</strong></p>



<p>é¦–å…ˆï¼Œè¿™æ˜¯å…³äºè·å–çŸ¥è¯†ã€‚å³ä½¿æ‚¨æ˜¯ä¸€ä½ç»éªŒä¸°å¯Œçš„ Linux ç”¨æˆ·ï¼Œå…¶ä¸­ä¹Ÿæåˆ°å¹¶è§£å†³äº†ä¸€äº›é—®é¢˜ï¼Œå› æ­¤æ‚¨å¯ä»¥å­¦åˆ°ä¸€äº›æ–°ä¸œè¥¿ã€‚</p>



<p>å…¶æ¬¡ï¼Œæ²¡æœ‰äººå¼ºè¿«æ‚¨é˜…è¯» ğŸ˜‰</p>



<p><strong>3.&nbsp;</strong><strong>ä¸ºä»€ä¹ˆä¸ç”¨ VyOS ç­‰ Linux è·¯ç”±å™¨å‘è¡Œç‰ˆï¼Ÿ</strong></p>



<p>è¿™ä¹Ÿæ˜¯æ‚¨å¯ä»¥è€ƒè™‘çš„ä¸€ä¸ªé€‰é¡¹ã€‚VyOS æ˜¯ä¸€ä¸ªå¸¦æœ‰è‡ªå·±æ“ä½œç³»ç»Ÿçš„ä¸“ä¸šç½‘ç»œè·¯ç”±å™¨å‘è¡Œç‰ˆã€‚è¿è¡Œå®ƒæ›´å¤šçš„æ˜¯äº†è§£ç½‘ç»œçŸ¥è¯†ï¼Œè€Œä¸æ˜¯æ„å»ºè‡ªå·±çš„ Linux è·¯ç”±å™¨ã€‚</p>



<p><strong>4.</strong>&nbsp;<strong>OKï¼Œä½ å¼•èµ·äº†æˆ‘çš„æ³¨æ„ã€‚ä½ çš„è®¡åˆ’æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>



<p>ç¬¬ 1 éƒ¨åˆ† &#8211; ç®€ä»‹ã€ç¡¬ä»¶å’Œè½¯ä»¶è¦æ±‚</p>



<p>ç¬¬ 2 éƒ¨åˆ† &#8211; CentOS 6.0 å®‰è£…</p>



<p>ç¬¬ 3 éƒ¨åˆ† &#8211;&nbsp;æ— çº¿æ¥å…¥ç‚¹å®‰è£…å’Œé…ç½®</p>



<p>ç¬¬ 4 éƒ¨åˆ† &#8211; Openvswitch å®‰è£…å’Œé…ç½®</p>



<p>ç¬¬ 5 éƒ¨åˆ† &#8211; å°†ç›’å­è¿æ¥åˆ°äº’è”ç½‘ &#8211; PPPoE é…ç½®</p>



<p>ç¬¬ 6 éƒ¨åˆ† &#8211; å°†ç›’å­è¿æ¥åˆ°äº’è”ç½‘ &#8211; NAT å’Œé˜²ç«å¢™é…ç½®</p>



<p>ç¬¬ 7 éƒ¨åˆ† &#8211; DDNS å’Œ NTP æœåŠ¡å™¨å®‰è£…å’Œé…ç½®</p>



<p>ç¬¬ 8 éƒ¨åˆ† &#8211; DNS ç¼“å­˜æœåŠ¡å™¨å®‰è£…å’Œé…ç½®</p>



<p>ç¬¬ 9 éƒ¨åˆ† &#8211; DHCP æœåŠ¡å™¨å’Œ Samba æœåŠ¡å™¨å®‰è£…å’Œé…ç½®</p>



<p><strong>5.&nbsp;</strong><strong>æœ€å°ç¡¬ä»¶è¦æ±‚æ˜¯ä»€ä¹ˆï¼Ÿ</strong><strong></strong></p>



<p>ä¸€å°å¸¦æœ‰ä¸¤ä¸ªä»¥å¤ªç½‘å¡å’Œä¸€ä¸ªæ— çº¿ç½‘å¡çš„æ—§å¥”è…¾ III åº”è¯¥å°±è¶³å¤Ÿäº†ã€‚æœ€å°å†…å­˜é‡ä¸º 512MBï¼Œç¡¬ç›˜ä¸º 20GBã€‚æˆ‘å»ºè®®ä½¿ç”¨å…·æœ‰ 1024MB å†…å­˜å’Œä¸¤ä¸ª 20GB ç¡¬ç›˜çš„è®¡ç®—æœºæ¥åˆ›å»º RAID-1 è®¾å¤‡ã€‚ä¸ºäº†æœ‰è¶³å¤Ÿçš„ç«¯å£ä¾›æœ€ç»ˆç”¨æˆ·è¿æ¥ï¼Œåº”è¯¥æœ‰ä¸‰ä¸ªä»¥å¤ªç½‘å¡ &#8211; ä¸€ä¸ªç”¨äº WAN è¿æ¥ï¼Œä¸¤ä¸ªç”¨äº LANã€‚ç”±äºæˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªæ¥å…¥ç‚¹ï¼Œæˆ‘ä»¬çš„æ— çº¿ç½‘å¡å¿…é¡»ä¸ Linux å…¼å®¹ï¼Œå¹¶ä¸” Linux é©±åŠ¨ç¨‹åºå¿…é¡»æ”¯æŒ AP æ¨¡å¼ã€‚è¯·å‚è€ƒä»¥ä¸‹ URL ç½‘ç»œå¿«æ·æ–¹å¼ï¼š</p>



<p>&nbsp;&nbsp;&nbsp;&nbsp;Linux æ— çº¿å±€åŸŸç½‘å…¼å®¹æ€§</p>



<p>&nbsp;&nbsp;&nbsp;&nbsp;æ— çº¿ç½‘å¡çš„ Linux é©±åŠ¨ç¨‹åº</p>



<p><strong>6.</strong>&nbsp;<strong>ä½ ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆç¡¬ä»¶ï¼Ÿ</strong><strong></strong></p>



<ul class="wp-block-list">
<li>Â CPU è‹±ç‰¹å°”å¥”è…¾ IIIÂ &#8211; 733Mhz, é¢‘ç‡èŒƒå›´ [500 &#8211; 1000]MHz, è¿è¡Œ 733,6 Mhz (5,5 x 133,4 Mhz)</li>



<li>ä¸»æ¿å‹å· &#8211; KOB 635T FSXä¸»æ¿èŠ¯ç‰‡ç»„
<ul class="wp-block-list">
<li>Â &#8211;Â SiS 635T</li>
</ul>
</li>



<li>Â å†…å­˜ &#8211; 2 x 512MBÂ PC3200 DDR400 RAM 184 PIN NON ECC</li>



<li>Â è§†é¢‘èŠ¯ç‰‡ç»„ &#8211; NVidia Riva TNT2 M64, 32MB</li>



<li>ç¡¬ç›˜ &#8211;
<ul class="wp-block-list">
<li>ST380011A 80GB</li>



<li>ST3204231 20GB</li>
</ul>
</li>



<li>Â CD/DVD å…‰é©± &#8211; HL-DT-ST DVDRAM GSA-4163B</li>



<li>ç½‘ç»œæ§åˆ¶å™¨ &#8211;
<ul class="wp-block-list">
<li>3 xÂ Intel PRO/1000 MTÂ åƒå…†æ¡Œé¢é€‚é…å™¨ (82540EM)ï¼Œ</li>



<li>1 x D-LinkÂ DGE-528TÂ åƒå…†ä»¥å¤ªç½‘é€‚é…å™¨ï¼Œ</li>



<li>1 x Broadcom BCM 4318 [Air Force One 54g] 802.1g æ— çº¿å±€åŸŸç½‘æ§åˆ¶å™¨</li>
</ul>
</li>
</ul>



<p><strong>7.&nbsp;</strong><strong>å¦‚æœæˆ‘æ²¡æœ‰ç¡¬ä»¶å¯ä»¥ç©æ€ä¹ˆåŠï¼Ÿ</strong></p>



<p>ä½¿ç”¨è™šæ‹ŸåŒ–è½¯ä»¶ä»£æ›¿çœŸå®ç¡¬ä»¶ã€‚æœ‰å¾ˆå¤šä¼˜ç§€çš„è™šæ‹ŸåŒ– è½¯ä»¶å¯ä¾›é€‰æ‹©ï¼Œå¦‚ Qemuã€KVM æˆ– VirtualBoxã€‚é€‰æ‹©å…¶ä¸­ä¸€ä¸ªå¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„è™šæ‹Ÿæœºã€‚å®‰è£… GNS3 è½¯ä»¶å¹¶å°†è™šæ‹Ÿæœºå¯¼å…¥åˆ° GNS3 ä¸­ã€‚</p>



<p>GNS3 è½¯ä»¶çš„ä¸€ä¸ªå¾ˆå¤§çš„å¥½å¤„æ˜¯ï¼Œåªéœ€ç‚¹å‡»å‡ ä¸‹ï¼Œæ‚¨å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªç”±é“¾æ¥è¿æ¥åœ¨ä¸€èµ·çš„è™šæ‹ŸåŒ–èŠ‚ç‚¹çš„åŠŸèƒ½æ‹“æ‰‘ã€‚GNS3 è¿˜å…è®¸æ‚¨å°†æ‹“æ‰‘è¿æ¥åˆ°çœŸå®ç½‘ç»œã€‚</p>



<p>åœ¨å®é™…ç‰ˆæœ¬ 0.8.1 ä¸­ï¼ŒGNS3 æ”¯æŒ Dynamipsã€Qemu å’Œ VirtualBox è™šæ‹ŸåŒ–å™¨å’Œæ¨¡æ‹Ÿå™¨ã€‚</p>



<p><strong>8.&nbsp;</strong><strong>æˆ‘ä»¬è¦å®‰è£…ä»€ä¹ˆä¸œè¥¿ï¼Ÿ</strong></p>



<ul class="wp-block-list">
<li>CentOS 6.0 &#8211; å¸¦æœ‰è½¯ä»¶ RAID-1</li>



<li>Linux äº¤æ¢æœº &#8211; Openvswitch é¡¹ç›®ï¼Œ1.2.0</li>



<li>æ— çº¿è½¯ä»¶æ¥å…¥ç‚¹ &#8211; Hostapdï¼Œ0.7.3</li>



<li>PPPoE å®¢æˆ·ç«¯ &#8211; pppd 2.4.5</li>



<li>NATï¼Œé˜²ç«å¢™ &#8211; iptables v1.4.7</li>



<li>DNS æœåŠ¡å™¨ &#8211; BIND 9.7.0</li>



<li>DHCP æœåŠ¡å™¨ &#8211; isc-dhcpd-4.1.1-P1</li>



<li>Samba 3.5.4-68</li>



<li>å±€åŸŸç½‘ NTP å®¢æˆ·ç«¯/æœåŠ¡å™¨ &#8211; 4.2.4p8</li>



<li>DDNS å®¢æˆ·ç«¯ &#8211; 3.8.1</li>
</ul>



<p><strong>9.&nbsp;</strong>â€œ<strong>swouterâ€è¿™ä¸ªåå­—æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</strong></p>



<p>åŸºæœ¬ä¸Šï¼Œæˆ‘å°†ä¸€ä¸ª Linux ç›’å­å‘½åä¸ºâ€œswouterâ€ï¼Œå› ä¸ºå®ƒæ˜¯å…·æœ‰è·¯ç”±åŠŸèƒ½çš„ç¬¬ 3 å±‚äº¤æ¢æœºã€‚</p>



<p><strong>10.&nbsp;</strong><strong>æˆ‘è¿˜éœ€è¦å…¶ä»–ä¸œè¥¿å—ï¼Ÿ</strong><strong></strong></p>



<p>ä¸éœ€è¦ã€‚ä½†æ˜¯äº’è”ç½‘è¿æ¥å’Œä½ çš„è€å¿ƒä¼šå¾ˆæœ‰å¸®åŠ©ã€‚</p>



<h1 class="wp-block-heading"><strong>ç¬¬ 2 éƒ¨åˆ† &#8211; CentOS 6.0 å®‰è£…</strong></h1>



<p>è¿™æ˜¯æè¿°åœ¨ Linux ä¸Šæ„å»º Linux ç¬¬ 3 å±‚å®¶åº­äº¤æ¢æœº/è·¯ç”±å™¨çš„åˆ†æ­¥æ•™ç¨‹ç³»åˆ—ä¸­çš„ç¬¬äºŒç¯‡ã€‚æœ¬æ•™ç¨‹å±•ç¤ºäº† CentOS 6.0 å®‰è£…å’Œè½¯ä»¶ RAID 1 &#8211; ç£ç›˜é•œåƒé…ç½®ã€‚</p>



<p><strong>1.</strong>&nbsp;<strong>ä¸‹è½½ CentOS-6.0-i386-minimal ISO é•œåƒ</strong></p>



<p>é€‰æ‹©ç¦»ä½ ä½ç½®æœ€è¿‘çš„ä¸‹è½½é•œåƒã€‚</p>



<p>$&nbsp;wget ftp://tux.rainside.sk/centos/6/isos/i386/CentOS-6.0-i386-minimal.iso</p>



<p><strong>2. ä½¿ç”¨åˆ»å½•è½¯ä»¶ K3B åˆ»å½• CD æ˜ åƒ</strong></p>



<p><strong>3. è®¾ç½®è®¡ç®—æœºçš„ BIOS ä» CD å¯åŠ¨</strong></p>



<p><strong>4. æ’å…¥ CentOS 6 å®‰è£… CD</strong></p>



<p><strong>5. ä» CD å¯åŠ¨</strong></p>



<p>æŒ‰å›è½¦é”®é€‰æ‹©â€œå®‰è£…æˆ–å‡çº§ç°æœ‰ç³»ç»Ÿâ€é€‰é¡¹ã€‚</p>



<p><strong>6. CDæ£€æŸ¥å®‰è£… CD</strong></p>



<p>CD æ£€æŸ¥çª—å£å‡ºç°ã€‚é€‰æ‹©â€œOKâ€è¿›è¡Œ CD æµ‹è¯•ï¼Œæˆ–é€‰æ‹©â€œSkipâ€è·³è¿‡æ£€æŸ¥åª’ä½“å¹¶ç»§ç»­å®‰è£…ã€‚</p>



<p><strong>7. CentOS æ¬¢è¿çª—å£</strong></p>



<p>å½“è®¡ç®—æœºä¸º CentOS å®‰è£…åŠ è½½ X11 ç¯å¢ƒæ—¶ï¼Œå±å¹•ä¸Šä¼šå‡ºç°é»‘ç™½æ–‡æœ¬ï¼Œå¤§çº¦ 30 ç§’åï¼Œæˆ‘ä»¬å°†çœ‹åˆ° CentOS GUI å®‰è£…ç¨‹åºï¼Œç‚¹å‡»â€œä¸‹ä¸€æ­¥â€ã€‚<em></em></p>



<p><strong>8. é€‰æ‹©å®‰è£…è¿‡ç¨‹ä¸­è¦ä½¿ç”¨çš„è¯­è¨€</strong></p>



<p><strong>9. ä¸ºç³»ç»Ÿé€‰æ‹©é”®ç›˜</strong></p>



<p><strong>10. é€‰æ‹©å­˜å‚¨ç±»å‹</strong></p>



<p>æˆ‘ä»¬ä¸ä½¿ç”¨ä»»ä½•ç‰¹æ®ŠæŠ€æœ¯ï¼ˆiSCSI æˆ–ç±»ä¼¼æŠ€æœ¯ï¼‰ï¼Œå› æ­¤é€‰æ‹©â€œåŸºæœ¬å­˜å‚¨è®¾å¤‡â€é€‰é¡¹ã€‚</p>



<p><strong>11. è®¾ç½®ä¸»æœºå</strong></p>



<p><strong>12. è®¾ç½®æ—¶åŒº</strong></p>



<p><strong>13. è®¾ç½® root å¯†ç </strong></p>



<p><strong>14. é€‰æ‹©å®‰è£…ç±»å‹</strong></p>



<p>åªè¦æˆ‘ä»¬æƒ³åˆ›å»ºè‡ªå·±çš„åˆ†åŒºå¸ƒå±€ï¼Œå°±é€‰æ‹©â€œåˆ›å»ºè‡ªå®šä¹‰å¸ƒå±€â€é€‰é¡¹ã€‚</p>



<p><strong>15. â€œæ•°æ®å­˜å‚¨è®¾å¤‡â€/â€œå®‰è£…ç›®æ ‡è®¾å¤‡â€çª—å£</strong></p>



<p>åªæœ‰åœ¨æ‚¨æœ‰ä¸¤ä¸ªæˆ–æ›´å¤šç¡¬ç›˜é©±åŠ¨å™¨æ—¶æ‰ä¼šå‡ºç°æ­¤çª—å£ã€‚æˆ‘ä»¬å®‰è£…äº†ä»¥ä¸‹ç¡¬ç›˜é©±åŠ¨å™¨ï¼š</p>



<p>Model/Capacity</p>



<p>ATA ST320423A / 20GB</p>



<p>ATA ST380011A / 80GB</p>



<p>å¿…é¡»é€‰æ‹©å…¶ä¸­ä¸€ä¸ªç£ç›˜ä½œä¸ºâ€œå®‰è£…ç›®æ ‡è®¾å¤‡â€ã€‚è¯¥ç£ç›˜å°†è¢«æ ¼å¼åŒ–ï¼Œå¼•å¯¼åŠ è½½ç¨‹åºå’Œæ“ä½œç³»ç»Ÿå°†å®‰è£…åœ¨ç£ç›˜ä¸Šã€‚æˆ‘é€šè¿‡ç‚¹å‡»ç®­å¤´æŒ‰é’®é€‰æ‹©äº†ä¸¤ä¸ªç£ç›˜ä½œä¸ºå®‰è£…ç›®æ ‡è®¾å¤‡ã€‚</p>



<p><strong>16. åˆ†åŒº</strong></p>



<p>æˆ‘ä»¬å°†åˆ›å»ºæ–°çš„åˆ†åŒºã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯åˆ›å»ºè½¯ä»¶ RAID 1 &#8211; ç£ç›˜é•œåƒã€‚å½“ RAID é›†ä¸­çš„ä¸€ä¸ªç£ç›˜å‡ºç°æ•…éšœæ—¶ï¼Œå¦ä¸€ä¸ªç£ç›˜å°†ç»§ç»­å·¥ä½œã€‚å½“æ›´æ¢æ•…éšœç£ç›˜æ—¶ï¼Œæ•°æ®å°†è‡ªåŠ¨ä»å¹¸å­˜ç£ç›˜å…‹éš†åˆ°æ–°ç£ç›˜ã€‚</p>



<p>Device | Size [MB] |</p>



<p>sda (/dev/sda/) 76319</p>



<p>Free</p>



<p>sdb (/dev/sdb/) 9536</p>



<p>Free</p>



<p>é¦–å…ˆï¼Œåœ¨ä¸¤ä¸ªé©±åŠ¨å™¨ä¸Šåˆ›å»ºä¸¤ä¸ªå¤§å°ç›¸ç­‰çš„ RAID åˆ†åŒºã€‚ç”±äºæˆ‘ä»¬å—åˆ°è¾ƒå°ç£ç›˜ /dev/sdb/ å®¹é‡çš„é™åˆ¶ï¼Œæ¯ä¸ª RAID åˆ†åŒºçš„å¤§å°å°†ä¸º 17GBã€‚ä¸‹ä¸€æ­¥æ˜¯åˆ›å»ºåŒ…å«ä¸¤ä¸ª RAID åˆ†åŒºçš„ RAID è®¾å¤‡ /dev/md0/ã€‚</p>



<p>CentOS å°†å®‰è£…åœ¨è¿™ä¸ª RAID è®¾å¤‡ä¸Šï¼ŒæŒ‚è½½ç‚¹ä¸º /ï¼Œä½¿ç”¨ ext4 æ–‡ä»¶ç³»ç»Ÿã€‚</p>



<p>/dev/sdb/ ä¸Šå‰©ä½™çš„ 2535MB å°†ç”¨äº SWAP åˆ†åŒºï¼ˆ2 å€äº RAM çš„å®¹é‡ï¼‰ã€‚</p>



<p>å¿…é¡»åœ¨ /dev/sda/ ä¸Šåˆ›å»ºç›¸åŒå®¹é‡çš„ SWAP åˆ†åŒºã€‚</p>



<p>å¦‚æœæˆ‘ä»¬å¯ä»¥æ¥å—åœ¨ /dev/sda/ å‡ºç°æ•…éšœæ—¶ç”¨æˆ·æ•°æ®ä¸¢å¤±çš„æƒ…å†µï¼Œé‚£ä¹ˆ /dev/sda/ ä¸Šçš„å‰©ä½™ç©ºé—´å¯ä»¥ç”¨äº /home ç›®å½•ã€‚</p>



<p>Device | Size [MB] | Mount Point/RAID/Volume | Type |</p>



<p>Raid Devices</p>



<p>md0 (dev/md0) 16998 / ext4</p>



<p>Hard Drives</p>



<p>sda (/dev/sda/)</p>



<p>sda1 17000 md0 software RAID</p>



<p>sda2 2535 swap</p>



<p>sda3 56783 /home ext4</p>



<p>sdb (/dev/sdb/)</p>



<p>sdb1 17000 md0 software RAID</p>



<p>sdb2 2535 swap</p>



<p>ç‚¹å‡»â€œNextâ€æŒ‰é’®ã€‚</p>



<p><strong>17.&nbsp;</strong><strong>Boot Loader modification</strong></p>



<p>è¿™æ˜¯æˆ‘ä»¬å¯ä»¥æ›´æ”¹ç”¨äºå¼•å¯¼åŠ è½½ç¨‹åºå®‰è£…çš„è®¾å¤‡çš„æœ€åä¸€ä¸ªåœ°æ–¹ã€‚ç‚¹å‡»â€œChange Deviceâ€å¹¶é€‰æ‹© RAID è®¾å¤‡ &#8211; /dev/md0/ã€‚</p>



<p>ç‚¹å‡»â€œNextâ€ã€‚CentOS å®‰è£…æ˜ åƒå°†è¢«ä¼ è¾“åˆ° RAID è®¾å¤‡ä¸Šå¹¶ä»è¯¥è®¾å¤‡è¿›è¡Œå®‰è£…ã€‚</p>



<p>æ³¨æ„ï¼š</p>



<p>å¦‚æœ /dev/sda å‡ºç°æ•…éšœï¼ŒCentoOS æ— æ³•ä» /dev/sdb/ å¼•å¯¼ã€‚å®ƒä¼šå°è¯•è¯»å– /etc/fstab ä¸­å¼•ç”¨ /home åˆ†åŒºçš„æ¡ç›®ã€‚è¿™ä¸ªåˆ†åŒºåªå­˜åœ¨äº /dev/sda ä¸­ï¼Œå› æ­¤æ— æ³•æ‰¾åˆ°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒLinux ä¼šç»™å‡ºä¸€ä¸ªâ€œRepair Filesystemâ€æç¤ºï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æä¾› root å¯†ç è¿›å…¥ã€‚é—®é¢˜æ˜¯åœ¨â€œRepair Filesystemâ€æç¤ºç¬¦ä¸‹ï¼Œæ–‡ä»¶ç³»ç»Ÿè¢«æŒ‚è½½ä¸ºâ€œåªè¯»â€ï¼Œå› æ­¤æˆ‘ä»¬æ— æ³•ä» /etc/fstab ä¸­åˆ é™¤ä¸å†éœ€è¦çš„ /homeã€‚</p>



<p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä»¥å†™æƒé™é‡æ–°æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿï¼š</p>



<p>Repair filesystem #&nbsp;mount -w -o remount /</p>



<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥ç¼–è¾‘ /etc/fstab å¹¶åˆ é™¤æˆ–æ³¨é‡Šå¸¦æœ‰ /home æŒ‚è½½çš„è¡Œã€‚é‡æ–°å¯åŠ¨åï¼Œç³»ç»Ÿå°†æ­£å¸¸å¯åŠ¨ã€‚</p>



<p><strong>18. æ›´æ–°ç³»ç»Ÿ</strong></p>



<p>æˆ‘ä»¬ç°åœ¨å·²ç»å®‰è£…äº† CentOSã€‚ä»¥ root èº«ä»½ç™»å½•å¹¶æ›´æ–°æ•´ä¸ªç³»ç»Ÿã€‚</p>



<p><strong>a)&nbsp;è®¾ç½® IP åœ°å€ã€é»˜è®¤ç½‘å…³ã€DNS</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;ifconfig eth3 172.18.100.150/16</p>



<p>[root@swouter-x86 ~]#&nbsp;route add default gw 172.18.100.1</p>



<p>[root@swouter-x86 ~]#&nbsp;echo &#8220;nameserver 172.18.100.1&#8221; &gt;&gt; /etc/resolv.conf</p>



<p><strong>b)&nbsp;æ›´æ–°ç³»ç»Ÿ</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;yum update -y</p>



<p><strong>c)&nbsp;ä¿®æ”¹æ–‡ä»¶ /etc/grub.conf</strong></p>



<p>å˜åŒ–ï¼š</p>



<p>&#8211; æ³¨é‡Šæ‰æ—§çš„åŸå§‹å†…æ ¸ &#8211; 2.6.32-71.el6.i686 çš„è¡Œã€‚</p>



<p>&#8211; æ³¨é‡Šæ‰å‚æ•° hiddenmenuï¼Œä»¥ä¾¿åœ¨å¯åŠ¨æ—¶çœ‹åˆ°æ•´ä¸ªå¯åŠ¨èœå•ã€‚</p>



<p>&#8211; å°†é»˜è®¤çš„ 5 ç§’è¶…æ—¶å‚æ•°å‡å°‘åˆ° 2 ç§’ï¼Œä»¥ä½¿ CentOS æ›´å¿«åœ°å¯åŠ¨ã€‚</p>



<p><strong>é—®é¢˜ï¼š</strong></p>



<p>æ— æ³•å¼•å¯¼æ–°å†…æ ¸ 2.6.32071.29.1el6.i686ã€‚æ€»æ˜¯å¼•å¯¼æ—§å†…æ ¸ 2.6.32.-71.el6.i686ã€‚</p>



<p>[root@swouter-x86 ~]#&nbsp;dmesg | grep md</p>



<p>raid1: raid set md0 active with 1 out of 2 mirrors</p>



<p>md0: bitmap initialized from disk: read 1/1 pages, set 99 bits</p>



<p>created bitmap (1 pages) for device md0</p>



<p>md0: detected capacity change from 0 to&nbsp;17825718272</p>



<p>dracut: mdadm: /dev/md0 has been started with 1 drive (out of 2).</p>



<p>md0: detected capacity change from 0 to&nbsp;17825718272</p>



<p>md0: unknown partition table</p>



<p>dracut: mdadm: /dev/md0 is already in use.</p>



<p>EXT4-fs (md0): mounted filesystem with ordered data mode</p>



<p>dracut: Mounted root filesystem /dev/md0</p>



<p>SELinux: initialized (dev md0, type ext4), uses xattr</p>



<p>ä» dmesg çš„è¾“å‡ºä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ° /dev/sda1 å­˜åœ¨é—®é¢˜ï¼Œå®ƒå·²è¢«ä»é˜µåˆ—ä¸­è¸¢å‡ºã€‚è®©æˆ‘ä»¬æŸ¥è¯¢é˜µåˆ—çŠ¶æ€ã€‚</p>



<p>[root@swouter-x86 ~]#&nbsp;cat /proc/mdstat</p>



<p>Personalities : [raid1]</p>



<p>md0 : active raid1 sdb1[1]</p>



<p>17407928 blocks super 1.0 [2/1] [_U]</p>



<p>bitmap: 1/1 pages [4KB], 65536KB chunk</p>



<p>unused devices: &lt;none&gt;</p>



<p>é˜µåˆ—ä¸­ä»…æ˜¾ç¤º sdb1ï¼Œä½†é˜µåˆ—ä¸­åº”åŒ…å«ä¸¤ä¸ªæˆå‘˜ [2/1]ã€‚æˆ‘ä»¬éœ€è¦æ£€æŸ¥ /dev/sda1 æ˜¯å¦æœ‰æ•…éšœã€‚</p>



<p>[root@swouter-x86 ~]#&nbsp;fsck.ext4 /dev/sda1</p>



<p>e2fsck 1.41.12 (17-May-2010)</p>



<p>/dev/sda1: clean, 17651/1089536 files,&nbsp;234706/4351982&nbsp;blocks</p>



<p>å½“ç£ç›˜æ²¡æœ‰æ­£ç¡®å…³é—­æ—¶ï¼ˆUPS æ•…éšœç­‰ï¼‰å¯èƒ½ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚å°†æœ‰é—®é¢˜çš„è®¾å¤‡ /dev/sda1 è¯»å…¥é˜µåˆ— /dev/md0 å¯èƒ½ä¼šæœ‰å¸®åŠ©ã€‚</p>



<p>[root@swouter-x86 ~]#&nbsp;/sbin/mdadm /dev/md0 &#8211;fail /dev/sda1 &#8211;remove /dev/sda1</p>



<p>[root@swouter-x86 ~]#/sbin/mdadm /dev/md0 &#8211;add /dev/sda1</p>



<p>ç°åœ¨ï¼Œ/dev/sda1 çš„å†…å®¹æ­£åœ¨ä» /dev/sdb1 é‡å»ºã€‚</p>



<p>[root@swouter-x86 ~]#&nbsp;cat /proc/mdstat</p>



<p>Personalities : [raid1]</p>



<p>md0 : active raid1 sda1[0] sdb1[1]</p>



<p>17407928 blocks super 1.0 [2/1] [_U]</p>



<p>[&gt;&#8230;&#8230;&#8230;&#8230;&#8230;&#8230;..] recovery = 3.5% (625408/17407928) finish=31.2min speed=8944K/sec</p>



<p>bitmap: 1/1 pages [4KB], 65536KB chunk</p>



<p>unused devices: &lt;none&gt;</p>



<p>é‡å»ºæ•´ä¸ªç£ç›˜éœ€è¦å‡ åˆ†é’Ÿæ—¶é—´ã€‚å®Œæˆåï¼Œå†æ¬¡æ£€æŸ¥é˜µåˆ—ï¼š</p>



<p>[root@swouter-x86 ~]#&nbsp;cat /proc/mdstat</p>



<p>Personalities : [raid1]</p>



<p>md0 : active raid1 sda1[0] sdb1[1]</p>



<p>17407928 blocks super 1.0 [2/2] [UU]</p>



<p>bitmap: 1/1 pages [4KB], 65536KB chunk</p>



<p>æ˜¾ç„¶ï¼Œç°åœ¨ sda1 å’Œ sdb1 åˆ†åŒºéƒ½æ˜¯ Raid çš„æˆå‘˜äº†ã€‚é‡æ–°å¯åŠ¨å¹¶æ£€æŸ¥ dmesg è¾“å‡ºï¼š</p>



<p>[root@swouter-x86 ~]#&nbsp;dmesg | grep md</p>



<p>ata1: PATA max UDMA/100 cmd 0x1f0 ctl 0x3f6 bmdma 0xff00 irq 14</p>



<p>ata2: PATA max UDMA/100 cmd 0x170 ctl 0x376 bmdma 0xff08 irq 15</p>



<p>md: md0 stopped.</p>



<p>md: bind&lt;sdb1&gt;</p>



<p>md: bind&lt;sda1&gt;</p>



<p>md: raid1 personality registered for level 1</p>



<p>raid1: raid set md0 active with 2 out of 2 mirrors</p>



<p>md0: bitmap initialized from disk: read 1/1 pages, set 0 bits</p>



<p>created bitmap (1 pages) for device md0</p>



<p>md0: detected capacity change from 0 to17825718272</p>



<p>dracut: mdadm: /dev/md0 has been started with 2 drives.</p>



<p>md0: detected capacity change from 0 to17825718272</p>



<p>md0: unknown partition table</p>



<p>EXT4-fs (md0): mounted filesystem with ordered data mode</p>



<p>dracut: Mounted root filesystem /dev/md0</p>



<p>SELinux: initialized (dev md0, type ext4), uses xattr</p>



<p><strong>19. ä¸ºæ§åˆ¶å°æ”¯æŒé…ç½® CentOS</strong></p>



<p><strong>a)&nbsp;æ£€æŸ¥ dmesg è¾“å‡ºä¸­æ˜¯å¦å­˜åœ¨ä¸²è¡Œç«¯å£</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;dmesg | grep tty</p>



<p>Console [tty0] enabled</p>



<p>serial8250: ttyS0 at I/O 0x3f8 (irq = 4) is a 16550A</p>



<p>serial8250: ttyS1 at I/O 0x2f8 (irq = 3) is a 16550A</p>



<p>æˆ‘ä»¬æœ‰ä¸¤ä¸ªä¸²è¡Œç«¯å£ &#8211; /dev/ttyS0 å’Œ /dev/ttyS1</p>



<p><strong>b)&nbsp;é…ç½® /etc/inittab ä»¥æ”¯æŒä¸²è¡Œæ§åˆ¶å°ç™»å½•</strong></p>



<p>æˆ‘ä»¬éœ€è¦é…ç½® agetty å®ˆæŠ¤è¿›ç¨‹æ¥ç›‘å¬ä¸²è¡Œç«¯å£ï¼Œå®ƒèƒ½å¤Ÿå“åº”ç‰©ç†ä¸²è¡Œç«¯å£ä¸Šçš„è¾“å…¥ã€‚</p>



<p>[root@swouter-x86 ~]#&nbsp;echo &#8220;S0:12345:respawn:/sbin/agetty ttyS0 9600 vt100&#8221; &gt;&gt; /etc/inittab</p>



<p>[root@swouter-x86 ~]#&nbsp;echo &#8220;S1:12345:respawn:/sbin/agetty ttyS1 9600 vt100&#8221; &gt;&gt; /etc/inittab</p>



<p>Explanation:</p>



<p>S0, S1 &#8211; å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œå¯ä»¥æ˜¯ä»»æ„çš„ã€‚</p>



<p>12345 &#8211; æ‰€æœ‰è¿è¡Œçº§åˆ«</p>



<p>0 &#8211; åœæ­¢ï¼ˆä¸è¦å°† initdefault è®¾ç½®ä¸ºè¿™ä¸ªï¼‰</p>



<p>1 &#8211; å•ç”¨æˆ·æ¨¡å¼</p>



<p>2 &#8211; å¤šç”¨æˆ·ï¼Œæ—  NFSï¼ˆå¦‚æœæ²¡æœ‰ç½‘ç»œï¼Œåˆ™ä¸ 3 ç›¸åŒï¼‰</p>



<p>3 &#8211; å®Œå…¨å¤šç”¨æˆ·æ¨¡å¼</p>



<p>4 &#8211; æœªä½¿ç”¨</p>



<p>5 &#8211; X11</p>



<p>6 &#8211; é‡å¯ï¼ˆä¸è¦å°† initdefault è®¾ç½®ä¸ºè¿™ä¸ªï¼‰</p>



<p>respawn &#8211; å®ƒå°†ç¡®ä¿åœ¨ä½ æ³¨é”€åå®ƒå°†æ¥å—å¦ä¸€ä¸ªç™»å½•ã€‚</p>



<p>ttyS0, ttyS1 &#8211; ä¸²è¡Œç«¯å£æ ‡è¯†ç¬¦</p>



<p>9600 &#8211; ä¸²è¡Œçº¿è·¯é€Ÿç‡ï¼ˆbpsï¼‰</p>



<p>vt100 &#8211; ç»ˆç«¯ä»¿çœŸã€‚ä½ å¯ä»¥ä½¿ç”¨å…¶ä»–çš„ï¼Œä½† VT100 æ˜¯æœ€å¸¸è§çš„æˆ–â€œæ ‡å‡†â€çš„</p>



<p><strong>c)&nbsp;é…ç½® /etc/securetty ä»¥å…è®¸ç”¨æˆ· root åœ¨ä¸²è¡Œç«¯å£ä¸Šç™»å½•</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;echo &#8220;ttyS0&#8221; &gt;&gt; /etc/securetty</p>



<p>[root@swouter-x86 ~]#&nbsp;echo &#8220;ttyS1&#8221; &gt;&gt; /etc/securetty</p>



<p><strong>d)&nbsp;ç¼–è¾‘ /etc/sysconfig/init å¹¶é˜²æ­¢å›¾å½¢å¯åŠ¨å¯¼è‡´ç»ˆç«¯æ•…éšœ</strong></p>



<p>æ›¿æ¢ BOOTUP=color ä¸º BOOTUP=serial</p>



<p>[root@swouter-x86 ~]#&nbsp;sed -i &#8216;s/BOOTUP=color/BOOTUP=serial/g&#8217; /etc/sysconfig/init</p>



<p><strong>e)&nbsp;ç¼–è¾‘ /etc/grub.conf å°†æ§åˆ¶å°è¾“å‡ºé‡å®šå‘åˆ°ä¸²è¡Œç«¯å£ &#8211; /dev/ttyS0</strong></p>



<p>é€šè¿‡åœ¨è¡Œé¦–æ”¾ç½® # æ³¨é‡Šæ‰è¿™ä¸¤è¡Œï¼š</p>



<p>#splashimage=(hd0,0)/grub/splash.xpm.gz</p>



<p>#hiddenmenu</p>



<p>åœ¨è¡Œé¦–ä¸ºâ€œkernelâ€çš„è¡Œçš„æœ«å°¾æ·»åŠ æ­¤è¡Œ</p>



<p>console=ttyS0,9600n8</p>



<p><strong>End</strong><strong>.</strong></p>



<p>è¿™æ˜¯æˆ‘åœ¨å†™ä½œè¿‡ç¨‹ä¸­å¯†é›†ä½¿ç”¨çš„æ–‡ç« åˆ—è¡¨ã€‚</p>



<p>CentOS &nbsp;å®‰è£…</p>



<p>http://aplawrence.com/Linux/lvm.html</p>



<p>Raid ç†è®º</p>



<p>http://aplawrence.com/Linux/softmirror.html</p>



<p>http://aplawrence.com/Unixart/raid.html</p>



<p>http://www.linuxhomenetworking.com/wiki/index.php/Quick_HOWTO_:_Ch26_:_Linux_Software_RAID</p>



<p>e2fsck å’Œ e4fsck</p>



<p>http://unix.stackexchange.com/questions/18145/is-there-any-difference-between-e2fsck-and-e4fsck-on-centos-rhel-systems</p>



<p>æ¢å¤ Raid</p>



<p>http://www.linuxquestions.org/questions/linux-general-1/md-kicking-non-fresh-sda6-from-array-416853/</p>



<p>http://www.kieser.net/linux/raidhotadd.html</p>



<p>http://www.tgunkel.de/it/software/doc/linux_server.en</p>



<p>http://www.cyberciti.biz/faq/centos-rhel-linux-mount-raid-hard-disk-from-livecd/</p>



<p>Superblock æ•…éšœ</p>



<p>http://ubuntuforums.org/showthread.php?t=1245536</p>



<p>http://ubuntuforums.org/archive/index.php/t-1245536.html</p>



<p>http://www.unix.com/unix-advanced-expert-users/78965-linux-ext3-superblock-recovery.html</p>



<p>Linux æ§åˆ¶å°æ”¯æŒ</p>



<p>http://www.vanemery.com/Linux/Serial/serial-console.html</p>



<p>http://www.ghidinelli.com/2006/11/06/configuring-console-access-for-linuxcentos</p>



<h1 class="wp-block-heading"><strong>ç¬¬ 3 éƒ¨åˆ† &#8211; æ— çº¿æ¥å…¥ç‚¹å®‰è£…ä¸é…ç½®</strong></h1>



<p>æˆ‘ä»¬å°†é€šè¿‡å¦ä¸€ä¸ªæ•™ç¨‹ç»§ç»­æ„å»ºæˆ‘ä»¬çš„ Linux ç¬¬ 3 å±‚äº¤æ¢æœºï¼Œè¯¥æ•™ç¨‹è§£é‡Šäº†ä¸ºæ— çº¿å±€åŸŸç½‘ç”¨æˆ·å®‰è£…å’Œé…ç½®å®‰å…¨æ— çº¿æ¥å…¥ç‚¹ï¼ˆAPï¼‰çš„æ­¥éª¤ã€‚AP å°†è¢«é…ç½®ä¸ºä½¿ç”¨å®‰å…¨çš„ WPA2 åè®®è¿›è¡Œå®¢æˆ·ç«¯èº«ä»½éªŒè¯ï¼Œå¹¶ä½¿ç”¨é¢„å…±äº«å¯†é’¥ï¼ˆPSKï¼‰ã€‚AP å’Œå®¢æˆ·ç«¯ä¹‹é—´çš„æµé‡å°†ä½¿ç”¨ç°ä»£ AES åŠ å¯†è¿›è¡ŒåŠ å¯†ã€‚æè¿° Linux L3 äº¤æ¢æœº/è·¯ç”±å™¨æ¦‚å¿µã€ç¡¬ä»¶å’Œè½¯ä»¶è¦æ±‚çš„ä»‹ç»æ•™ç¨‹åœ¨è¿™é‡Œã€‚</p>



<p><strong>1. å®‰è£… pciutils</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;yum install pciutils</p>



<p><strong>2. è·å–æœ‰å…³æ— çº¿ä»¥å¤ªç½‘å¡çš„ä¿¡æ¯</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;lspci -vnn</p>



<p>&lt;Output is truncated&gt;</p>



<p>00:11.0 Network controller [0280]: Broadcom Corporation BCM4318 [AirForce One 54g] 802.11g Wireless LAN Controller [14e4:4318] (rev 02)</p>



<p>Subsystem: ASUSTeK Computer Inc. WL-138G v2 / WL-138gE / WL-100gE [1043:100f]</p>



<p>Flags: bus master, fast devsel, latency 64, IRQ 5</p>



<p>Memory at dfffa000 (32-bit, non-prefetchable) [size=8K]</p>



<p>Kernel driver in use: b43-pci-bridge</p>



<p>Kernel modules: ssb</p>



<p>&lt;Output is truncated&gt;</p>



<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°èŠ¯ç‰‡ç»„ BCM4318 å·²è¢«è¯†åˆ«ï¼Œå¹¶ä¸”å†…æ ¸é©±åŠ¨ç¨‹åº b43 æ­£åœ¨ä½¿ç”¨ä¸­ã€‚ç°åœ¨å°†åŒæ‹¬å·ä¸­çš„è¾“å‡º &#8211; [14e4:4318] ä¸æ”¯æŒçš„ç¡¬ä»¶èŠ¯ç‰‡ç»„åˆ—è¡¨è¿›è¡Œæ¯”è¾ƒã€‚</p>



<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ° BCM4318 æ˜¯å—æ”¯æŒçš„ï¼Œå¹¶ä¸” b/g æ¨¡å¼å¯ç”¨ã€‚å°½ç®¡ b43 é©±åŠ¨ç¨‹åºæ”¯æŒ AP æ¨¡å¼ï¼ˆæŸ¥çœ‹åŠŸèƒ½éƒ¨åˆ†ï¼‰ï¼Œä½†è¯¥ç½‘ç«™å‘Šè¯‰æˆ‘ä»¬ï¼š</p>



<blockquote class="wp-block-quote is-layout-flow wp-block-quote-is-layout-flow">
<p>BCM4318 èŠ¯ç‰‡ç»„æœ‰è¿™ä¸ªå·²çŸ¥é—®é¢˜ï¼šç”±äºé«˜ä¼ è¾“é€Ÿç‡ä¸‹çš„æ•°æ®åŒ…ä¸¢å¤±ï¼ŒAP æ¨¡å¼æ— æ³•æ­£å¸¸å·¥ä½œã€‚æˆ‘ä»¬ç¨åä¼šè¿›è¡Œæµ‹è¯•ã€‚</p>
</blockquote>



<p>è¿™äº›æ˜¯å…¶ä»–æœ‰åŠ©äºæ•…éšœæ’é™¤çš„è¾“å‡ºã€‚</p>



<p>[root@swouter-x86 ~]#&nbsp;dmesg</p>



<p>&lt;Output is truncated&gt;</p>



<p>b43-phy0: Broadcom 4318 WLAN found (core revision 9)</p>



<p>b43-phy0 debug: Found PHY: Analog 3, Type 2, Revision 7</p>



<p>b43-phy0 debug: Found Radio: Manuf 0x17F, Versionwebsite 0x2050, Revision 8</p>



<p>phy0: Selected rate control algorithm &#8216;minstrel&#8217;</p>



<p>Registered led device: b43-phy0::tx</p>



<p>Registered led device: b43-phy0::rx</p>



<p>Registered led device: b43-phy0::assoc</p>



<p>Registered led device: b43-phy0::radio</p>



<p>Broadcom 43xx driver loaded [ Features: PMLS, Firmware-ID: FW13 ]</p>



<p>&lt;Output is truncated&gt;</p>



<p>[root@swouter-x86 ~]#&nbsp;lsmod | grep b43</p>



<p>b43 181773 0</p>



<p>mac80211 129050 1 b43</p>



<p>cfg80211 118045 2 b43,mac80211</p>



<p>ssb 47878 1 b43</p>



<p>mmc_core 61320 2 b43,ssb</p>



<p><strong>3. èŠ¯ç‰‡ç»„ BCM4318 çš„è®¾å¤‡å›ºä»¶å®‰è£…</strong></p>



<p>æ ¹æ®é“¾æ¥ï¼ŒBroadcom æ— çº¿èŠ¯ç‰‡éœ€è¦åœ¨æ— çº¿èŠ¯ç‰‡æœ¬èº«ä¸Šè¿è¡Œçš„ä¸“æœ‰è½¯ä»¶ï¼ˆç§°ä¸ºâ€œå›ºä»¶â€ï¼‰æ‰èƒ½æ­£å¸¸å·¥ä½œã€‚æ­¤å›ºä»¶å— Broadcom ç‰ˆæƒä¿æŠ¤ï¼Œå¿…é¡»ä» Broadcom çš„ä¸“æœ‰é©±åŠ¨ç¨‹åºä¸­æå–ã€‚è¦åœ¨æˆ‘ä»¬çš„ç³»ç»Ÿä¸Šè·å–æ­¤ç±»å›ºä»¶ï¼Œæˆ‘ä»¬å¿…é¡»ä»åˆæ³•çš„åˆ†å‘ç‚¹ä¸‹è½½é©±åŠ¨ç¨‹åºï¼Œæå–å¹¶å®‰è£…å®ƒã€‚</p>



<p>&nbsp;<strong>a/&nbsp;å®‰è£… b43-fwcutter</strong></p>



<p>å¦‚æœæˆ‘ä»¬æƒ³ä½¿ç”¨æœ€æ–°çš„ Broadcom å›ºä»¶ 5.10.56.27.3ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨ b43-fwcutter. ç‰ˆæœ¬ 014ã€‚CentOS å­˜å‚¨åº“ä»…æä¾› b43-fwcuter ç‰ˆæœ¬ 012ï¼Œè¯¥ç‰ˆæœ¬ä»…æ”¯æŒé«˜è¾¾ 4.150.10.5 ç‰ˆæœ¬çš„å›ºä»¶ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä»æºä»£ç ç¼–è¯‘å¹¶å®‰è£… b43-fwcutterã€‚</p>



<p>http://wireless.kernel.org/en/users/Drivers/b43#other_distros</p>



<p>[root@swouter-x86 ~]#&nbsp;yum install wget make kernel-headers gcc</p>



<p>[root@swouter-x86 ~]#&nbsp;wget http://bu3sch.de/b43/fwcutter/b43-fwcutter-014.tar.bz2</p>



<p>[root@swouter-x86 ~]#&nbsp;tar xjf b43-fwcutter-014.tar.bz2</p>



<p>[root@swouter-x86 ~]#&nbsp;cd b43-fwcutter-014</p>



<p>[root@swouter-x86 ~]#&nbsp;make</p>



<p>[root@swouter-x86 ~]#&nbsp;make install</p>



<p>æ£€æŸ¥ fw-cutter æ˜¯å¦æ­£ç¡®å®‰è£…ï¼š</p>



<p>[root@swouter-x86 b43-fwcutter-014]#&nbsp;<code>/usr/local/bin/b43-fwcutter --help</code></p>



<p>b43-fwcutter version 014</p>



<p><strong>b/&nbsp;å°†å›ºä»¶æå–åˆ° /lib/firmware</strong></p>



<p>root@swouter-x86 ~]#&nbsp;<code>export FIRMWARE_INSTALL_DIR="/lib/firmware"</code></p>



<p>[root@swouter-x86 ~]#&nbsp;wget http://mirror2.openwrt.org/sources/broadcom-wl-5.10.56.27.3_mipsel.tar.bz2</p>



<p>[root@swouter-x86 ~]#&nbsp;tar jxvf broadcom-wl-5.10.56.27.3_mipsel.tar.bz2</p>



<p>[root@swouter-x86 ~]#&nbsp;/usr/local/bin/b43-fwcutter -w &#8220;$FIRMWARE_INSTALL_DIR&#8221; broadcom-wl-5.10.56.27.3/driver/wl_apsta/wl_prebuilt.o</p>



<p>å›ºä»¶æ­£åœ¨å®‰è£…åˆ° /lib/firmware/b43 ç›®å½•ä¸­ã€‚</p>



<p><strong>4. å®‰è£… wireless-tools</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;yum install wireless-tools.i686</p>



<p><strong>5. æµ‹è¯•</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;iwconfig wlan0 mode Master</p>



<p>Error for wireless request &#8220;Set Mode&#8221; (8B06) :</p>



<p>SET failed on device wlan0 ; Invalid argument.</p>



<p>ä¹ä¸€çœ‹ï¼Œä¼¼ä¹ä¸æ”¯æŒä¸»æ¨¡å¼ã€‚æ ¹æ®è¿™ä¸ªé“¾æ¥ï¼Œb43 é©±åŠ¨ç¨‹åºåº”è¯¥å…è®¸æˆ‘ä»¬åˆ›å»º APã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£… hostapd å®ç”¨ç¨‹åºï¼Œå®ƒå…è®¸æˆ‘ä»¬å°†æ— çº¿ç½‘å¡åˆ‡æ¢åˆ°ä¸»æ¨¡å¼ã€‚</p>



<p><strong>6. å®‰è£… Hostapd</strong></p>



<p><strong>a)&nbsp;å®‰è£… hostapd ç¼–è¯‘æ‰€éœ€çš„å¿…è¦è½¯ä»¶åŒ…ï¼Œå¹¶è·å–æœ€æ–°ç‰ˆæœ¬çš„ hostapd</strong></p>



<p>[root@swouter-x86 hostapd]#&nbsp;yum install glibc libnl.i686 libnl-devel.i686 openssl-devel</p>



<p>[root@swouter-x86 ~]#&nbsp;wget http://w1.fi/releases/hostapd-0.7.3.tar.gz</p>



<p>[root@swouter-x86 ~]#&nbsp;tar zxvf hostapd-0.7.3.tar.gz</p>



<p>[root@swouter-x86 ~]#&nbsp;cd hostapd-0.7.3/hostapd/</p>



<p><strong>b)&nbsp;åˆ›å»ºé…ç½®æ–‡ä»¶å¹¶å¯ç”¨NL80211æ”¯æŒ</strong></p>



<p>[root@swouter-x86 hostapd]#&nbsp;cp defconfig .config</p>



<p>[root@swouter-x86 hostapd]#&nbsp;vi .config</p>



<p>ç°åœ¨æ‰¾åˆ°åŒ…å«ä»¥ä¸‹é…ç½®çš„è¡Œï¼š</p>



<p>#CONFIG_DRIVER_NL80211=y</p>



<p>é€šè¿‡åˆ é™¤â€œ#â€ç¬¦å·å–æ¶ˆæ³¨é‡Šè¯¥è¡Œã€‚å¯¹æ‚¨å¯èƒ½æ„Ÿå…´è¶£çš„å…¶ä»–è®¾ç½®é‡å¤æ­¤æ“ä½œã€‚åŸºæœ¬é…ç½®ï¼ˆä»…å–æ¶ˆæ³¨é‡Šæ­¤è¡Œï¼‰è¶³ä»¥ä½¿ hostapd å¯åŠ¨å¹¶è¿è¡Œ WPA/WPA2 èº«ä»½éªŒè¯å’ŒåŠ å¯†ã€‚</p>



<p><strong>c)&nbsp;ç¼–è¯‘hostapdå¹¶ä¿å­˜åˆ°/usr/local/bin/ç›®å½•</strong></p>



<p>[root@swouter-x86 hostapd]#&nbsp;make</p>



<p>[root@swouter-x86 hostapd]#&nbsp;cp ./hostapd /usr/local/bin/</p>



<p><strong>d)&nbsp;ä¸º hostapd åˆ›å»ºé…ç½®æ–‡ä»¶</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;vim /etc/hostapd.conf</p>



<p>interface=wlan0</p>



<p>driver=nl80211</p>



<p>ssid=Swouter-x86-wlan</p>



<p>channel=1</p>



<p>hw_mode=g</p>



<p>wpa=2</p>



<p>wpa_key_mgmt=WPA-PSK</p>



<p>wpa_pairwise=CCMP</p>



<p>wpa_passphrase=your_password</p>



<p><strong>e)&nbsp;ä¸º hostapd åˆ¶ä½œåˆå§‹åŒ–è„šæœ¬</strong></p>



<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¥ç½‘ç«™çš„è„šæœ¬ï¼š</p>



<p>#!/bin/sh</p>



<p><code>#start/stop the hostapd server</code></p>



<p>#</p>



<p><code># chkconfig: 2345 99 10</code></p>



<p><code># description: hostap daemon</code></p>



<p><code># processname: hostapd</code></p>



<p><code># config: /etc/hostapd.conf</code></p>



<p><code># pidfile: /var/run/hostapd.pid</code></p>



<p><code>#</code></p>



<p><code>PATH=/bin:/usr/bin:/usr/local/bin:/sbin:/usr/sbin</code></p>



<p><code>export PATH</code></p>



<p># Source function library.</p>



<p><code>. /etc/rc.d/init.d/functions</code></p>



<p>stop()</p>



<p><code>{</code></p>



<p><code>echo -n "Stopping hostapd daemon: "</code></p>



<p><code>killproc hostapd</code></p>



<p><code>echo</code></p>



<p><code>rm -f /var/lock/subsys/hostapd</code></p>



<p><code>}</code></p>



<p>start()</p>



<p><code>{</code></p>



<p><code>echo -n "Starting hostapd daemon: "</code></p>



<p><code>daemon /usr/local/bin/hostapd /etc/hostapd.conf -P /var/run/hostapd.pid -B</code></p>



<p><code>echo</code></p>



<p><code>touch /var/lock/subsys/hostapd</code></p>



<p><code>}</code></p>



<p># See how we were called.</p>



<p><code>case "$1" in</code></p>



<p><code>start)</code></p>



<p><code>start</code></p>



<p><code>;;</code></p>



<p><code>stop)</code></p>



<p><code>stop</code></p>



<p><code>;;</code></p>



<p><code>status)</code></p>



<p><code>status hostapd</code></p>



<p><code>;;</code></p>



<p><code>restart)</code></p>



<p><code>stop</code></p>



<p><code>start</code></p>



<p><code>;;</code></p>



<p><code>*)</code></p>



<p>echo &#8220;Usage: hostapd {start|stop|status|restart}&#8221;</p>



<p><code>exit 1</code></p>



<p><code>esac</code></p>



<p><code>exit 0</code></p>



<p>åˆ›å»º /etc/init.d/hostapd æ–‡ä»¶å¹¶å°†è„šæœ¬å¤åˆ¶åˆ°è¯¥æ–‡ä»¶ã€‚ä¸ºè¯¥æ–‡ä»¶åˆ†é…è¿è¡Œæƒé™ã€‚</p>



<p>[root@swouter-x86 ~]#&nbsp;chmod +x /etc/init.d/hostapd<strong></strong></p>



<p><strong>f)&nbsp;é…ç½®ä¸€ä¸ªåœ¨æ‰€æœ‰è¿è¡Œçº§åˆ«é‡å¯åå¯åŠ¨çš„åˆå§‹åŒ–è„šæœ¬</strong></p>



<p>root@swouter-x86 ~]#&nbsp;<code>chkconfig --add hostapd</code></p>



<p><strong>g)&nbsp;æµ‹è¯•</strong></p>



<p>è¿æ¥åˆ° AP çš„å®¢æˆ·ç«¯çš„è¾“å‡ºã€‚æ³¨æ„â€œæ— æ•ˆæ‚é¡¹â€è®¡æ•°å™¨ã€‚</p>



<p>[brezular@COM-8510p ~]$&nbsp;iwconfig wlan0</p>



<p>wlan0 IEEE 802.11abgn ESSID:&#8221;Swouter-x86-wlan&#8221;</p>



<p>Mode:Managed Frequency:2.432 GHz Access Point: 00:17:31:CE:6A:CF</p>



<p>Bit Rate=54 Mb/s Tx-Power=15 dBm</p>



<p>Retry long limit:7 RTS thr:off Fragment thr:off</p>



<p>Power Management:off</p>



<p>Link Quality=70/70 Signal level=-31 dBm</p>



<p>Rx invalid nwid:0 Rx invalid crypt:0 Rx invalid frag:0</p>



<p>Tx excessive retries:0 Invalid misc:247 Missed beacon:0</p>



<p>æ ¹æ®ï¼šhttp://linux.die.net/man/8/iwconfig &#8211; æ­¤è®¡æ•°å™¨è¡¨ç¤ºä¸ç‰¹å®šæ— çº¿æ“ä½œç›¸å…³çš„æ•°æ®åŒ…ä¸¢å¤±ã€‚å³ä½¿è®¡æ•°å™¨æ­£åœ¨ç¼“æ…¢å¢åŠ ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•æ˜æ˜¾çš„æ•°æ®åŒ…ä¸¢å¤±ï¼Œè¿™é˜»æ­¢äº†æˆ‘ä»¬ä½¿ç”¨æ­¤æ— çº¿ç½‘å¡ã€‚</p>



<p>ä»¥ä¸‹æ˜¯æˆ‘åœ¨å†™ä½œè¿‡ç¨‹ä¸­å¤§é‡ä½¿ç”¨çš„æ–‡ç« åˆ—è¡¨ã€‚</p>



<p>http://wireless.kernel.org/en/users/Drivers/b43#devicefirmware</p>



<p>http://wiki.centos.org/HowTos/Laptops/Wireless</p>



<p>http://wiki.centos.org/HowTos/Laptops/Wireless/Broadcom?action=show</p>



<p>http://forums.opensuse.org/english/get-technical-help-here/wireless/410165-creating-access-point-11-1-a.html</p>



<p>http://linuxwireless.org/en/users/Documentation/hostapd#Download_and_compile_hostapd</p>



<p>http://linuxwireless.org/en/users/Drivers</p>



<p>http://djlab.com/2010/02/basic-hostapd-init-script-for-redhatcentos-variants/</p>



<p>http://linux.die.net/man/8/iwconfig</p>



<h1 class="wp-block-heading"><strong>ç¬¬ 4 éƒ¨åˆ† &#8211; Openvswitch å®‰è£…å’Œé…ç½®</strong></h1>



<p>åœ¨ä¸Šä¸€ç¯‡æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°† Linux ç¬¬ 3 å±‚äº¤æ¢æœºåˆ‡æ¢ä¸ºæ— çº¿ä¸»æ¨¡å¼ï¼Œä»¥ä¾¿ä¸ºæ— çº¿ LAN ç”¨æˆ·æä¾›æ— çº¿æœåŠ¡ã€‚æˆ‘ä»¬å°†ç»§ç»­æ„å»º Linux L3 äº¤æ¢æœºå¹¶åœ¨ CentOS ä¸Šå®‰è£… Open vSwitch ä»¥è¿æ¥æœ‰çº¿ LAN ç”¨æˆ·ã€‚å…¥é—¨æ•™ç¨‹ã€è½¯ä»¶å’Œç¡¬ä»¶è¦æ±‚åˆ—è¡¨åœ¨æ­¤å¤„ã€‚</p>



<p>å°½ç®¡æœ‰å¤šä¸ªé¡¹ç›®å¯ä»¥å¸®åŠ©æˆ‘ä»¬å°†ä»¥å¤ªç½‘æ¥å£æ¡¥æ¥åœ¨ä¸€èµ·å¹¶å¼ºåˆ¶ Linux æœºå™¨å……å½“äº¤æ¢æœºï¼ˆVDEswitchã€LiSA æˆ–æ¡¥æ¥å®ç”¨ç¨‹åºï¼‰ï¼Œä½†æˆ‘æƒ³ä½¿ç”¨ Openvswitch æ¥å®Œæˆè¿™é¡¹å·¥ä½œï¼Œå› ä¸ºå®ƒæä¾›äº†è®¸å¤šå¯ä»¥åœ¨ç¡¬ä»¶äº¤æ¢æœºä¸­æ‰¾åˆ°çš„åŠŸèƒ½ã€‚</p>



<p>å®ƒä»¬æ˜¯ PCI æ’æ§½ä¸­çš„å››å—åƒå…†ä»¥å¤ªç½‘å¡ã€‚å…¶ä¸­ä¸‰å—æ˜¯ Intel e1000 &#8211; 82540EM åƒå…†æ§åˆ¶å™¨ï¼Œä¸€å—æ˜¯ D-Link System DGE-528T æ§åˆ¶å™¨ã€‚è¿˜æœ‰ Broadcom BCM4318 802.11g æ— çº¿å±€åŸŸç½‘æ§åˆ¶å™¨ï¼Œç”¨äºè¿æ¥æ— çº¿å±€åŸŸç½‘ç”¨æˆ·ï¼Œå¦‚æˆ‘ä»¬åœ¨æ­¤å¤„æ‰€ç¤ºã€‚</p>



<p>æˆ‘ä»¬å°†ä½¿ç”¨ DGE-528T åƒå…†æ§åˆ¶å™¨å°†æˆ‘ä»¬çš„ Linux æœºç®±è¿æ¥åˆ°äº’è”ç½‘ã€‚æ­¤æ¥å£çš„ IP åœ°å€å°†ç”±æä¾›å•†çš„ DHCP æœåŠ¡å™¨è‡ªåŠ¨åˆ†é…ã€‚</p>



<p>å…¶ä½™ä¸‰ä¸ª Intel e1000 åƒå…†æ§åˆ¶å™¨å’Œä¸€ä¸ªæ— çº¿æ§åˆ¶å™¨å°†æ¡¥æ¥åœ¨ä¸€èµ·ï¼Œå¹¶æ ¹æ®ç›®æ ‡ä»¥å¤ªç½‘åœ°å€ï¼ˆè€Œä¸æ˜¯ IP åœ°å€ï¼‰åœ¨è¿™äº›æ¥å£ä¹‹é—´è½¬å‘æµé‡ã€‚è¿æ¥åˆ°è¿™äº›ç«¯å£çš„è®¡ç®—æœºå±äºåŒä¸€ IP å­ç½‘ &#8211; 172.18.0.0/16 ã€‚</p>



<p>è¿˜å¿…é¡»åˆ›å»ºè™šæ‹Ÿæ¥å£å¹¶é…ç½®å…¶ IP åœ°å€ &#8211; 172.18.100.150/16ã€‚è¯¥ IP åœ°å€ç”¨ä½œå­ç½‘ 172.18.0.0/16 ä¸Šæ‰€æœ‰ä¸»æœºçš„é»˜è®¤ç½‘å…³ IP åœ°å€ã€‚å¦‚æœç›®æ ‡ IP åœ°å€è¶…å‡ºå…¶å­ç½‘èŒƒå›´ï¼Œåˆ™æ‰€æœ‰è®¡ç®—æœºéƒ½ä¼šå°†æµé‡è½¬å‘åˆ°æ­¤ IP åœ°å€ã€‚</p>



<p><strong>1. æ£€æŸ¥ 8021q å’Œæ¡¥æ¥æ¨¡å—æ˜¯å¦å·²åŠ è½½</strong></p>



<p>$&nbsp;sudo su</p>



<p>#&nbsp;lsmod | grep 8021q</p>



<p>8021q 19587 0</p>



<p>garp 5901 1 8021q</p>



<p>å¦‚æœ 8021q æ¨¡å—æœªåŠ è½½ï¼Œè¯·ä½¿ç”¨ modprobe 8021q å‘½ä»¤å°†æ¨¡å—åŠ è½½åˆ°å†…æ ¸ã€‚</p>



<p>Open vSwitch æ•°æ®è·¯å¾„éœ€è¦å°†æ¡¥æ¥æ”¯æŒ (CONFIG_BRIDGE) æ„å»ºä¸ºå†…æ ¸æ¨¡å—ã€‚æ¡¥æ¥æ¨¡å—ä¸å¾—åŠ è½½æˆ–ä½¿ç”¨ã€‚</p>



<p>#&nbsp;lsmod | grep bridge</p>



<p>bridge 61159 0</p>



<p>stp 1563 2 bridge,garp</p>



<p>llc 4392 3 bridge,garp,stp</p>



<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¡¥æ¥æ¨¡å—æ­£åœ¨è¿è¡Œï¼Œæˆ‘ä»¬å¿…é¡»å°†å…¶ç§»é™¤ã€‚</p>



<p>#&nbsp;rmmod bridge</p>



<p><strong>2. ä¸‹è½½ Openvswitch å¹¶è§£å‹</strong></p>



<p>#&nbsp;wget http://openvswitch.org/releases/openvswitch-1.2.0.tar.gz</p>



<p>#&nbsp;tar zxvf ./openvswitch-1.2.0.tar.gz</p>



<p><strong>3. å®‰è£… Open Vswitch ç¼–è¯‘æ‰€éœ€çš„ä¾èµ–é¡¹</strong></p>



<p>#<strong>&nbsp;</strong>yum install python PyQt4 python-zope-interface python-twisted-conch python-simplejson perl kernel-devel<strong></strong></p>



<p><strong>4. Openvswitch å®‰è£…é‡å¯å</strong></p>



<p>#&nbsp;cd ./openvswitch-1.2.0</p>



<p>#&nbsp;./configure &#8211;with-linux=/lib/modules/`uname -r`/build</p>



<p>#&nbsp;make</p>



<p>#&nbsp;make install</p>



<p><strong>5. åŠ è½½Openvswitchå†…æ ¸æ¨¡å—</strong></p>



<p>ç¼–è¯‘å®Œæˆåï¼Œ./datapath/linux/directoryä¸‹ä¼šä¿å­˜ä¸€ä¸ªå†…æ ¸æ¨¡å—openvswitch_mod_koï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ç”¨insmodå‘½ä»¤å°†å…¶åŠ è½½åˆ°Linuxå†…æ ¸ä¸­ã€‚</p>



<p>#&nbsp;insmod ./datapath/linux/openvswitch_mod.ko</p>



<p>æ£€æŸ¥æ¨¡å—æ˜¯å¦å·²åŠ è½½ï¼š</p>



<p>#&nbsp;lsmod | grep openvswitch_mod</p>



<p>openvswitch_mod 67954 0</p>



<p><strong>6. åŠ è½½ openvswitch å†…æ ¸æ¨¡å—å¹¶ä½¿å…¶åœ¨å¯åŠ¨æ—¶åŠ è½½</strong></p>



<p>å³ä½¿å¯ä»¥ä½¿ç”¨ insmod å‘½ä»¤å°†æ¨¡å—åŠ è½½åˆ°å†…æ ¸ï¼Œä¹Ÿæ— æ³•ä½¿ç”¨ modprobe å‘½ä»¤åŠ è½½ã€‚æˆ‘ä»¬å°†ä¿®å¤æ­¤é—®é¢˜ã€‚</p>



<p><strong>a)&nbsp;ä»å†…æ ¸å¸è½½æ¨¡å—å¹¶å°†å…¶å¤åˆ¶åˆ°æ ‡å‡†ä½ç½®</strong></p>



<p>#&nbsp;rmmod openvswitch_mod</p>



<p>#&nbsp;mkdir /lib/modules/2.6.32-71.29.1.el6.i686/kernel/net/openvswitch/</p>



<p>#&nbsp;cp ./datapath/linux/openvswitch_mod.ko /lib/modules/2.6.32-71.29.1.el6.i686/kernel/net/openvswitch/</p>



<p><strong>b)&nbsp;åˆ›å»ºä¾èµ–é¡¹åˆ—è¡¨å¹¶å°†å…¶å†™å…¥ /lib/modules/`uname -r`/modules.dep</strong></p>



<p>#&nbsp;depmod -a</p>



<p><strong>c)&nbsp;ä½¿ç”¨ modprobe å‘½ä»¤åŠ è½½æ¨¡å—</strong></p>



<p>#&nbsp;modprobe openvswitch_mod</p>



<p><strong>d)&nbsp;ä½¿æ¨¡å—åœ¨é‡å¯ååŠ è½½</strong></p>



<p>æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªç®€å•çš„è„šæœ¬ï¼Œå­˜å‚¨åœ¨æ–‡ä»¶ /etc/sysconfig/modules ä¸­ã€‚å¦‚æœæ¨¡å—å°šæœªåŠ è½½ï¼Œåˆ™è„šæœ¬ä¼šåŠ è½½è¯¥æ¨¡å—ã€‚</p>



<p>#&nbsp;touch /etc/sysconfig/modules/openvswitch.modules</p>



<p>#&nbsp;chmod 755 /etc/sysconfig/modules/openvswitch.modules</p>



<p>#&nbsp;vi /etc/sysconfig/modules/openvswitch.modules</p>



<p>#!/bin/sh</p>



<p>if [ $(grep -c openvswitch_mod /proc/modules) -eq 0 ]; then</p>



<p>modprobe -b openvswitch_mod &gt; /dev/null 2&gt;&amp;1</p>



<p>fi</p>



<p>å¦‚æœ grep è¿”å›å€¼ 0ï¼Œåˆ™è¡¨ç¤ºæ¨¡å— openvswitch_mod.ko æœªåŠ è½½ï¼Œå°†ç”± modprobe å‘½ä»¤åŠ è½½ã€‚</p>



<p><strong>e)&nbsp;æ£€æŸ¥ RAID è®¾å¤‡æ˜¯å¦æ­£å¸¸å·¥ä½œ</strong></p>



<p>æ£€æŸ¥ RAID çš„çŠ¶æ€ã€‚å¦‚æœç£ç›˜ /dev/sda1 å’Œ /dev/sdb1 æœ‰é—®é¢˜ï¼Œè¯·å°†è®¾å¤‡è¯»å–åˆ° /dev/md0ã€‚è¿™åœ¨ CentOS å®‰è£…ä¸­å·²ç»æ˜¾ç¤ºè¿‡ã€‚</p>



<p><strong>7. ä½¿ç”¨ ovsdb-tool åˆå§‹åŒ–é…ç½®æ•°æ®åº“</strong></p>



<p>#&nbsp;mkdir -p /usr/local/etc/openvswitch</p>



<p>#&nbsp;ovsdb-tool create /usr/local/etc/openvswitch/conf.db vswitchd/vswitch.ovsschema</p>



<p><strong>8.&nbsp;</strong><strong>å¯åŠ¨é…ç½®æ•°æ®åº“ ovsdb-server å¹¶ä½¿å…¶åœ¨å¯åŠ¨æ—¶å¯åŠ¨</strong><strong></strong></p>



<p>#&nbsp;/usr/local/sbin/ovsdb-server /usr/local/etc/openvswitch/conf.db&nbsp;</p>



<p>&#8211;remote=punix:/usr/local/var/run/openvswitch/db.sock&nbsp;</p>



<p>&#8211;remote=db:Open_vSwitch,manager_options&nbsp;</p>



<p>&#8211;private-key=db:SSL,private_key&nbsp;</p>



<p>&#8211;certificate=db:SSL,certificate&nbsp;</p>



<p>&#8211;bootstrap-ca-cert=db:SSL,ca_cert&nbsp;</p>



<p>&#8211;pidfile &#8211;detach</p>



<p>è¦åœ¨å¯åŠ¨æœŸé—´å¯åŠ¨æ•°æ®åº“ï¼Œæ‚¨éœ€è¦å°†è¿™äº›è¡Œå¤åˆ¶åˆ° /etc/rc.localã€‚<em></em></p>



<p><strong>æ³¨æ„</strong>&nbsp; ç”±äºè¯¥å‘½ä»¤æ˜¯å•ä¸ªå‘½ä»¤ï¼Œå› æ­¤è¯·ä¸è¦å°†å…¶æ”¾åœ¨å•ç‹¬çš„è¡Œä¸Šã€‚</p>



<p><strong>9. ä½¿ç”¨ ovs-vsctl åˆå§‹åŒ–æ•°æ®åº“å¹¶åœ¨å¯åŠ¨æœŸé—´åˆå§‹åŒ–å®ƒ</strong></p>



<p>è¿™ä»…åœ¨æ‚¨ä½¿ç”¨ ovsdb-tool åˆ›å»ºæ•°æ®åº“åç¬¬ä¸€æ¬¡è¿è¡Œæ‰æ˜¯å¿…è¦çš„ï¼ˆä½†åœ¨ä»»ä½•æ—¶å€™è¿è¡Œå®ƒéƒ½æ˜¯æ— å®³çš„ï¼‰ã€‚</p>



<p>#&nbsp;/usr/local/bin/ovs-vsctl &#8211;no-wait init</p>



<p>#&nbsp;echo &#8220;/usr/local/sbin/ovs-vsctl &#8211;no-wait init&#8221; &gt;&gt; /etc/rc.local</p>



<p><strong>10. å¯åŠ¨ä¸» Open vSwitch å®ˆæŠ¤è¿›ç¨‹ï¼Œå‘Šè¯‰å®ƒè¿æ¥åˆ°åŒä¸€ä¸ª Unix åŸŸå¥—æ¥å­—å¹¶åœ¨å¯åŠ¨æœŸé—´å¯åŠ¨å®ˆæŠ¤è¿›ç¨‹</strong></p>



<p>#&nbsp;/usr/local/sbin/ovs-vswitchd unix:/usr/local/var/run/openvswitch/db.sock &#8211;pidfile &#8211;detach</p>



<p>#&nbsp;echo &#8220;/usr/local/sbin/ovs-vswitchd unix:/usr/local/var/run/openvswitch/db.sock &#8211;pidfile &#8211;detach&#8221; &gt;&gt; /etc/rc.local</p>



<p><strong>11. å¯ç”¨æ¥å£ä¹‹é—´çš„ IPv4 å’Œ IPV6 æ•°æ®åŒ…è½¬å‘</strong></p>



<p>è™½ç„¶ä¸ Openvswitch é…ç½®æ— å…³ï¼Œä½†æˆ‘ä»¬éœ€è¦å¯ç”¨æ¥å£ä¹‹é—´çš„ ipv4 å’Œ ipv6 æ•°æ®åŒ…è½¬å‘ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™äº›é€‰é¡¹æ˜¯ç¦ç”¨çš„ã€‚</p>



<p>#&nbsp;sysctl -w net.ipv4.ip_forward=1</p>



<p>#&nbsp;sysctl -w net.ipv6.conf.all.forwarding=1</p>



<p>è¦åœ¨å¯åŠ¨æ—¶å¯ç”¨è½¬å‘ï¼Œæ‚¨éœ€è¦ç¼–è¾‘ /etc/sysctl.conf å¹¶æ›´æ”¹/æ·»åŠ ä»¥ä¸‹è¡Œã€‚</p>



<p>net.ipv4.ip_forward=1</p>



<p>net.ipv6.conf.default.forwarding=1</p>



<p><strong>12. Openvswitch é…ç½®-åˆ›å»ºç½‘æ¡¥ br0ï¼Œå‘ç½‘æ¡¥æ·»åŠ æ¥å£</strong></p>



<p><strong>a)&nbsp;åˆ›å»ºç½‘æ¡¥ br0</strong></p>



<p><strong>#&nbsp;</strong>ovs-vsctl add-br br0</p>



<p><strong>b)&nbsp;å°†ç«¯å£ eth0-eth2ã€wlan0 æ·»åŠ åˆ°ç½‘æ¡¥</strong></p>



<p>#&nbsp;ovs-vsctl add-port br0 eth0</p>



<p>#&nbsp;ovs-vsctl add-port br0 eth1</p>



<p>#&nbsp;ovs-vsctl add-port br0 eth2</p>



<p>#&nbsp;ovs-vsctl add-port br0 wlan0</p>



<p><strong>c)&nbsp;åˆ›å»º L3 vlan1 è™šæ‹Ÿæ¥å£</strong></p>



<p>#&nbsp;ovs-vsctl add-port br0 vlan1 &#8212; set interface vlan1 type=internal</p>



<p>æ£€æŸ¥ vlan1 æ˜¯å¦å­˜åœ¨ï¼Œå¯åŠ¨æ¡¥æ¥æ¥å£</p>



<p>#&nbsp;ifconfig vlan1</p>



<p>vlan1 Link encap:Ethernet HWaddr 00:23:20:80:C9:A2</p>



<p>BROADCAST MULTICAST MTU:1500 Metric:1</p>



<p>RX packets:0 errors:0 dropped:0 overruns:0 frame:0</p>



<p>TX packets:0 errors:0 dropped:0 overruns:0 carrier:0</p>



<p>collisions:0 txqueuelen:0</p>



<p>RX bytes:0 (0.0 b) TX bytes:0 (0.0 b)</p>



<p>#&nbsp;ifconfig vlan1 up</p>



<p>#&nbsp;ifconfig eth0 up</p>



<p>#&nbsp;ifconfig eth1 up</p>



<p>#&nbsp;ifconfig eth2 up</p>



<p>#&nbsp;ifconfig wlan0 up</p>



<p>è¦åœ¨å¯åŠ¨è¿‡ç¨‹ä¸­å¯åŠ¨æ¥å£ï¼Œæ‚¨éœ€è¦å°† /etc/sysconfig/network-scripts/ ä¸­æ¯ä¸ª ifcfg-ethx è„šæœ¬çš„å‚æ•° ONBOOT=&#8221;no&#8221; æ›´æ”¹ä¸º ONBOOT=&#8221;yes&#8221;ã€‚å¯¹æ‰€æœ‰ä»¥å¤ªç½‘æ¥å£æ‰§è¡Œæ­¤æ“ä½œã€‚</p>



<p>#&nbsp;sed -i &#8216;s/ONBOOT=&#8221;no&#8221;/ONBOOT=&#8221;yes&#8221;/g&#8217; /etc/sysconfig/network-scripts/ifcfg-eth0</p>



<p>#&nbsp;sed -i &#8216;s/ONBOOT=&#8221;no&#8221;/ONBOOT=&#8221;yes&#8221;/g&#8217; /etc/sysconfig/network-scripts/ifcfg-eth1</p>



<p>#&nbsp;sed -i &#8216;s/ONBOOT=&#8221;no&#8221;/ONBOOT=&#8221;yes&#8221;/g&#8217; /etc/sysconfig/network-scripts/ifcfg-eth2</p>



<p>#&nbsp;sed -i &#8216;s/ONBOOT=&#8221;no&#8221;/ONBOOT=&#8221;yes&#8221;/g&#8217; /etc/sysconfig/network-scripts/ifcfg-eth3</p>



<p>#&nbsp;sed -i &#8216;s/ONBOOT=&#8221;no&#8221;/ONBOOT=&#8221;yes&#8221;/g&#8217; /etc/sysconfig/network-scripts/ifcfg-wlan0</p>



<p><strong>d)&nbsp;ä½¿vlan1æ¥å£çš„IPåœ°å€åœ¨é‡å¯åä¿ç•™</strong></p>



<p>#&nbsp;vi /etc/sysconfig/network-scripts/ifcfg-vlan1</p>



<p>DEVICE=vlan1</p>



<p>ONBOOT=yes</p>



<p>BOOTPROTO=static</p>



<p>IPADDR=172.18.100.150</p>



<p>NETMASK=255.255.0.0</p>



<p><strong>13. åˆ›å»º Openvswitch åˆå§‹åŒ–è„šæœ¬</strong></p>



<p>å½“ Openvswitch åœ¨ OS å¯åŠ¨æœŸé—´å¯åŠ¨æ—¶ï¼Œå®ƒä¼šè¯»å–è‡ªå·±çš„æ•°æ®åº“å¹¶åˆ›å»º vlan1 æ¥å£ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¿…é¡»åˆ›å»ºä¸€ä¸ª init è„šæœ¬ï¼Œä»¥ä¾¿åœ¨åˆå§‹åŒ–ç½‘ç»œæ¥å£ä¹‹å‰å¯åŠ¨ openvswitchã€‚ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¿…é¡»å°† openvswitch çš„å¯åŠ¨ä¼˜å…ˆçº§è®¾ç½®ä¸ºä½äºç½‘ç»œä¼˜å…ˆçº§ S=10 çš„ S=9ã€‚</p>



<p><strong>a)&nbsp;åˆ›å»ºå¯åŠ¨è„šæœ¬ /etc/init.d/openvswitchd</strong></p>



<p>#&nbsp;&nbsp;vi /etc/init.d/openvswitchd</p>



<p><strong>b)&nbsp;é…ç½® Openvswitch è„šæœ¬ä»¥åœ¨å¯åŠ¨æ—¶å¯åŠ¨</strong></p>



<p>#&nbsp;chmod 755 /etc/init.d/openvswitchd</p>



<p>#&nbsp;chkconfig &#8211;add openvswitchd</p>



<p>#&nbsp;chkconfig openvswitchd on&nbsp;</p>



<p><strong>End.</strong></p>



<h1 class="wp-block-heading"><strong>ç¬¬ 5 éƒ¨åˆ† &#8211; å°†ç›’å­è¿æ¥åˆ°äº’è”ç½‘ &#8211; PPPoE é…ç½®</strong></h1>



<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»åœ¨è®¡ç®—æœºä¸Šå®‰è£…äº† Linux CentOSï¼Œä¸ºæ— çº¿ç”¨æˆ·è¿æ¥åˆ›å»ºäº†æ¥å…¥ç‚¹ï¼Œå¹¶é…ç½®äº† Open vSwitch æ¥è¿æ¥æœ‰çº¿ LAN ç”¨æˆ·ã€‚ç°åœ¨æ˜¯æ—¶å€™ç»§ç»­å‰è¿›ï¼Œå°†æˆ‘ä»¬çš„ Linux L3 äº¤æ¢æœºè¿æ¥åˆ°äº’è”ç½‘äº†ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¿…é¡»å®‰è£…å’Œé…ç½® PPPoEã€‚</p>



<p>PPPoE ä»£è¡¨ä»¥å¤ªç½‘ä¸Šçš„ç‚¹å¯¹ç‚¹ï¼Œå®ƒæ˜¯ä¸€ç§ç¬¬ 2 å±‚ç½‘ç»œåè®®ï¼Œå°† PPP å¸§å°è£…åœ¨ä»¥å¤ªç½‘å¸§å†…ã€‚æˆ‘ä»¬çš„ Linux L3 äº¤æ¢æœºï¼ˆè·¯ç”±å™¨ï¼‰ä»£è¡¨ PPPoE å®¢æˆ·ç«¯ï¼Œå¹¶å‘ PPPoE æœåŠ¡å™¨æäº¤ç™»å½•å‡­æ®ã€‚PPPoE æœåŠ¡å™¨ä½äº ISP ç½‘ç»œä¸Šï¼Œå¹¶ä¸ºå®¢æˆ·ç«¯æä¾›èº«ä»½éªŒè¯æœåŠ¡ã€‚</p>



<p><strong>1. åœ¨å¯åŠ¨æ—¶å°†è·¯ç”±æ¥å£ Ethernet3 ç½®äºå¯åŠ¨çŠ¶æ€</strong></p>



<p>æˆ‘ä»¬å°†ä½¿ç”¨ D-Link DGE-528T åƒå…†ä»¥å¤ªç½‘é€‚é…å™¨ &#8211; å…¶æ˜¾ç¤ºä¸ºä»¥å¤ªç½‘ 3 æ¥å£ï¼Œç”¨äº WAN è¿æ¥ã€‚æ¥å£å¿…é¡»åœ¨å¯åŠ¨æ—¶å¯åŠ¨ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»åœ¨ /etc/sysconfig/network-scripts/ifcfg-eth3configuration ä¸­å°†å‚æ•° ONBOOT=&#8221;no&#8221; æ›´æ”¹ä¸º ONBOOT=&#8221;yes&#8221;ã€‚</p>



<p>[root@swouter-x86 ~]#&nbsp;<code>sed -i 's/ONBOOT="no"/ONBOOT="yes"/g' /etc/sysconfig/network-scripts/ifcfg-eth3</code></p>



<p><strong>2.&nbsp; åŠ è½½pppoeæ¨¡å—åˆ°å†…æ ¸</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;modprobe pppoe</p>



<p>å¦‚æœ pppoe æ¨¡å—æ— æ³•åŠ è½½åˆ°å†…æ ¸ï¼Œè¯·æ£€æŸ¥æ­¤é“¾æ¥ä»¥ä¾›å‚è€ƒã€‚</p>



<p><strong>3. å®‰è£… ppp å¹¶é…ç½®ç™»å½•å‡­æ®</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;yum install ppp.i686<strong></strong></p>



<p>ç™»å½•å‡­æ®å­˜å‚¨åœ¨æ–‡ä»¶ /etc/ppp/chap-secrets ä¸­ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨ pppd è¿›è¡Œå¤šä¸ªè¿æ¥ï¼Œåˆ™éœ€è¦å¼•å…¥å”¯ä¸€ ID ä»¥åŠç™»å½•åå’Œå¯†ç ã€‚ä¸‹é¢çš„ç¤ºä¾‹å°†ç”¨æˆ· brezular åŠå…¶ ID my_ID å’Œå¯†ç  my_password æ·»åŠ åˆ°æ–‡ä»¶ /etc/ppp/chap-secrets ä¸­ã€‚</p>



<p>[root@swouter-x86 ~]#&nbsp;<code>echo "brezular my_ID my_password" &gt;&gt; /etc/ppp/chap-secrets</code></p>



<p><strong>4. åœ¨ /etc/ppp/peers/ ç›®å½•ä¸­åˆ›å»ºé…ç½®æ–‡ä»¶ my_ISP</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;vi /etc/ppp/peers/my_ISP</p>



<p>plugin rp-pppoe.so</p>



<p># æˆ‘ä»¬é€šè¿‡å…¶æ¥æ”¶ pppoe çš„ç½‘ç»œæ¥å£</p>



<p>eth3</p>



<p># ç”¨æˆ·å &#8211; ä¸ /etc/ppp/chap-secret ä¸­çš„ç›¸åŒ</p>



<p>user brezular</p>



<p># ä½¿ç”¨ ISP æä¾›å•†çš„ IP åœ°å€</p>



<p>noipdefault</p>



<p># ä½¿ç”¨æä¾›å•†çš„ DNS æœåŠ¡å™¨</p>



<p>usepeerdns</p>



<p>chmod 755 /etc/ppp/ip-up.local</p>



<p># å›ºå®šè¿æ¥</p>



<p>persist</p>



<p># æä¾›å•†çš„è·¯ç”±å™¨å°†ç”¨ä½œç½‘å…³</p>



<p>defaultroute</p>



<p># æ¥è‡ª chap-secrets çš„å”¯ä¸€ ID</p>



<p>remotename my_ID</p>



<p><strong>5. å¯åŠ¨ pppd</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;/usr/sbin/pppd call my_ISP</p>



<p>æ˜¾ç¤ºæ–‡ä»¶ /var/log/messages çš„å†…å®¹æ¥æŸ¥æ‰¾æ—¥å¿—æ¶ˆæ¯ã€‚</p>



<p>[root@swouter-x86 ~]#&nbsp;tail -n 14 /var/log/messages</p>



<p>Aug 23 01:08:38 swouter-x86 pppd[2148]: Plugin rp-pppoe.so loaded.</p>



<p>Aug 23 01:08:38 swouter-x86 pppd[2148]: RP-PPPoE plugin version 3.8p compiled against pppd 5</p>



<p>Aug 23 01:08:38 swouter-x86 pppd[2149]: pppd 2.4.5 started by root, uid 0</p>



<p>Aug 23 01:08:38 swouter-x86 pppd[2149]: PPP session is 12411</p>



<p>Aug 23 01:08:38 swouter-x86 pppd[2149]: Connected to 00:90:1a:42:14:05 via interface eth3</p>



<p>Aug 23 01:08:38 swouter-x86 pppd[2149]: Using interface ppp0</p>



<p>Aug 23 01:08:38 swouter-x86 pppd[2149]: Connect: ppp0 &lt;&#8211;&gt; eth3</p>



<p>Aug 23 01:08:38 swouter-x86 pppd[2149]: CHAP authentication succeeded: CHAP authentication 9</p>



<p>Aug 23 01:08:38 swouter-x86 pppd[2149]: CHAP authentication succeeded</p>



<p>Aug 23 01:08:38 swouter-x86 pppd[2149]: peer from calling number 00:90:1A:42:14:05 authorizd</p>



<p>Aug 23 01:08:38 swouter-x86 pppd[2149]: local IP address 91.127.65.93</p>



<p>Aug 23 01:08:38 swouter-x86 pppd[2149]: remote IP address 213.81.232.247</p>



<p>Aug 23 01:08:38 swouter-x86 pppd[2149]: primary DNS address 195.146.132.58</p>



<p>Aug 23 01:08:38 swouter-x86 pppd[2149]: secondary DNS address 195.146.128.62</p>



<p>PPP ä¼šè¯çš„å”¯ä¸€ ID ä¸º 12411ï¼Œå¯¹ç­‰æ–¹çš„ç›®æ ‡åœ°å€ä¸º 00:90:1a:42:14:05ã€‚ppp0 æ¥å£çš„ IP åœ°å€ä¸º 91.127.65.93ï¼ŒPPPoE æ¥å…¥é›†ä¸­å™¨çš„ IP åœ°å€ä¸º 213.81.232.247ã€‚CHAP èº«ä»½éªŒè¯æˆåŠŸã€‚ä¸» DNS æœåŠ¡å™¨å’Œè¾…åŠ© DNS æœåŠ¡å™¨çš„ IP åœ°å€éƒ½å°†å­˜å‚¨åœ¨ /var/run/ppp/resolv.conf ä¸­ã€‚</p>



<p><strong>6. DNS é…ç½® &#8211; æ›´æ–° /etc/resolv.conf</strong></p>



<p>é—®é¢˜ï¼š</p>



<p>pppd å¯åŠ¨æ—¶æ–‡ä»¶ /etc/resolv.conf æœªæ›´æ–°ã€‚å¯é€šè¿‡å°†å¤åˆ¶å‘½ä»¤æ·»åŠ åˆ° /etc/ppp/ip-up.local æ¥è§£å†³æ­¤é—®é¢˜ã€‚è¯¥å‘½ä»¤å°†åç§°æœåŠ¡å™¨åˆ—è¡¨ä» /var/run/ppp/resolv.conf å¤åˆ¶åˆ° /etc/resolv.confã€‚è„šæœ¬ ip-up.local ç”± ip-up è„šæœ¬è°ƒç”¨ã€‚</p>



<p>[root@swouter-x86 ~]#&nbsp;<code>echo "cp /var/run/ppp/resolv.conf /etc/resolv.conf" &gt; /etc/ppp/ip-up.local</code></p>



<p>[root@swouter-x86 ppp]#&nbsp;chmod 755 /etc/ppp/ip-up.local</p>



<p><strong>7. åˆ›å»ºåˆå§‹åŒ–è„šæœ¬ä»¥ä½¿ pppd å®ˆæŠ¤è¿›ç¨‹åœ¨å¯åŠ¨æ—¶å¯åŠ¨</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;vi /etc/init.d/pppd</p>



<p>#!/bin/sh</p>



<p><code>#</code></p>



<p><code># start/stop the pppd</code></p>



<p><code>#</code></p>



<p><code># chkconfig: 2345 11 86</code></p>



<p><code># description: pppd daemon</code></p>



<p><code># processname: pppd</code></p>



<p><code># config: /etc/ppp/peers/my_ISP</code></p>



<p><code># pidfile: /var/run/ppp0.pid</code></p>



<p><code>#</code></p>



<p><code>PATH=/bin:/usr/bin:/usr/local/bin:/sbin:/usr/sbin</code></p>



<p><code>export PATH</code></p>



<p># Source function library.</p>



<p><code>. /etc/rc.d/init.d/functions</code></p>



<p>stop()</p>



<p><code>{</code></p>



<p><code>echo -n "Stopping pppd daemon: "</code></p>



<p><code>killproc pppd</code></p>



<p><code>echo</code></p>



<p><code>rm -f /var/lock/subsys/pppd</code></p>



<p><code>}</code></p>



<p>start()</p>



<p><code>{</code></p>



<p><code>echo -n "Starting pppd daemon: "</code></p>



<p><code>daemon /usr/sbin/pppd call my_ISP</code></p>



<p><code>echo</code></p>



<p><code>touch /var/lock/subsys/</code></p>



<p><code>}</code></p>



<p># See how we were called.</p>



<p><code>case "$1" in</code></p>



<p><code>start)</code></p>



<p><code>start</code></p>



<p><code>;;</code></p>



<p><code>stop)</code></p>



<p><code>stop</code></p>



<p><code>;;</code></p>



<p><code>status)</code></p>



<p><code>status pppd</code></p>



<p><code>;;</code></p>



<p><code>restart)</code></p>



<p><code>stop</code></p>



<p><code>start</code></p>



<p><code>;;</code></p>



<p><code>*)</code></p>



<p><code>echo "Usage: pppd {start|stop|status|restart}"</code></p>



<p><code>exit 1</code></p>



<p><code>esac</code></p>



<p><code>&nbsp;exit 0</code></p>



<p>[root@swouter-x86 ~]#&nbsp;&nbsp;chmod 755 /etc/init.d/pppd</p>



<p>[root@swouter-x86 ~]#&nbsp;&nbsp;<code>chkconfig --add pppd</code>&nbsp;&nbsp;</p>



<p><strong>END.</strong></p>



<p>è¿™æ˜¯æˆ‘åœ¨ç¼–å†™æ•™ç¨‹æœŸé—´ä½¿ç”¨è¿‡çš„æ–‡ç« åˆ—è¡¨ã€‚</p>



<p>http://www.lampdocs.com/home-personal/pppoe-connection/</p>



<figure class="wp-block-embed"><div class="wp-block-embed__wrapper">
https://wiki.archlinux.org/index.php/PPPoE_Setup_with_pppd
</div></figure>



<p>http://www.brennan.id.au/05-Broadband_Connectivity.html</p>



<figure class="wp-block-embed"><div class="wp-block-embed__wrapper">
https://bugzilla.redhat.com/show_bug.cgi?id=517470
</div></figure>



<h1 class="wp-block-heading"><strong>ç¬¬ 6 éƒ¨åˆ† &#8211; å°†ç›’å­è¿æ¥åˆ°äº’è”ç½‘ &#8211; NAT å’Œé˜²ç«å¢™é…ç½®</strong></h1>



<p>è¿™æ˜¯ç³»åˆ—æ•™ç¨‹ä¸­çš„å¦ä¸€ç¯‡ï¼Œä»‹ç»å¦‚ä½•åœ¨ x86 ç¡¬ä»¶ä¸Šæ„å»º Linux ç¬¬ 3 å±‚äº¤æ¢æœºã€‚åœ¨ä¸Šä¸€ç¯‡æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡è·¯ç”±ç«¯å£å°†äº¤æ¢æœºè¿æ¥åˆ° Internetã€‚è¦å°† LAN ç”¨æˆ·è¿æ¥åˆ° Internetï¼Œæˆ‘ä»¬å¿…é¡»åœ¨äº¤æ¢æœºä¸Šé…ç½® NAT å’Œé˜²ç«å¢™ã€‚</p>



<p>æœ¬æ–‡å±•ç¤ºäº†é˜²ç«å¢™å’Œ NAT é…ç½®ã€‚å®ƒæ²¡æœ‰è§£é‡Š IP æ•°æ®åŒ…è¿‡æ»¤æˆ– IP ä¼ªè£…å¦‚ä½•å·¥ä½œï¼Œæœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·è®¿é—®ä»¥ä¸‹ç½‘ç«™ï¼š</p>



<p>http://en.wikipedia.org/wiki/Firewall_%28computing%29</p>



<p>http://en.wikipedia.org/wiki/Network_address_translation</p>



<p><strong>1. æ£€æŸ¥æœåŠ¡ itables æ˜¯å¦æ­£åœ¨è¿è¡Œ</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;etc/init.d/iptables status</p>



<p>iptables: Firewall is not running.</p>



<p>è­¦å‘Šæ¶ˆæ¯â€œiptablesï¼šé˜²ç«å¢™æœªè¿è¡Œâ€å‘Šè¯‰æˆ‘ä»¬ iptables æœåŠ¡æœªè¿è¡Œã€‚æˆ‘ä»¬å¿…é¡»ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ iptables æœåŠ¡ï¼š</p>



<p>[root@swouter-x86 ~]#/etc/init.d/iptables start</p>



<p>iptables: Applying firewall rules: [&nbsp; OK&nbsp; ]</p>



<p>å†æ¬¡æ£€æŸ¥iptablesçŠ¶æ€ï¼š</p>



<p>[root@swouter-x86 ~]#/etc/init.d/iptables status</p>



<p>Table:&nbsp;nat</p>



<p>Chain PREROUTING (policy ACCEPT)</p>



<p>num&nbsp; target&nbsp;&nbsp;&nbsp;&nbsp; prot opt source&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; destination</p>



<p>Chain POSTROUTING (policy ACCEPT)</p>



<p>num&nbsp; target&nbsp;&nbsp;&nbsp;&nbsp; prot opt source&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; destination</p>



<p>Chain OUTPUT (policy ACCEPT)</p>



<p>num&nbsp; target&nbsp;&nbsp;&nbsp;&nbsp; prot opt source&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; destination</p>



<p>Table:&nbsp;filter</p>



<p>Chain INPUT (policy ACCEPT)</p>



<p>num&nbsp; target&nbsp;&nbsp;&nbsp;&nbsp; prot opt source&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; destination</p>



<p>1&nbsp;&nbsp;&nbsp; ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; all&nbsp; &#8212;&nbsp; 0.0.0.0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0.0.0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; state RELATED,ESTABLISHED</p>



<p>2&nbsp;&nbsp;&nbsp; ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; icmp &#8212;&nbsp; 0.0.0.0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0.0.0/0</p>



<p>3&nbsp;&nbsp;&nbsp; ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; all&nbsp; &#8212;&nbsp; 0.0.0.0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0.0.0/0</p>



<p>4&nbsp;&nbsp;&nbsp; ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; tcp&nbsp; &#8212;&nbsp; 0.0.0.0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0.0.0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; state NEW tcp dpt:22</p>



<p>5&nbsp;&nbsp;&nbsp; REJECT&nbsp;&nbsp;&nbsp;&nbsp; all&nbsp; &#8212;&nbsp; 0.0.0.0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0.0.0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reject-with icmp-host-prohibited</p>



<p>Chain FORWARD (policy ACCEPT)</p>



<p>num&nbsp; target&nbsp;&nbsp;&nbsp;&nbsp; prot opt source&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; destination</p>



<p>1&nbsp;&nbsp;&nbsp; REJECT&nbsp;&nbsp;&nbsp;&nbsp; all&nbsp; &#8212;&nbsp; 0.0.0.0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0.0.0/0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; reject-with icmp-host-prohibited</p>



<p>Chain OUTPUT (policy ACCEPT)</p>



<p>num&nbsp; target&nbsp;&nbsp;&nbsp;&nbsp; prot opt source&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; destination</p>



<p>ä»ä¸Šé¢çš„è¾“å‡ºä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åŠ è½½äº†ä¸¤ä¸ªè¡¨ &#8211; NAT å’Œè¿‡æ»¤è¡¨ã€‚æˆ‘ä»¬éœ€è¦å®ƒä»¬ &#8211; NAT è¡¨ç”¨äºä¼ªè£…ï¼Œè¿‡æ»¤è¡¨ç”¨äºé˜²ç«å¢™ã€‚</p>



<p>å¦‚æœæ²¡æœ‰æ˜¾ç¤ºè¡¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å‘½ä»¤è½»æ¾åœ°å°†å…¶åŠ è½½åˆ° Linux å†…æ ¸ã€‚</p>



<p>[root@swouter-x86 ~]#modprobe iptable_filter</p>



<p>[root@swouter-x86 ~]#modprobe iptable_nat</p>



<p>ç¬¬ä¸‰ä¸ªè¡¨æ˜¯ Mangle è¡¨ï¼Œå®ƒæœªæ˜¾ç¤ºåœ¨è¾“å‡ºä¸­ã€‚æ­¤è¡¨ç”¨äºæœåŠ¡è´¨é‡ (QOS)ï¼Œæˆ‘ä»¬ä¸ä¼šä½¿ç”¨å®ƒã€‚å¦‚æœå·²åŠ è½½å®ƒå¹¶ä¸”æ‚¨ä¸æ‰“ç®—ä½¿ç”¨ QoSï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†å…¶å¸è½½ï¼š</p>



<p>[root@swouter-x86 ~]#rmmod iptable_mangle</p>



<p><strong>2.&nbsp;</strong><strong>åˆ·æ–°è¡¨è¿‡æ»¤å™¨å’Œ nat ä¸­çš„è§„åˆ™</strong><strong></strong></p>



<p>è¿™æ˜¯æˆ‘ä»¬å°†è¦ä½¿ç”¨çš„é€‰é¡¹åˆ—è¡¨ã€‚ä¸¤ä¸ªé€‰é¡¹éƒ½æ˜¯æ­£ç¡®çš„ï¼Œè¯·ä½¿ç”¨å…¶ä¸­ä¸€ä¸ªæ¥ç¼–å†™è§„åˆ™ã€‚</p>



<p><code>--flush</code>&nbsp;&nbsp;&nbsp; &nbsp;=&nbsp;-F</p>



<p><code>--table</code>&nbsp;&nbsp;&nbsp; &nbsp;=&nbsp;-t</p>



<p><code>--append</code>&nbsp; &nbsp;=&nbsp;-A</p>



<p><code>--out-interface</code>&nbsp;=&nbsp;-o</p>



<p><code>--in-interface</code>&nbsp; =&nbsp;-i</p>



<p><code>--jump</code>&nbsp; &nbsp; &nbsp; &nbsp; =&nbsp;-j</p>



<p><strong>a)&nbsp;Flush è¿‡æ»¤è¡¨</strong></p>



<p>å¦‚æœæ‚¨ä¸æŒ‡å®šå…·ä½“çš„è¡¨ï¼Œæ‚¨çš„æ›´æ”¹å°†å§‹ç»ˆåœ¨ Filter è¡¨ä¸Šè¿›è¡Œï¼Œå› ä¸ºå®ƒè¢«è§†ä¸ºé»˜è®¤ iptableã€‚ä¾‹å¦‚ï¼š</p>



<p>[root@swouter-x86 ~]#<code>iptables --flush</code></p>



<p>å«ä¹‰ç›¸åŒï¼š</p>



<p>[root@swouter-x86 ~]#<code>iptables -t filter --flush</code></p>



<p>ä½†æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨æ›´çŸ­çš„ç‰ˆæœ¬ï¼š</p>



<p>[root@swouter-x86 ~]#iptables&nbsp; -F</p>



<p><strong>b)&nbsp;Flush NAT è¡¨</strong></p>



<p>[root@swouter-x86 ~]#iptables -t nat -F</p>



<p><strong>3. NAT é…ç½®</strong></p>



<p>å¤–éƒ¨ NAT æ¥å£æ˜¯ ppp0ã€‚<br>å†…éƒ¨ NAT æ¥å£æ˜¯ vlan1ã€‚</p>



<p>[root@swouter-x86 ~]#<code>iptables --table nat -A POSTROUTING -o ppp0 --jump MASQUERADE</code></p>



<p>ä¿å­˜ iptables:</p>



<p>[root@swouter-x86 ~]#/etc/init.d/iptables save</p>



<p>iptables: Saving firewall rules to /etc/sysconfig/iptables: [&nbsp; OK&nbsp; ]</p>



<p>è¯¦ç»†æ£€æŸ¥NATè¡¨é…ç½®ï¼š</p>



<p>[root@swouter-x86 ~]#iptables -t nat -L -v</p>



<p>Chain PREROUTING (policy ACCEPT 2 packets, 528 bytes)</p>



<p>pkts bytes target&nbsp;&nbsp;&nbsp;&nbsp; prot opt in&nbsp;&nbsp;&nbsp;&nbsp; out&nbsp;&nbsp;&nbsp;&nbsp; source&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; destination</p>



<p>Chain POSTROUTING (policy ACCEPT 0 packets, 0 bytes)</p>



<p>pkts bytes target&nbsp;&nbsp;&nbsp;&nbsp; prot opt in&nbsp;&nbsp;&nbsp;&nbsp; out&nbsp;&nbsp;&nbsp;&nbsp; source&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; destination</p>



<p>0&nbsp;&nbsp;&nbsp;&nbsp; 0 MASQUERADE&nbsp; all&nbsp; &#8212;&nbsp; any&nbsp;&nbsp;&nbsp; ppp0&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere</p>



<p>Chain OUTPUT (policy ACCEPT 0 packets, 0 bytes)</p>



<p>pkts bytes target&nbsp;&nbsp;&nbsp;&nbsp; prot opt in&nbsp;&nbsp;&nbsp;&nbsp; out&nbsp;&nbsp;&nbsp;&nbsp; source&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; destination</p>



<p>é€šè¿‡å¤–éƒ¨æ¥å£ ppp0 ä¼ è¾“æ¥è‡ªä»»ä½•å†…éƒ¨æ¥å£ä¸”å…·æœ‰ä»»ä½•æº IP åœ°å€çš„æµé‡éƒ½å°†è¢«è½¬æ¢ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä»»ä½•è½¬æ¢éƒ½å·²å®Œæˆï¼Œå› ä¸º &#8211; pkts è®¡æ•°å™¨ä¸ºç©ºã€‚</p>



<p><strong>4. é˜²ç«å¢™é…ç½®</strong></p>



<p><strong>a)&nbsp;æ£€æŸ¥é»˜è®¤è¿‡æ»¤ç­–ç•¥</strong></p>



<p>[root@swouter-x86 ~]#iptables -L -v</p>



<p>Chain INPUT (policy ACCEPT 140 packets, 14016 bytes)</p>



<p>pkts bytes target&nbsp;&nbsp;&nbsp;&nbsp; prot opt in&nbsp;&nbsp;&nbsp;&nbsp; out&nbsp;&nbsp;&nbsp;&nbsp; source&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; destination</p>



<p>Chain FORWARD (policy ACCEPT 1726 packets, 145K bytes)</p>



<p>pkts bytes target&nbsp;&nbsp;&nbsp;&nbsp; prot opt in&nbsp;&nbsp;&nbsp;&nbsp; out&nbsp;&nbsp;&nbsp;&nbsp; source&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; destination</p>



<p>Chain OUTPUT (policy ACCEPT 113 packets, 9052 bytes)</p>



<p>pkts bytes target&nbsp;&nbsp;&nbsp;&nbsp; prot opt in&nbsp;&nbsp;&nbsp;&nbsp; out&nbsp;&nbsp;&nbsp;&nbsp; source&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; destination</p>



<p>æ‰€æœ‰é“¾çš„é»˜è®¤é…ç½®ç­–ç•¥å‡è®¾ç½®ä¸º ACCEPTã€‚å‡è®¾ NAT æ­£å¸¸è¿è¡Œï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿä» LAN ping é€š Internetã€‚å¦‚æœè¿™æ ·åšï¼ŒNAT è¡¨ä¸­ POSTROUTING ç­–ç•¥çš„è®¡æ•°å™¨ pkts æ¯æ¬¡æ‰§è¡Œæ•°æ®åŒ…ä¸­çš„æº IP åœ°å€è½¬æ¢æ—¶éƒ½åº”è¯¥å¢åŠ ã€‚</p>



<p><strong>b)&nbsp;æ›´æ”¹é»˜è®¤è¿‡æ»¤ç­–ç•¥</strong></p>



<p>åªè¦é»˜è®¤è¿‡æ»¤ç­–ç•¥è®¾ç½®ä¸ºâ€œæ¥å—â€ï¼Œåˆ™æ‰€æœ‰æµé‡éƒ½ä¼šè¢«å…è®¸ï¼Œé™¤éæ˜ç¡®æ‹’ç»ã€‚Cisco IOS ACL çš„å·¥ä½œæ–¹å¼ä¸åŒ &#8211; é»˜è®¤æƒ…å†µä¸‹ï¼Œæœªæ˜ç¡®å…è®¸çš„æµé‡å°†è¢«æ‹’ç»ã€‚è¿™æ˜¯æ›´å®‰å…¨çš„æ–¹å¼ï¼Œæˆ‘ä»¬å°†å®æ–½å®ƒã€‚æ­¤æ–¹æ³•å…è®¸æˆ‘ä»¬æ˜ç¡®å®šä¹‰åº”å…è®¸é€šè¿‡é˜²ç«å¢™çš„æ¯ç§æµé‡ç±»å‹ã€‚</p>



<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å°†é˜²ç«å¢™ iptable ä¸­æ‰€æœ‰é“¾çš„é»˜è®¤è¿‡æ»¤ç­–ç•¥æ›´æ”¹ä¸º DENYã€‚</p>



<p><strong>æ³¨æ„ï¼š</strong>&nbsp; åœ¨ç© iptable è¿‡æ»¤å™¨æ—¶ï¼Œå»ºè®®é€šè¿‡ä¸²å£è¿æ¥åˆ° boxã€‚å¦‚æœå‡ºç°é—®é¢˜ï¼Œå¾ˆå®¹æ˜“æ–­å¼€è¿æ¥ã€‚</p>



<p>[root@swouter-x86 ~]#iptables -P INPUT DROP</p>



<p>[root@swouter-x86 ~]#iptables -P OUTPUT DROP</p>



<p>[root@swouter-x86 ~]#iptables -P FORWARD DROP</p>



<p>ä½ å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼Œç°åœ¨æ— æ³•ä» LAN ä¸­çš„ä¸»æœº ping é€šè·¯ç”±å™¨çš„æœ¬åœ°æ¥å£ï¼Œå› ä¸º INPUT é“¾è®¾ç½®ä¸º DROPã€‚æ‚¨æ— æ³•ä»è·¯ç”±å™¨ ping é€š Internetï¼Œå› ä¸º OUTPUT é“¾è®¾ç½®ä¸º DROPã€‚æ­¤å¤–ï¼Œç”±äº FORWARD é“¾çš„ DROP ç­–ç•¥ï¼Œä» LAN ä¸­çš„ä¸»æœº ping é€š Internet ä¹Ÿä¸èµ·ä½œç”¨ã€‚</p>



<p><strong>c)&nbsp;å…è®¸ä» LAN åˆ°è·¯ç”±å™¨çš„ ssh è¿æ¥ï¼Œåä¹‹äº¦ç„¶</strong></p>



<p>æˆ‘ä»¬éœ€è¦å…è®¸æ¥è‡ªå­ç½‘ 172.18.0.0/16 ä¸”ç›®æ ‡ TCP ç«¯å£ä¸º 22ï¼ˆsshï¼‰çš„æµé‡è¿›å…¥æ¥å£ vlan1ã€‚</p>



<p>[root@swouter-x86 ~]#iptab<code>les -A INPUT -i vlan1 -s 172.18.0.0/16 -p tcp --dport ssh -j ACCEPT</code></p>



<p>æ¥è‡ª LAN åˆ° VLAN1 æ¥å£çš„æ•°æ®åŒ…ï¼Œç›®æ ‡ TCP ç«¯å£ä¸º 22ï¼ˆsshï¼‰ï¼Œå¯ä»¥åˆ°è¾¾ vlan1 æ¥å£ï¼Œä½†æ— æ³•å»ºç«‹ ssh è¿æ¥ã€‚OUPUT é“¾ä¸­çš„é»˜è®¤ DROP ç­–ç•¥é˜»æ­¢æ¥è‡ªè·¯ç”±å™¨æœ¬åœ°æ¥å£çš„æµé‡ã€‚æˆ‘ä»¬éœ€è¦æ·»åŠ å‘½ä»¤ä»¥å…è®¸ä» vlan1 æ¥å£åˆ° LAN ä¸Šçš„ä¸»æœºçš„æº TCP ç«¯å£ä¸º 22 çš„è¿æ¥ã€‚</p>



<p>[root@swouter-x86 ~]#<code>iptables -A OUTPUT -p tcp --sport 22 -o vlan1 -d 172.18.0.0/16 -j ACCEPT</code></p>



<p>ç°åœ¨ LAN ä¸Šçš„ä¸»æœºå¯ä»¥ä½¿ç”¨ ssh è¿æ¥åˆ°è·¯ç”±å™¨ã€‚å¦‚æœæˆ‘ä»¬æƒ³å…è®¸ä»è·¯ç”±å™¨çš„ vlan1 åˆ° LAN ä¸Šçš„ä¸»æœºå»ºç«‹ ssh è¿æ¥ï¼Œæˆ‘ä»¬å¿…é¡»æ·»åŠ ä»¥ä¸‹ä¸¤ä¸ªå‘½ä»¤ã€‚</p>



<p>[root@swouter-x86 ~]#<code>iptables -A INPUT -i vlan1 -s 172.18.0.0/16 -p tcp --sport ssh -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#<code>iptables -A OUTPUT -o vlan1 -d 172.18.0.0/16 -p tcp --dport ssh -j ACCEPT</code></p>



<p><strong>d)&nbsp;å…è®¸ä» LAN ä¸Šçš„ä¸»æœº ping åˆ°é»˜è®¤ç½‘å…³ï¼Œåä¹‹äº¦ç„¶</strong></p>



<p>Ping æ˜¯ä¸€ç§ ICMP æ¶ˆæ¯ã€‚ä»¥ä¸‹è§„åˆ™å…è®¸æ¥è‡ªå­ç½‘ 172.18.0.0/16 åˆ° VLAN1 æ¥å£çš„ icmp è¯·æ±‚ã€‚</p>



<p>[root@swouter-x86 ~]#iptables -A INPUT -i vlan1 -s 172.18.0.0/16 -p icmp -j ACCEPT</p>



<p>æˆ‘ä»¬è¿˜éœ€è¦æ·»åŠ å…è®¸ä» VLAN1 æ¥å£å‘ 172.18.0.0/16 å­ç½‘ä¸Šçš„ä¸»æœºå‘é€ ICMP å›æ˜¾æ¶ˆæ¯çš„è§„åˆ™ã€‚</p>



<p>[root@swouter-x86 ~]#iptables -A OUTPUT -o vlan1 -d 172.18.0.0/16 -p icmp -j ACCEPT</p>



<p><strong>e)&nbsp;å…è®¸æ¥è‡ªè·¯ç”±å™¨ ppp0 æ¥å£çš„ pingã€DNSã€http/httpsã€ssh è®¿é—®äº’è”ç½‘</strong></p>



<p>ICMP</p>



<p>[root@swouter-x86 ~]#iptables -A OUTPUT -o ppp0 -p icmp -j ACCEPT</p>



<p>[root@swouter-x86 ~]#<code>iptables -A INPUT -i ppp0 -p icmp -m state --state ESTABLISHED -j ACCEPT</code></p>



<p>æˆ‘ä»¬å¯ä»¥ ping é€š Internet ä¸Šçš„ä¸»æœºï¼Œä½†å®ƒä»¬æ— æ³• ping é€š ppp0 æ¥å£ã€‚ppp0 æ¥å£ä¸Šåªå…è®¸å»ºç«‹ icmp è¿æ¥ã€‚</p>



<p>ICMP localhost</p>



<p>[root@swouter-x86 /]#iptables -A OUTPUT -o lo -p icmp -j ACCEPT</p>



<p>[root@swouter-x86 /]#iptables -A INPUT -i lo -p icmp -j ACCEPT</p>



<p>æ­¤è§„åˆ™å…è®¸ ping ç¯å›æ¥å£æœ¬èº«ä»¥åŠä»è·¯ç”±å™¨ ping æœ¬åœ°æ¥å£ã€‚</p>



<p>DNS å®¢æˆ·ç«¯</p>



<p>[root@swouter-x86 ~]#<code>iptables -A OUTPUT -o ppp0 -p udp --dport 53 -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#<code>iptables -A INPUT -i ppp0 -p udp --sport 53 -m state --state ESTABLISHED -j ACCEPT</code></p>



<p>è¯¥è§„åˆ™å…è®¸å°† DNS æŸ¥è¯¢å‘é€åˆ°æä¾›å•†çš„ DNS æœåŠ¡å™¨ã€‚</p>



<p>æœ¬åœ° DNS æœåŠ¡å™¨ &#8211; ä» LAN è®¿é—®</p>



<p>[root@swouter-x86 ~]#<code>iptables -A INPUT -i vlan1 -p udp --dport 53 -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#<code>iptables -A OUTPUT -o vlan1 -p udp --sport 53 -j ACCEPT</code></p>



<p>è¯¥è§„åˆ™å…è®¸æ¥è‡ª LAN çš„ DNS è¯·æ±‚åˆ°è¾¾è·¯ç”±å™¨ä¸Šè¿è¡Œçš„æœ¬åœ° DNS æœåŠ¡å™¨ã€‚</p>



<p>DNS æœåŠ¡å™¨ &#8211; è·¯ç”±å™¨è‡ªèº«å¯¹æœ¬åœ° DNS æœåŠ¡å™¨çš„æŸ¥è¯¢</p>



<p>[root@swouter-x86 /]#iptables -A INPUT -i lo -p udp -j ACCEPT</p>



<p>[root@swouter-x86 /]#iptables -A OUTPUT -o lo -p udp -j ACCEPT</p>



<p>å°†å…è®¸ä»è·¯ç”±å™¨å‘èµ·åˆ°æœ¬åœ° DNS æœåŠ¡å™¨çš„ DNS æŸ¥è¯¢ã€‚</p>



<p>HTTP/HTTPS</p>



<p>æˆ‘ä»¬éœ€è¦å…è®¸æºè‡ªè·¯ç”±å™¨çš„ http æµé‡æ¥æ¥æ”¶ CentOS æ›´æ–°ã€‚</p>



<p>[root@swouter-x86 ~]#<code>iptables -A OUTPUT -o ppp0 -p tcp --dport 80 -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#<code>iptables -A OUT PUT -o ppp0 -p tcp --dport 443 -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#<code>iptables -A INPUT -i ppp0 -p tcp --sport 80 -m state --state ESTABLISHED -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#<code>iptables -A INPUT -i ppp0 -p tcp --sport 443 -m state --state ESTABLISHED -j ACCEPT</code></p>



<p>SSH to the Internet</p>



<p>[root@swouter-x86 ~]#<code>iptables -A OUTPUT -o ppp0 -p tcp --dport 22 -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#<code>iptables -A INPUT -i ppp0 -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT</code></p>



<p><strong>f)&nbsp;NTP å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨è§„åˆ™</strong></p>



<p>å…è®¸åœ¨è·¯ç”±å™¨ä¸Šè¿è¡Œçš„ NTP å®¢æˆ·ç«¯ä¸å…¬å…± NTP æœåŠ¡å™¨åŒæ­¥ã€‚</p>



<p>[root@swouter-x86 ~]#<code>iptables -A OUTPUT -o ppp0 -p udp --dport 123 -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#<code>iptables -A INPUT -i ppp0 -p udp --sport 123 -j ACCEPT</code></p>



<p>å…è®¸NTPæœåŠ¡å™¨ä¸ºLANä¸Šçš„ä¸»æœºæä¾›æœåŠ¡ã€‚</p>



<p>[root@swouter-x86 ~]#<code>iptables -A INPUT -i vlan1 -p udp --dport 123 -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#<code>iptables -A OUTPUT -o vlan1 -p udp --sport 123 -j ACCEPT</code></p>



<p><strong>g)&nbsp;å…è®¸æ¥è‡ª LAN çš„ DHCP è¯·æ±‚åˆ°è¾¾ DHCP æœåŠ¡å™¨ï¼Œåä¹‹äº¦ç„¶</strong></p>



<p>[root@swouter-x86 ~]#<code>iptables -A INPUT -i vlan1 -p udp --dport 67 -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#<code>iptables -A INPUT -i vlan1 -p udp --dport 68 -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#<code>iptables -A OUTPUT -o vlan1 -p udp --sport 67 -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#<code>iptables -A OUTPUT -o vlan1 -p udp --sport 68 -j ACCEPT</code></p>



<p><strong>h)&nbsp;å…è®¸å±€åŸŸç½‘ä¸Šçš„ä¸»æœºè®¿é—® Samba æœåŠ¡å™¨</strong></p>



<p>[root@swouter-x86 ~]#<code>iptables -A INPUT -i vlan1 -p tcp -m multiport --dport 137,138,139,445 -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#<code>iptables -A INPUT -i vlan1 -p udp -m multiport --dport 137,138,139,445 -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#<code>iptables -A OUTPUT -o vlan1 -p tcp -m multiport --sport 137,138,139,445 -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#<code>iptables -A OUTPUT -o vlan1 -p udp -m multiport --sport 137,138,139,445 -j ACCEPT</code></p>



<p><strong>i)&nbsp;ä»…å…è®¸æ¥è‡ªäº’è”ç½‘çš„å·²å»ºç«‹ä¼šè¯è½¬å‘åˆ° LAN</strong></p>



<p>[root@swouter-x86 ~]#/<code>sbin/iptables -A FORWARD -i ppp0 -o vlan1 -m state --state RELATED,ESTABLISHED -j ACCEPT</code></p>



<p><strong>j)&nbsp;</strong><strong>å…è®¸å°†æºè‡ª LAN çš„ä»»ä½•æµé‡è½¬å‘åˆ° Internet</strong><strong></strong></p>



<p>[root@swouter-x86 ~]#/sbin/iptables -A FORWARD -i vlan1 -o ppp0 -j ACCEPT</p>



<p><strong>k)&nbsp;æ£€æŸ¥è¿‡æ»¤è¡¨</strong></p>



<p>[root@swouter-x86 ~]#iptables -L -v</p>



<p>Chain&nbsp;INPUT(policy&nbsp;DROP56 packets, 7156 bytes)</p>



<p>pkts bytes target&nbsp;&nbsp;&nbsp;&nbsp; prot opt in&nbsp;&nbsp;&nbsp;&nbsp; out&nbsp;&nbsp;&nbsp;&nbsp; source&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; destination</p>



<p>0&nbsp;&nbsp;&nbsp;&nbsp; 0 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; icmp &#8212;&nbsp; vlan1&nbsp; any&nbsp;&nbsp;&nbsp;&nbsp; 172.18.0.0/16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere</p>



<p>145 12353ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; tcp&nbsp; &#8212;&nbsp; vlan1&nbsp; any&nbsp;&nbsp;&nbsp;&nbsp; 172.18.0.0/16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tcp dpt:ssh</p>



<p>0&nbsp;&nbsp;&nbsp;&nbsp; 0 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; tcp&nbsp; &#8212;&nbsp; vlan1&nbsp; any&nbsp;&nbsp;&nbsp;&nbsp; 172.18.0.0/16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tcp spt:ssh</p>



<p>0&nbsp;&nbsp;&nbsp;&nbsp; 0 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; icmp &#8212;&nbsp; ppp0&nbsp;&nbsp; any&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; state ESTABLISHED</p>



<p>401 54442ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; udp&nbsp; &#8212;&nbsp; ppp0&nbsp;&nbsp; any&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; udp spt:domain state ESTABLISHED</p>



<p>8&nbsp;&nbsp; 948 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; tcp&nbsp; &#8212;&nbsp; ppp0&nbsp;&nbsp; any&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tcp spt:http state ESTABLISHED</p>



<p>7&nbsp; 1837 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; tcp&nbsp; &#8212;&nbsp; ppp0&nbsp;&nbsp; any&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tcp spt:https state ESTABLISHED</p>



<p>0&nbsp;&nbsp;&nbsp;&nbsp; 0 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; tcp&nbsp; &#8212;&nbsp; ppp0&nbsp;&nbsp; any&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tcp spt:ssh state ESTABLISHED</p>



<p>20&nbsp; 1552 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; icmp &#8212;&nbsp; lo&nbsp;&nbsp;&nbsp;&nbsp; any&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere</p>



<p>11&nbsp;&nbsp; 836 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; udp&nbsp; &#8212;&nbsp; vlan1&nbsp; any&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; udp dpt:ntp</p>



<p>37&nbsp; 2812 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; udp&nbsp; &#8212;&nbsp; ppp0&nbsp;&nbsp; any&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; udp spt:ntp</p>



<p>304 19672ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; udp&nbsp; &#8212;&nbsp; vlan1&nbsp; any&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; udp dpt:domain</p>



<p>20&nbsp; 1559 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; udp&nbsp; &#8212;&nbsp; lo&nbsp;&nbsp;&nbsp;&nbsp; any&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere</p>



<p>4&nbsp;&nbsp; 200 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; tcp&nbsp; &#8212;&nbsp; lo&nbsp;&nbsp;&nbsp;&nbsp; any&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere</p>



<p>1&nbsp;&nbsp; 328 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; udp&nbsp; &#8212;&nbsp; vlan1&nbsp; any&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; udp dpt:bootps</p>



<p>0&nbsp;&nbsp;&nbsp;&nbsp; 0 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; udp&nbsp; &#8212;&nbsp; vlan1&nbsp; any&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; udp dpt:bootpc</p>



<p>65 11009ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; tcp&nbsp; &#8212;&nbsp; vlan1&nbsp; any&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; multiport dports netbios-ns,netbios-dgm,netbios-ssn,microsoft-ds</p>



<p>139 13812&nbsp;ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; udp&nbsp; &#8212;&nbsp; vlan1&nbsp; any&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; multiport dports netbios-ns,netbios-dgm,netbios-ssn,microsoft-ds</p>



<p>Chain&nbsp;FORWARD&nbsp;(policy&nbsp;DROP&nbsp;0 packets, 0 bytes)</p>



<p>pkts bytes target&nbsp;&nbsp;&nbsp;&nbsp; prot opt in&nbsp;&nbsp;&nbsp;&nbsp; out&nbsp;&nbsp;&nbsp;&nbsp; source&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; destination</p>



<p>1800 1232K ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; all&nbsp; &#8212;&nbsp; ppp0&nbsp;&nbsp; vlan1&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; state RELATED,ESTABLISHED</p>



<p>2481&nbsp; 305K ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; all&nbsp; &#8212;&nbsp; vlan1&nbsp; ppp0&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere</p>



<p>Chain&nbsp;OUTPUT(policyDROP0 packets, 0 bytes)</p>



<p>pkts bytes target&nbsp;&nbsp;&nbsp;&nbsp; prot opt in&nbsp;&nbsp;&nbsp;&nbsp; out&nbsp;&nbsp;&nbsp;&nbsp; source&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; destination</p>



<p>90 10749ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; tcp&nbsp; &#8212;&nbsp; any&nbsp;&nbsp;&nbsp; vlan1&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 172.18.0.0/16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tcp spt:ssh</p>



<p>0&nbsp;&nbsp;&nbsp;&nbsp; 0 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; icmp &#8212;&nbsp; any&nbsp;&nbsp;&nbsp; vlan1&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 172.18.0.0/16</p>



<p>0&nbsp;&nbsp;&nbsp;&nbsp; 0 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; tcp&nbsp; &#8212;&nbsp; any&nbsp;&nbsp;&nbsp; vlan1&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 172.18.0.0/16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tcp dpt:ssh</p>



<p>16&nbsp; 1488 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; icmp &#8212;&nbsp; any&nbsp;&nbsp;&nbsp; ppp0&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere</p>



<p>401 27246ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; udp&nbsp; &#8212;&nbsp; any&nbsp;&nbsp;&nbsp; ppp0&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; udp dpt:domain</p>



<p>10&nbsp;&nbsp; 718 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; tcp&nbsp; &#8212;&nbsp; any&nbsp;&nbsp;&nbsp; ppp0&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tcp dpt:http</p>



<p>8&nbsp;&nbsp; 933 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; tcp&nbsp; &#8212;&nbsp; any&nbsp;&nbsp;&nbsp; ppp0&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tcp dpt:https</p>



<p>0&nbsp;&nbsp;&nbsp;&nbsp; 0 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; tcp&nbsp; &#8212;&nbsp; any&nbsp;&nbsp;&nbsp; ppp0&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tcp dpt:ssh</p>



<p>20&nbsp; 1552 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; icmp &#8212;&nbsp; any&nbsp;&nbsp;&nbsp; lo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere</p>



<p>11&nbsp;&nbsp; 836 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; udp&nbsp; &#8212;&nbsp; any&nbsp;&nbsp;&nbsp; vlan1&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; udp spt:ntp</p>



<p>37&nbsp; 2812 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; udp&nbsp; &#8212;&nbsp; any&nbsp;&nbsp;&nbsp; ppp0&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; udp dpt:ntp</p>



<p>304 39665ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; udp&nbsp; &#8212;&nbsp; any&nbsp;&nbsp;&nbsp; vlan1&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; udp spt:domain</p>



<p>20&nbsp; 1559 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; udp&nbsp; &#8212;&nbsp; any&nbsp;&nbsp;&nbsp; lo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere</p>



<p>4&nbsp;&nbsp; 200 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; tcp&nbsp; &#8212;&nbsp; any&nbsp;&nbsp;&nbsp; lo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere</p>



<p>0&nbsp;&nbsp;&nbsp;&nbsp; 0 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; udp&nbsp; &#8212;&nbsp; any&nbsp;&nbsp;&nbsp; vlan1&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; udp spt:bootpc</p>



<p>0&nbsp;&nbsp;&nbsp;&nbsp; 0 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; udp&nbsp; &#8212;&nbsp; any&nbsp;&nbsp;&nbsp; vlan1&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; udp spt:bootps</p>



<p>74&nbsp; 9590 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; tcp&nbsp; &#8212;&nbsp; any&nbsp;&nbsp;&nbsp; vlan1&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; multiport sports netbios-ns,netbios-dgm,netbios-ssn,microsoft-ds</p>



<p>0&nbsp;&nbsp;&nbsp;&nbsp; 0 ACCEPT&nbsp;&nbsp;&nbsp;&nbsp; udp&nbsp; &#8212;&nbsp; any&nbsp;&nbsp;&nbsp; vlan1&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; anywhere&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; multiport sports netbios-ns,netbios-dgm,netbios-ssn,microsoft-ds</p>



<p><strong>5. å…è®¸æ¥å£ä¹‹é—´çš„è½¬å‘</strong></p>



<p>[root@swouter-x86]#sysctl -w net.ipv4.ip_forward=1</p>



<p>[root@swouter-x86]#sysctl -w net.ipv6.conf.all.forwarding=1</p>



<p>è¦åœ¨å¯åŠ¨æ—¶å¯ç”¨è½¬å‘ï¼Œè¯·ç¼–è¾‘ /etc/sysctl.conf å¹¶æ›´æ”¹/æ·»åŠ ä»¥ä¸‹è¡Œã€‚</p>



<p>net.ipv4.ip_forward = 1</p>



<p>net.ipv6.conf.default.forwarding=1</p>



<p><strong>6.&nbsp; ä¿å­˜å¹¶é‡å¯iptables</strong></p>



<p>[root@swouter-x86 ~]#/etc/init.d/iptables save</p>



<p>iptables: Saving firewall rules to /etc/sysconfig/iptables: [&nbsp; OK&nbsp; ]</p>



<p>[root@swouter-x86 ~]#&nbsp;/etc/init.d/iptables restart</p>



<p>iptables: Flushing firewall rules: [&nbsp; OK&nbsp; ]</p>



<p>iptables: Setting chains to policy ACCEPT: filter nat [&nbsp; OK&nbsp; ]</p>



<p>iptables: Unloading modules: [&nbsp; OK&nbsp; ]</p>



<p>iptables: Applying firewall rules: [&nbsp; OK&nbsp; ]</p>



<p>ä½¿ iptables åœ¨å¯åŠ¨åå¯åŠ¨ã€‚</p>



<p>[root@swouter-x86 ~]#&nbsp;chkconfig iptables on</p>



<p><strong>END.</strong></p>



<p>ä»¥ä¸‹æ˜¯æˆ‘åœ¨å†™ä½œè¿‡ç¨‹ä¸­å¤§é‡ä½¿ç”¨çš„æ–‡ç« åˆ—è¡¨ã€‚</p>



<p>http://www.yolinux.com/TUTORIALS/LinuxTutorialIptablesNetworkGateway.html</p>



<p>http://www.bctes.com/nat-linux-iptables.html</p>



<p>http://billauer.co.il/ipmasq-html.html</p>



<figure class="wp-block-embed"><div class="wp-block-embed__wrapper">
https://help.ubuntu.com/community/IptablesHowTo
</div></figure>



<p>http://www.gentoo.org/doc/en/home-router-howto.xml</p>



<p>http://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers</p>



<h1 class="wp-block-heading"><strong>ç¬¬ 7 éƒ¨åˆ† &#8211; DDNS å’Œ NTP å®‰è£…å’Œé…ç½®</strong></h1>



<p>åœ¨ä¹‹å‰çš„æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬åœ¨ Linux ç¬¬ 3 å±‚äº¤æ¢æœºä¸Šé…ç½®äº†é˜²ç«å¢™å’Œ NATï¼Œä»¥å…è®¸ LAN ç”¨æˆ·è¿æ¥åˆ° Internetã€‚æˆ‘ä»¬å°†ç»§ç»­æ„å»º Linux L3 äº¤æ¢æœºï¼Œå¹¶åœ¨äº¤æ¢æœºä¸Šé…ç½® NTP å’ŒåŠ¨æ€ DNS æœåŠ¡ã€‚äº¤æ¢æœºå°†é€šè¿‡ Internet ä¸å…¬å…± NTP æœåŠ¡å™¨åŒæ­¥å…¶æ—¶é—´ï¼Œå¹¶ä¸º LAN ä¸Šçš„è®¾å¤‡æä¾›å‡†ç¡®çš„æ—¶é—´ã€‚å€ŸåŠ©åŠ¨æ€ DNS æœåŠ¡ï¼Œå³ä½¿åŠ¨æ€åˆ†é…äº†å…¬å…± IP åœ°å€ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å…¶åŸŸåè®¿é—®å®ƒã€‚æ­¤ IP åœ°å€æ˜¯é€šè¿‡äº¤æ¢æœºè·¯ç”±æ¥å£ä¸Šçš„ ISP DHCP æœåŠ¡å™¨é€šè¿‡ DHCP åˆ†é…çš„ã€‚</p>



<p>è§£é‡Šæ„å»º LInux L3 äº¤æ¢æœºæ¦‚å¿µçš„å…¥é—¨æ•™ç¨‹åœ¨è¿™é‡Œã€‚</p>



<h3 class="wp-block-heading"><strong>ç½‘ç»œæ—¶é—´åè®® NTP &#8211; å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨é…ç½®</strong></h3>



<p>å‡è®¾æˆ‘ä»¬ç†Ÿæ‚‰ç½‘ç»œæ—¶é—´åè®®çš„å·¥ä½œåŸç†ï¼Œæˆ‘ä»¬å°†åœ¨äº¤æ¢æœºä¸Šå®‰è£…å’Œé…ç½® NTPï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p>



<p><strong>1. å®‰è£… NTP å·¥å…·</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;yum install ntp</p>



<p><strong>2. NTP å®¢æˆ·ç«¯é…ç½®</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;vi /etc/ntp.conf</p>



<p><strong>a)&nbsp;æŒ‡å®š NTP å…¬å…±æœåŠ¡å™¨æˆ–ä¿ç•™é»˜è®¤å€¼</strong></p>



<p>è¿™äº›æ˜¯é»˜è®¤çš„é¢„é…ç½®å…¬å…± NTP æœåŠ¡å™¨ã€‚</p>



<p>server 0.rhel.pool.ntp.org</p>



<p>server 1.rhel.pool.ntp.org</p>



<p>server 2.rhel.pool.ntp.org</p>



<p><strong>b)&nbsp;é™åˆ¶å…¬å…± NTP æœåŠ¡å™¨å¯¹æˆ‘ä»¬çš„ NTP æœåŠ¡å™¨çš„è®¿é—®</strong></p>



<p>restrict default kod nomodify notrap nopeer noquery</p>



<p>restrict -6 default kod nomodify notrap nopeer noquery</p>



<p>æ—¶é—´å°†ä¸å…¬å…± NTP æœåŠ¡å™¨åŒæ­¥ï¼Œä½†æœåŠ¡å™¨ä¸å…è®¸ä¿®æ”¹è¿è¡Œæ—¶é…ç½®æˆ–æŸ¥è¯¢æˆ‘ä»¬çš„ Linux NTP æœåŠ¡å™¨ã€‚</p>



<p><strong>c)&nbsp;</strong><strong>å¯åŠ¨ ntpd å®ˆæŠ¤è¿›ç¨‹ï¼Œå¹¶ä½¿ ntpd å®ˆæŠ¤è¿›ç¨‹åœ¨å¯åŠ¨æ—¶å¯åŠ¨</strong></p>



<p>root@swouter-x86 ~]#&nbsp;/etc/init.d/ntpd start</p>



<p>[root@swouter-x86 ~]#&nbsp;chkconfig ntpd on</p>



<p><strong>d)&nbsp;æ£€æŸ¥åŒæ­¥æ˜¯å¦æœ‰æ•ˆ</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;ntpq -p</p>



<p>ntpq: read: Connection refused</p>



<p>æ£€æŸ¥ /var/log/messages ä¸­æ˜¯å¦æœ‰ä»»ä½•é”™è¯¯æ¶ˆæ¯ã€‚</p>



<p>[root@swouter-x86 ~]#&nbsp;tail /var/log/messages</p>



<p>Sep&nbsp; 4 14:23:34 swouter-x86 ntpd[1735]: kernel time sync status 2040</p>



<p>Sep&nbsp; 4 14:23:35 swouter-x86 ntpd[1735]: sendto(81.89.63.67) (fd=24): Operation not permitted</p>



<p>Sep&nbsp; 4 14:23:36 swouter-x86 ntpd[1735]: sendto(217.73.16.2) (fd=24): Operation not permitted</p>



<p>Sep&nbsp; 4 14:24:39 swouter-x86 ntpd[1735]: sendto(81.89.63.67) (fd=24): Operation not permitted</p>



<p>Sep&nbsp; 4 14:24:42 swouter-x86 ntpd[1735]: sendto(217.73.16.2) (fd=24): Operation not permitted</p>



<p>Sep&nbsp; 4 14:25:44 swouter-x86 ntpd[1735]: sendto(81.89.63.67) (fd=24): Operation not permitted</p>



<p>Sep&nbsp; 4 14:25:45 swouter-x86 ntpd[1735]: sendto(217.73.16.2) (fd=24): Operation not permitted</p>



<p>Sep&nbsp; 4 14:26:49 swouter-x86 ntpd[1735]: sendto(81.89.63.67) (fd=24): Operation not permitted</p>



<p>Sep&nbsp; 4 14:26:50 swouter-x86 ntpd[1735]: sendto(217.73.16.2) (fd=24): Operation not permitted</p>



<p>Sep&nbsp; 4 14:27:00 swouter-x86 ntpd[1735]: ntpd exiting on signal 15</p>



<p>æ˜¾ç„¶ï¼Œé˜²ç«å¢™é…ç½®æ‹’ç»æ¥è‡ªè·¯ç”±å™¨çš„ç›®æ ‡ UDP ç«¯å£ 123 çš„ NTP æµé‡åˆ°è¾¾äº’è”ç½‘ä¸Šçš„å…¬å…± NTP æœåŠ¡å™¨ã€‚</p>



<p>[root@swouter-x86 ~]#&nbsp;<code>iptables -A OUTPUT -o ppp0 -p udp --dport 123 -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]# i<code>iptables -A INPUT -i ppp0 -p udp --sport 123&nbsp; -j ACCEPT</code></p>



<p>é‡æ–°å¯åŠ¨ ntpd å®ˆæŠ¤ç¨‹åºã€‚</p>



<p>[root@swouter-x86 ~]#&nbsp;/etc/init.d/ntpd restart</p>



<p>Shutting down ntpd: [FAILED]</p>



<p>Starting ntpd: [OK]</p>



<p>[root@swouter-x86 ~]#&nbsp;ntpq -p</p>



<p>remote&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; refid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; st t when poll reach&nbsp;&nbsp; delay&nbsp;&nbsp; offset&nbsp; jitter</p>



<p>=====================================================</p>



<p>ns2.vnet.sk&nbsp;&nbsp;&nbsp;&nbsp; 81.89.63.150&nbsp;&nbsp;&nbsp;&nbsp; 2 u&nbsp; 100&nbsp;&nbsp; 64&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 5.308&nbsp; -63.725&nbsp;&nbsp; 0.008</p>



<p>*lb02.vnet.sk&nbsp;&nbsp;&nbsp; 194.160.23.2&nbsp;&nbsp;&nbsp;&nbsp; 2 u&nbsp;&nbsp; 32&nbsp;&nbsp; 64&nbsp;&nbsp; 77&nbsp;&nbsp;&nbsp; 5.185&nbsp; -67.698&nbsp; 39.818</p>



<p>ä¸ºäº†æ­£ç¡®åŒæ­¥ï¼Œå»¶è¿Ÿå’Œåç§»å€¼å¿…é¡»éé›¶ï¼Œå¹¶ä¸”æŠ–åŠ¨å€¼åº”ä½äº 100ã€‚åŒæ­¥æˆåŠŸåï¼Œç‰¹å®š NTP æœåŠ¡å™¨æ—è¾¹å¿…é¡»æ˜¾ç¤ºç¬¦å· *ã€‚</p>



<p>[root@swouter-x86 ~]#&nbsp;date</p>



<p>Sun Sep&nbsp; 4 12:56:32 CEST 2011</p>



<p>æ—¶é—´å·²æ­£ç¡®æ›´æ–°ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å¼€å§‹é…ç½® NTP æœåŠ¡å™¨ã€‚</p>



<p><strong>3. NTP æœåŠ¡å™¨é…ç½®</strong></p>



<p><strong>a)&nbsp;</strong><strong>é…ç½® NTP æœåŠ¡å™¨ä»¥ä»…å“åº”æ¥è‡ª LAN çš„ NTP æŸ¥è¯¢</strong><strong></strong></p>



<p>æ—¶é—´å°†ä¸å…¬å…± NTP æœåŠ¡å™¨åŒæ­¥ï¼Œä½†è¿™äº›æœåŠ¡å™¨ä¸å…è®¸ä¿®æ”¹è¿è¡Œæ—¶é…ç½®æˆ–æŸ¥è¯¢æˆ‘ä»¬çš„ Linux NTP æœåŠ¡å™¨ã€‚ç¼–è¾‘æ–‡ä»¶ /etc/ntpd.conf å¹¶æ·»åŠ ä»¥ä¸‹å‡ è¡Œã€‚</p>



<p>restrict default kod nomodify notrap nopeer noquery</p>



<p>restrict -6 default kod nomodify notrap nopeer noquery</p>



<p>æ‹’ç»ä»äº’è”ç½‘æŸ¥è¯¢æˆ‘ä»¬çš„ NTP æœåŠ¡å™¨ï¼Œå¹¶æ‹’ç»ä¿®æ”¹æˆ‘ä»¬çš„ NTP æœåŠ¡å™¨çš„è¿è¡Œæ—¶é…ç½®ã€‚</p>



<p>restrict 0.rhel.pool.ntp.org&nbsp; mask 255.255.255.255 nomodify notrap noquery</p>



<p>restrict 1.rhel.pool.ntp.org mask 255.255.255.255 nomodify notrap noquery</p>



<p>restrict 2.rhel.pool.ntp.org mask 255.255.255.255 nomodify notrap noquery</p>



<p>è¦å…è®¸ LAN ä¸Šçš„ä¸»æœºæŸ¥è¯¢æˆ‘ä»¬çš„ NTP æœåŠ¡å™¨ï¼Œæ‚¨éœ€è¦æ·»åŠ æ­¤è§„åˆ™ã€‚</p>



<p>restrict 172.18.0.0 mask 255.255.0.0 nomodify notrap</p>



<p><strong>b)&nbsp;é‡æ–°å¯åŠ¨åœ¨ NTP æœåŠ¡å™¨ä¸Šè¿è¡Œçš„ ntpd å®ˆæŠ¤ç¨‹åº</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;/etc/init.d/ntpd restart</p>



<p><strong>c)&nbsp;é…ç½® iptables ä»¥å…è®¸æ¥è‡ª LAN ä¸Šçš„ä¸»æœºçš„ NTP æŸ¥è¯¢</strong></p>



<p>æˆ‘ä»¬å°†å…è®¸äº¤æ¢æœºè™šæ‹Ÿæ¥å£ SVI &#8211; vlan1 ä¸Šå…·æœ‰æºå’Œç›®æ ‡ UDP ç«¯å£ 123 çš„å…¥ç«™å’Œå‡ºç«™æµé‡ã€‚</p>



<p>[root@swouter-x86 ~]#&nbsp;<code>iptables -A INPUT -i vlan1 -p udp --dport 123 -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#&nbsp;<code>iptables -A OUTPUT -o vlan1 -p udp --sport 123 -j ACCEPT</code></p>



<p><strong>3. åœ¨å±€åŸŸç½‘å†…ç”µè„‘ä¸Šé…ç½®NTP</strong></p>



<p>æ­¥éª¤ä¸è·¯ç”±å™¨ä¸Š NTP å®¢æˆ·ç«¯çš„é…ç½®éå¸¸ç›¸ä¼¼ã€‚æ³¨é‡ŠæŒ‡å‘å…¬å…± NTP æœåŠ¡å™¨çš„è¡Œï¼Œå¹¶å°†æˆ‘ä»¬çš„ NTP æœåŠ¡å™¨ IP åœ°å€ 172.18.100.150 æ”¾å…¥ /etc/ntp.confã€‚é‡æ–°å¯åŠ¨ ntpd å®ˆæŠ¤è¿›ç¨‹å¹¶ç­‰å¾…åŒæ­¥ã€‚è¯·è®°ä½ï¼Œæˆ‘ä»¬çš„ NTP æœåŠ¡å™¨å¿…é¡»å…ˆä¸å…¬å…± NTP æœåŠ¡å™¨åŒæ­¥ã€‚ä¹‹åï¼Œæ‚¨çš„è®¡ç®—æœºå¯èƒ½ä¼šä¸æˆ‘ä»¬çš„ NTP æœåŠ¡å™¨åŒæ­¥æ—¶é—´ã€‚</p>



<p><strong>4. æ•…éšœæ’é™¤</strong>é‡å¯ Linux è·¯ç”±å™¨åï¼ŒNTP å¯¹ç­‰ç‚¹ä¸å¯ç”¨ã€‚è¿™å¯èƒ½æ˜¯ç”±äºå…¬å…± NTP æœåŠ¡å™¨ä¸å¯ç”¨æˆ–é˜²ç«å¢™é…ç½®ä¸å½“å¯¼è‡´æ— æ³•è®¿é—®æœåŠ¡å™¨ã€‚</p>



<p>[root@swouter-x86 ~]#&nbsp;ntpq -d -p</p>



<p>No association ID&#8217;s returned</p>



<p>é‡æ–°å¯åŠ¨ npdd å®ˆæŠ¤è¿›ç¨‹åï¼Œå¯¹ç­‰ç‚¹ç«‹å³æ˜¾ç¤ºåœ¨ ntpqd çš„è¾“å‡ºä¸­ï¼Œå¹¶ä¸”å‘ç”ŸåŒæ­¥ã€‚</p>



<p><strong>è§£é‡Šï¼š</strong></p>



<p>åœ¨ Linux NTP æœåŠ¡å™¨å¯åŠ¨æœŸé—´ï¼Œæ— æ³•é€šè¿‡å…¶åŸŸåè®¿é—®å…¬å…± NTP æœåŠ¡å™¨ï¼Œå› ä¸ºåœ¨ NTP å®ˆæŠ¤è¿›ç¨‹å¯åŠ¨ä¹‹å‰ï¼Œpppd å®ˆæŠ¤è¿›ç¨‹æœªå°†å…¬å…± DNS æœåŠ¡å™¨æ·»åŠ åˆ° /etc/resolv.confã€‚å› æ­¤ï¼Œåœ¨ /etc/ntpd.conf ä¸­ï¼Œåº”é€šè¿‡å…¶ IP åœ°å€è€Œä¸æ˜¯åŸŸåæ¥å®šä¹‰å…¬å…± NTP æœåŠ¡å™¨ã€‚æœ¬æ–‡æ›´è¯¦ç»†åœ°æè¿°äº†è¿™ä¸ªé—®é¢˜ã€‚</p>



<h3 class="wp-block-heading"><strong>åŠ¨æ€ DNS /DDNS/ é…ç½®</strong></h3>



<p>åŠ¨æ€ DNS æ˜¯ä¸€ç§æœåŠ¡ï¼Œå…è®¸æˆ‘ä»¬åœ¨å…¬å…± IP åœ°å€ä» ISP DHCP æœåŠ¡å™¨åŠ¨æ€åˆ†é…çš„æƒ…å†µä¸‹ä½¿ç”¨åŸŸåã€‚ä¸ºäº†å®ç°å®ƒï¼Œæˆ‘ä»¬çš„ Linux L3 äº¤æ¢æœºå¿…é¡»å®šæœŸå‘ DDNS æä¾›å•†å‘é€ http æ ¼å¼çš„æŸ¥è¯¢ã€‚å€ŸåŠ©è¿™äº›æŸ¥è¯¢ï¼ŒDDSN æä¾›å•†ä¼šè·çŸ¥äº¤æ¢æœºçš„å…¬å…± IP åœ°å€å¹¶å­˜å‚¨è¯¥å¯¹ &#8211; IP åœ°å€å’Œç‰¹å®š DNS åç§°ã€‚å®ƒå…è®¸ä½¿ç”¨äº¤æ¢æœºçš„å…¬å…± IP åœ°å€æ¥å›ç­” DNS æŸ¥è¯¢ã€‚</p>



<p><strong>æ³¨æ„:&nbsp;</strong>æˆ‘é€‰æ‹©äº† DynDNS æ¥æä¾› DDNS æœåŠ¡ï¼Œä½†æ‚¨å¯ä»¥éšæ„ä½¿ç”¨æ‚¨å–œæ¬¢çš„ä»»ä½• DDNS æä¾›å•†ã€‚è¯·æ³¨æ„ï¼Œæœ¬æ•™ç¨‹æ˜¯ä½¿ç”¨ DynNDS æœåŠ¡æä¾›å•†ç¼–å†™çš„ DDNS é…ç½®ã€‚</p>



<p><strong>1. æ³¨å†Œä½ çš„ DynDNS åŸŸå</strong></p>



<ul class="wp-block-list">
<li>å¯¼èˆªåˆ° http://dyn.com/dns/dyndns-free/</li>



<li>ç‚¹å‡»â€œç«‹å³è·å–â€œ</li>



<li>å¡«å†™ä¸»æœºåã€IPv4æˆ–IPv6åœ°å€ï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥</li>



<li>æ³¨å†Œæ‚¨çš„è´¦æˆ· &#8211; ç™»å½•å/å¯†ç ã€ç”µå­é‚®ä»¶ç­‰ã€‚ç‚¹å‡»â€œåˆ›å»ºè´¦æˆ·</li>



<li>ç¡®è®¤é‚®ä»¶å°†å‘é€åˆ°æ‚¨çš„ç”µå­é‚®ä»¶å¸æˆ·ã€‚å•å‡»ç”µå­é‚®ä»¶ä¸­æä¾›çš„é“¾æ¥ä»¥æ¿€æ´» DynDNS å¸æˆ·</li>



<li>ç‚¹å‡»â€œæ¿€æ´»æ‚¨çš„å…è´¹ DynDNSâ€</li>
</ul>



<p><strong>2. å®‰è£…å¿…è¦çš„è½¯ä»¶åŒ…</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;yum install perl-IO-Socket-SSL perl-Net-LibIDN</p>



<p><strong>3. å®‰è£…æœ€æ–°çš„ DDNS å®¢æˆ·ç«¯</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;wget http://sourceforge.net/projects/ddclient/files/ddclient/ddclient-3.8.1/ddclient-3.8.1.tar.gz/download</p>



<p>[root@swouter-x86 ~]#&nbsp;tar zxvf ddclient-3.8.1.tar.gz</p>



<p>[root@swouter-x86 ~]#&nbsp;cd ./ddclient-3.8.1</p>



<p>[root@swouter-x86 ddclient-3.8.1]#&nbsp;mkdir /etc/ddclient/</p>



<p>[root@swouter-x86 ddclient-3.8.1]#&nbsp;mkdir /var/cache/ddclient/</p>



<p>[root@swouter-x86 ddclient-3.8.1]#&nbsp;cp ddclient /usr/local/sbin</p>



<p>[root@swouter-x86 ddclient-3.8.1]#&nbsp;cp sample-etc_ddclient.conf /etc/ddclient/ddclient.conf</p>



<p>[root@swouter-x86 ddclient-3.8.1]#&nbsp;cp sample-etc_rc.d_init.d_ddclient /etc/rc.d/init.d/ddclient</p>



<p>[root@swouter-x86 ddclient-3.8.1]#&nbsp;<code>chkconfig --add ddclient</code></p>



<p><strong>4. é…ç½® /etc/ddclient/dddclient.conf</strong></p>



<p>ç¼–è¾‘æ–‡ä»¶ /etc/ddclient/ddclient å¹¶æ·»åŠ ä»¥ä¸‹è¡Œã€‚</p>



<p>daeomon=300</p>



<p>use=web</p>



<p>login=brezular</p>



<p>password=yourdyndnspassword</p>



<p>server=members.dyndns.org</p>



<p>protocol=dyndns2</p>



<p>brezular.dyndns.org</p>



<p>ç°åœ¨å¯åŠ¨ ddclient å®ˆæŠ¤è¿›ç¨‹ï¼š</p>



<p>[root@swouter-x86 ddclient-3.8.1]#&nbsp;/etc/init.d/ddclient start</p>



<p>Starting ddclient: WARNING:&nbsp; file /etc/ddclient/ddclient.conf: file /etc/ddclient/ddclient.conf must be accessible only by its owner (fixed).</p>



<p>[&nbsp; OK&nbsp; ]</p>



<p>å…¶ä»–ç”¨æˆ·çš„æƒé™è¢«è¸¢å‡ºï¼Œå¹¶ä¿ç•™æ‰€æœ‰è€…ï¼ˆrootï¼‰çš„è¯»å†™æƒé™ã€‚</p>



<p>[root@swouter-x86 ddclient-3.8.1]#&nbsp;ls -l /etc/ddclient/ddclient.conf</p>



<p>-rw&#8212;&#8212;-. 1 root root 5919 Sep&nbsp; 3 21:12 /etc/ddclient/ddclient.conf</p>



<p>æ£€æŸ¥ ddclient æ˜¯å¦æ­£åœ¨è¿è¡Œ</p>



<p>[root@swouter-x86 ddclient-3.8.1]#&nbsp;/etc/init.d/ddclient status</p>



<p>ddclient (pid&nbsp; 2011) is running&#8230;</p>



<p><strong>5. é…ç½® DynDNS æä¾›å•†çš„ IP åœ°å€æ›´æ–°</strong></p>



<p>[root@swouter-x86 ddclient-3.8.1]#&nbsp;ps -aux | grep ddclient</p>



<p>root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2011&nbsp; 0.0&nbsp; 0.8&nbsp; 15124&nbsp; 8260 pts/0&nbsp;&nbsp;&nbsp; S&nbsp;&nbsp;&nbsp; 21:30&nbsp;&nbsp; 0:00 ddclient &#8211; sleeping for 300 seconds</p>



<p>Ddclient ä»¥å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼è¿è¡Œã€‚/etc/ddclient/ddclient.conf ä¸­çš„å‚æ•° daemon=300 è¡¨ç¤ºæ¯ 300 ç§’æ¿€æ´»ä¸€æ¬¡ ddclient å¹¶æ£€æŸ¥å…¬å…± IP åœ°å€æ˜¯å¦å‘ç”Ÿå˜åŒ–ã€‚å¦‚æœ IP åœ°å€å‘ç”Ÿå˜åŒ–ï¼Œåˆ™ä¼šè‡ªåŠ¨å‘ ddns æœåŠ¡å™¨å‘é€æ›´æ–°ã€‚å¦‚æœæ²¡æœ‰å˜åŒ–ï¼Œåˆ™ä¸ä¼šå‘é€æ›´æ–°ã€‚</p>



<p>ä½†æ˜¯ï¼Œä»¥å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼è¿è¡Œçš„ ddclient åº”è¯¥æ¯æœˆè‡ªåŠ¨å‘é€ä¸€æ¬¡æ›´æ–°ï¼Œå³ä½¿ ip åœ°å€æ²¡æœ‰ä»»ä½•å˜åŒ–ï¼Œä»¥ä¿æŒå¸æˆ·å¤„äºæ´»è·ƒçŠ¶æ€ã€‚</p>



<p><strong>6. æµ‹è¯• DynDNS</strong></p>



<p>[root@swouter-x86 /]#&nbsp;ping brezular.dyndns.org</p>



<p>PING brezular.dyndns.org (78.98.103.30) 56(84) bytes of data.</p>



<p>64 bytes from adsl-dyn30.78-98-103.t-com.sk (78.98.103.30): icmp_seq=1 ttl=64 time=0.145 ms</p>



<p>64 bytes from adsl-dyn30.78-98-103.t-com.sk (78.98.103.30): icmp_seq=2 ttl=64 time=0.091 ms</p>



<p>64 bytes from adsl-dyn30.78-98-103.t-com.sk (78.98.103.30): icmp_seq=3 ttl=64 time=0.109 ms</p>



<p>64 bytes from adsl-dyn30.78-98-103.t-com.sk (78.98.103.30): icmp_seq=4 ttl=64 time=0.118 ms</p>



<p><strong>END.</strong></p>



<p>åœ¨ç¼–å†™æœ¬æ•™ç¨‹çš„è¿‡ç¨‹ä¸­å¤§é‡ä½¿ç”¨äº†ä»¥ä¸‹æ–‡ç« ã€‚</p>



<p>NTP</p>



<p>http://www.linuxhomenetworking.com/wiki/index.php/Quick_HOWTO_:_Ch24_:_The_NTP_Server</p>



<p>http://www.brennan.id.au/09-Network_Time_Protocol.html</p>



<p>http://www.ghidinelli.com/2008/09/25/iptables-firewall-rules-for-ntpd-time-synchronization</p>



<p>DynDNS</p>



<p>http://en.wikipedia.org/wiki/Dynamic_DNS</p>



<p>http://www.linuxhomenetworking.com/wiki/index.php/Quick_HOWTO_:_Ch19_:_Dynamic_DNS</p>



<p>http://www.sonoracomm.com/support/19-inet-support/232-ddclient</p>



<p>http://sourceforge.net/apps/trac/ddclient</p>



<p>http://www.ubuntugeek.com/update-ip-addresses-at-dynamic-dns-services-using-ddclient.html</p>



<h1 class="wp-block-heading"><strong>ç¬¬ 8 éƒ¨åˆ† &#8211; DNS ç¼“å­˜æœåŠ¡å™¨å®‰è£…å’Œé…ç½®</strong></h1>



<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»åœ¨ x86 ç¡¬ä»¶ä¸Šå®‰è£…äº† CentOSï¼Œå®‰è£…äº† Open vSwitchï¼Œå¹¶å°†æ— çº¿å’Œæœ‰çº¿ LAN ç”¨æˆ·è¿æ¥åˆ°æˆ‘ä»¬çš„ Linux ç¬¬ 3 å±‚äº¤æ¢æœºã€‚ç„¶åï¼Œæˆ‘ä»¬å°†äº¤æ¢æœºè¿æ¥åˆ° Internetï¼Œå¯ç”¨ NAT å’Œæ•°æ®åŒ…è¿‡æ»¤ã€‚æˆ‘ä»¬å°†äº¤æ¢æœºé…ç½®ä¸ºä¸å…¬å…± NTP æœåŠ¡å™¨åŒæ­¥å…¶æ—¶é—´ï¼Œå¹¶ä¸º LAN ä¸Šçš„ä¸»æœºæä¾›æ—¶é—´ã€‚äº¤æ¢æœºè¿˜é…ç½®ä¸ºåœ¨å…¶å…¬å…± IP åœ°å€å‘ç”Ÿå˜åŒ–æ—¶å‘å…¬å…±åŠ¨æ€ DNS æœåŠ¡å™¨å‘é€æ›´æ–°ã€‚</p>



<p>Linuxä¸‰å±‚äº¤æ¢æœºæ¦‚å¿µä»‹ç»åˆ°æ­¤ã€‚</p>



<p>æˆ‘ä»¬å°†ç»§ç»­æ„å»ºå…·æœ‰ DNS ç¼“å­˜æœåŠ¡å™¨é…ç½®çš„ Linux L3 äº¤æ¢æœºã€‚DNS ç¼“å­˜æœåŠ¡å™¨å°†ç»å¸¸è®¿é—®çš„ç½‘ç«™çš„ IP åœ°å€ç¼“å­˜åˆ° RAM å†…å­˜ä¸­ã€‚IP åœ°å€æ˜¯ä»æœ¬åœ° DNS ç¼“å­˜æœåŠ¡å™¨æ£€ç´¢çš„ï¼Œå› æ­¤æ— éœ€è”ç³»å…¬å…± DNS æœåŠ¡å™¨ã€‚æ‹¥æœ‰è‡ªå·±çš„ç¼“å­˜ DNS æœåŠ¡å™¨æœ‰ä¸¤ä¸ªä¸»è¦å¥½å¤„ï¼š</p>



<p>&nbsp;&nbsp;&nbsp;&nbsp; æé«˜ DNS æŸ¥æ‰¾é€Ÿåº¦</p>



<p>&nbsp;&nbsp;&nbsp;&nbsp; å‡å°‘ ISP é“¾è·¯ä¸Šçš„æ€»æµé‡</p>



<p><strong>1. å®‰è£…ç»‘å®šç¼“å­˜ DNS æœåŠ¡å™¨</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;yum install bind bind-utils</p>



<p><strong>2. é…ç½®ç»‘å®šç¼“å­˜ DNS æœåŠ¡å™¨</strong></p>



<p>æˆ‘ä»¬å°†é…ç½® /etc/named.conf ä»¥ä½¿ DNS ç¼“å­˜æœåŠ¡å™¨æ­£å¸¸å·¥ä½œã€‚æ­¤æ–‡ä»¶çš„æ›´æ”¹ä»¥ç»¿è‰²æ˜¾ç¤ºã€‚æˆ‘ä»¬å¿…é¡»æŒ‡å®š DNS æœåŠ¡å™¨ç›‘å¬çš„ IP åœ°å€å’Œç«¯å£ã€‚è¿˜éœ€è¦æŒ‡å®šè¯·æ±‚ DNS æŸ¥æ‰¾çš„æº IP åœ°å€èŒƒå›´ã€‚æœ€åä¸€æ­¥æ˜¯é…ç½®å¿…é¡»åœ¨è½¬å‘å™¨åˆ—è¡¨ä¸­æŒ‡å®šçš„å…¬å…± DNS æœåŠ¡å™¨ã€‚</p>



<p>[root@swouter-x86 ~]#&nbsp;vi /etc/named.conf</p>



<p>//listen-on port 53 { 127.0.0.1; };</p>



<p>listen-on port 53 { 127.0.0.1; 172.18.100.150; };</p>



<p>//allow-query&nbsp;&nbsp;&nbsp;&nbsp; { localhost; };</p>



<p>allow-query&nbsp;&nbsp;&nbsp;&nbsp; { localhost; 172.18.0.0/16; };</p>



<p>//dnssec-enable yes;</p>



<p>dnssec-enable no;</p>



<p>//dnssec-validation yes;</p>



<p>dnssec-validation no;</p>



<p>//Add list of forwarders &#8211; public DNS of ISP</p>



<p>forwarders { 195.146.132.58; 195.146.128.62; };</p>



<p><strong>3. æŒ‡å®šç¼“å­˜ DNS æœåŠ¡å™¨</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;/etc/resolv.conf</p>



<p>nameserver 127.0.0.1</p>



<p><strong>4. æŒ‡å®šç¼“å­˜ DNS æœåŠ¡å™¨</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;/etc/init.d/named start</p>



<p>[root@swouter-x86 ~]#&nbsp;chkconfig named on</p>



<p><strong>5. Iptables é…ç½®</strong></p>



<p>å…è®¸è·¯ç”±å™¨æœ¬èº«å‘é€ DNS è¯·æ±‚å¹¶æ¥æ”¶å›å¤ï¼š</p>



<p>[root@swouter-x86 ~]#&nbsp;<code>iptables -A OUTPUT -o ppp0 -p udp --dport 53 -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#&nbsp;<code>iptables -A INPUT -i ppp0 -p udp --sport 53 -m state --state ESTABLISHED -j ACCEPT</code></p>



<p>å…è®¸æ¥è‡ª LAN ä¸Šçš„ä¸»æœºçš„ DNS è¯·æ±‚åˆ°è¾¾ç¼“å­˜ DNS æœåŠ¡å™¨ã€‚</p>



<p>[root@swouter-x86 ~]#<code>&nbsp;iptables -A INPUT -i vlan1 -p udp --dport 53 -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#&nbsp;<code>iptables -A OUTPUT -o vlan1 -p udp --sport 53 -j ACCEPT</code></p>



<p>å…è®¸è·¯ç”±å™¨æœ¬èº«ç”Ÿæˆçš„ DNS æŸ¥è¯¢å‘é€åˆ°å…¬å…± DNS æœåŠ¡å™¨ã€‚</p>



<p>[root@swouter-x86 /]#&nbsp;iptables -A INPUT -i lo -p udp -j ACCEPT</p>



<p>[root@swouter-x86 /]#&nbsp;iptables -A OUTPUT -o lo -p udp -j ACCEPT</p>



<p>å…è®¸ rndc ç›‘å¬ TCP 953</p>



<p>[root@swouter-x86 /]#&nbsp;iptables -A INPUT -i lo -p tcp -j ACCEPT</p>



<p>[root@swouter-x86 /]#&nbsp;iptables -A OUTPUT -o lo -p tcp -j ACCEPT</p>



<p><strong>6. é¿å…é‡å†™ /etc/resolv.conf</strong></p>



<p>åœ¨ PPPoE æ•™ç¨‹é…ç½®ä¸­ï¼Œæˆ‘ä»¬å¿…é¡»å°†è¡Œ echo &#8220;cp /var/run/ppp/resolv.conf /etc/resolv.conf&#8221; &gt; /etc/ppp/ip-up.local æ·»åŠ åˆ°æ–‡ä»¶ /etc/ppp/ip-up.localã€‚æ­¤è¡Œå°†æ–‡ä»¶ /var/run/ppp/resolv.conf çš„å†…å®¹å¤åˆ¶åˆ° /etc/resolv.confï¼Œä»¥ä¾¿ä½¿ç”¨å…¬å…± DNS æœåŠ¡å™¨åˆ—è¡¨æ›´æ–° /etc/resolv.confã€‚</p>



<p>ç°åœ¨æˆ‘ä»¬å¿…é¡»ä»æ–‡ä»¶ /etc/ppp/ip-up.local ä¸­åˆ é™¤æ­¤è¡Œï¼Œä»¥ä¾¿æ¡ç›®â€œnameserver 127.0.0.1â€ä¸ä¼šåœ¨ /etc/resolv.conf ä¸­è¢«é‡å†™ã€‚</p>



<p><strong>7. æ›´æ”¹å¯åŠ¨æ—¶å¯åŠ¨å‘½åå®ˆæŠ¤è¿›ç¨‹çš„ä¼˜å…ˆçº§</strong></p>



<p>ä¸ºäº†è®©ç¼“å­˜ DNS æœåŠ¡å™¨æ­£å¸¸å·¥ä½œï¼Œæˆ‘ä»¬å¿…é¡»æŒ‰é¡ºåºå°†å‘½åæœåŠ¡å™¨å®ˆæŠ¤è¿›ç¨‹ä½œä¸ºæœ€åä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹å¯åŠ¨ã€‚ä¼˜å…ˆçº§è¶Šé«˜æ„å‘³ç€å®ˆæŠ¤è¿›ç¨‹è¶Šæ™šå¯åŠ¨ã€‚ç¼–è¾‘æ–‡ä»¶ /etc/init.d/namedï¼Œå°†ä»¥ chkconfig å¼€å¤´çš„è¡Œçš„ S å‚æ•°ä» 13 æ›´æ”¹ä¸º 99ã€‚</p>



<p><strong>a)&nbsp;ä» chkconfig ç®¡ç†ä¸­åˆ é™¤å‘½åå®ˆæŠ¤è¿›ç¨‹</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;<code>chkconfig --del named</code></p>



<p><strong>b)&nbsp;ç¼–è¾‘ /etc/init.d/named å¹¶æ‰¾åˆ°ä»¥ #chkconfig å¼€å¤´çš„è¡Œï¼š- 13 87</strong></p>



<p>å°†æ•°å­— 13 æ”¹ä¸º 99ï¼Œè¿™æ ·å°†ä½¿ named å®ˆæŠ¤è¿›ç¨‹ä½œä¸º CentOS å¯åŠ¨è¿‡ç¨‹ä¸­çš„æœ€åä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹å¯åŠ¨ã€‚</p>



<p><strong>c)&nbsp;åœ¨ chkconfig å‘½ä»¤çš„ç®¡ç†ä¸‹æ·»åŠ å‘½åå®ˆæŠ¤è¿›ç¨‹ï¼Œå¹¶åœ¨æ‰€æœ‰è¿è¡Œçº§åˆ«å¯åŠ¨å®ƒ</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;<code>chkconfig --add named</code></p>



<p>[root@swouter-x86 ~]#&nbsp;chkconfig named on</p>



<p><strong>End.</strong></p>



<p>åœ¨ç¼–å†™æœ¬æ•™ç¨‹çš„è¿‡ç¨‹ä¸­å¤§é‡ä½¿ç”¨äº†ä»¥ä¸‹æ–‡ç« ã€‚</p>



<p>http://www.lamolabs.org/blog/282/how-to-setup-a-dns-server-on-centos-5/</p>



<p>http://www.linuxhomenetworking.com/wiki/index.php/Quick_HOWTO_:_Ch18_:_Configuring_DNS</p>



<p>http://www.labtestproject.com/linnet/dns-server.html</p>



<p>http://www.zaphu.com/2007/09/10/ubuntu-dns-server-guide-bind-caching-name-server-setup/</p>



<p>http://www.zaphu.com/2007/09/14/ubuntu-dns-server-guide-bind-master-server-setup/</p>



<p>http://h30499.www3.hp.com/t5/System-Administration/iptables-is-blocking-rndc/td-p/3034191</p>



<h1 class="wp-block-heading"><strong>ç¬¬ 9 éƒ¨åˆ† &#8211; DHCP å’Œ Samba æœåŠ¡å™¨çš„å®‰è£…å’Œé…ç½®</strong></h1>



<p>è¿™æ˜¯åœ¨ x86 ç¡¬ä»¶ä¸Šæ„å»º Linux ç¬¬ 3 å±‚äº¤æ¢æœºçš„ç³»åˆ—æ•™ç¨‹çš„æœ€åä¸€ç¯‡ã€‚æœ¬æ•™ç¨‹ä»‹ç»äº†å¦‚ä½•åœ¨ CentOS ä¸Šå®‰è£…å’Œé…ç½® DHCP æœåŠ¡å™¨ï¼Œä»¥ä¾¿ä¸º LAN ä¸Šçš„ä¸»æœºæä¾› IP åœ°å€ã€‚ç”±äºäº¤æ¢æœºæœ‰è¶³å¤Ÿçš„å¯ç”¨ç¡¬ç›˜ç©ºé—´ï¼Œæˆ‘ä»¬å°†å®‰è£…å’Œé…ç½® Samba æœåŠ¡å™¨ï¼Œä»¥ä¾¿ Windows ç”¨æˆ·è®¿é—®ä»–ä»¬çš„ä¸»ç›®å½•</p>



<h3 class="wp-block-heading"><strong>DHCP æœåŠ¡å™¨å®‰è£…å’Œé…ç½®</strong></h3>



<p><strong>1. å®‰è£…å¿…è¦çš„è½¯ä»¶åŒ…</strong></p>



<p>[root@swouter-x86 ~]#<strong>&nbsp;&nbsp;</strong>yum install dhcp</p>



<p><strong>2. é…ç½® DHCP æœåŠ¡å™¨</strong></p>



<p>å°†ä»¥ä¸‹è¡Œæ·»åŠ åˆ° /etc/dhcp/dhcpd.confã€‚</p>



<p>[root@swouter-x86 ~]#&nbsp;&nbsp;vi /etc/dhcp/dhcpd.conf</p>



<p>#DNS update schemes</p>



<p>ddns-update-style none;</p>



<p>#Ignore clients updates</p>



<p>ignore client-updates;</p>



<p>#Define interface on which is DHCP daemon listenning</p>



<p>DHCPARGS=vlan1;</p>



<p>subnet 172.18.0.0 netmask 255.255.0.0 {</p>



<p>&nbsp; &nbsp; &nbsp; &nbsp;option routers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 172.18.100.150;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# gateway on vlan1 internal interface</p>



<p>&nbsp; &nbsp; &nbsp; &nbsp;option subnet-mask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 255.255.0.0;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;# subnet mask</p>



<p>option domain-name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#8220;brezular.dyndns.org&#8221;; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;# domain name given to client</p>



<p>&nbsp; &nbsp; &nbsp; &nbsp;option domain-name-servers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 172.18.100.150;&nbsp; &nbsp;&nbsp;# the IP of our DNS server</p>



<p>&nbsp; &nbsp; &nbsp; &nbsp;option time-offset&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -18000;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;# Eastern Standard Time &#8211; set to what you have</p>



<p>&nbsp; &nbsp; &nbsp; &nbsp;option ntp-servers&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;172.18.100.150;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# the IP of our NTP server</p>



<p>&nbsp; &nbsp; &nbsp; &nbsp;range &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 172.18.0.1 172.18.99.255;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;# the first range of IP&#8217;s our clients will get</p>



<p>&nbsp; &nbsp; &nbsp; &nbsp;range &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; 172.18.101.0 172.18.255.254;&nbsp;&nbsp;# the second range of of IP&#8217;s our clients will get</p>



<p>&nbsp; &nbsp; &nbsp; &nbsp;default-lease-time 43200;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# how long the client&#8217;s will keep the same IP</p>



<p>&nbsp; &nbsp; &nbsp; &nbsp;max-lease-time 86400;</p>



<p>host DNS_server &nbsp; &nbsp; &nbsp;&nbsp;#reserved IP address</p>



<p>&nbsp; &nbsp; &nbsp; {</p>



<p>&nbsp; &nbsp; &nbsp; &nbsp; hardware ethernet 00:23:20:8D:B6:4C;</p>



<p>&nbsp; &nbsp; &nbsp; &nbsp; fixed-address 172.18.100.150;</p>



<p>&nbsp; &nbsp; &nbsp; }</p>



<p>host Linux_box&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#reserved IP address for host on LAN</p>



<p>&nbsp; &nbsp; &nbsp; {</p>



<p>&nbsp; &nbsp; &nbsp; &nbsp; hardware ethernet 00:13:E8:C1:FB:13;</p>



<p>&nbsp; &nbsp; &nbsp; &nbsp; fixed-address 172.18.100.141;</p>



<p>&nbsp; &nbsp; &nbsp; }</p>



<p>}</p>



<p><strong>4. æµ‹è¯•é…ç½®å¹¶å¯åŠ¨ dhcpd å®ˆæŠ¤è¿›ç¨‹</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;&nbsp;service dhcpd configtest</p>



<p>Syntax: OK</p>



<p>[root@swouter-x86 ~]#&nbsp;&nbsp;/etc/init.d/dhcpd start</p>



<p>Starting dhcpd: [&nbsp; OK&nbsp; ]</p>



<p><strong>5. ä½¿ DHCP å®ˆæŠ¤è¿›ç¨‹åœ¨å¯åŠ¨æ—¶å¯åŠ¨</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;&nbsp;chkconfig dhcpd on</p>



<p><strong>6. å…è®¸ DHCP æµé‡åˆ°è¾¾ DHCP æœåŠ¡å™¨</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;<code>iptables -A INPUT -i vlan1 -p udp --dport 67 -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#&nbsp;<code>iptables -A INPUT -i vlan1 -p udp --dport 68 -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#&nbsp;<code>iptables -A OUTPUT -o vlan1 -p udp --sport 67 -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#&nbsp;<code>iptables -A OUTPUT -o vlan1 -p udp --sport 68 -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#&nbsp;/etc/init.d/iptables save</p>



<h3 class="wp-block-heading">
<strong>Samba æœåŠ¡å™¨å®‰è£…å’Œé…</strong><strong>ç½®</strong>
</h3>



<p>ä¸ºäº†å…è®¸ LAN ä¸Šçš„ Windows ç”¨æˆ·è®¿é—® CentOS ä¸Šçš„ä¸»ç›®å½•ï¼Œæˆ‘ä»¬å¿…é¡»å®‰è£…å’Œé…ç½® Samba æœåŠ¡å™¨ã€‚</p>



<p><strong>1.&nbsp; å®‰è£… Samba æœåŠ¡å™¨</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;yum install samba</p>



<p><strong>2. åˆ›å»º Linux ç”¨æˆ· brezular</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;adduser brezular</p>



<p>User brezular uid=500 belonging to the group gid=500 has been created. The home directory is /home/brezular/</p>



<p>æ›´æ”¹ç”¨æˆ· brezular çš„å¯†ç ã€‚</p>



<p>root@swouter-x86 ~]#&nbsp;passwd brezular</p>



<p><strong>3. é…ç½® samba æœåŠ¡å™¨</strong></p>



<p><strong>a)&nbsp;ç¼–è¾‘ä¸»é…ç½®æ–‡ä»¶ /etc/samba/smb.conf</strong></p>



<p>æˆ‘ä»¬å¯ä»¥ä¸ä¿®æ”¹æ­¤æ–‡ä»¶ï¼Œå› ä¸ºå®ƒå®Œå…¨ç¬¦åˆæˆ‘ä»¬çš„éœ€æ±‚ã€‚å¦‚æœæˆ‘ä»¬æƒ³è®© CentOS åœ¨ Windows å·¥ä½œç»„ä¸­å¯è§ï¼Œæˆ‘ä»¬å¿…é¡»æ›´æ”¹å·¥ä½œç»„åç§°ã€‚ç”±äºæˆ‘ä»¬åœ¨ CentOS ä¸Šæ²¡æœ‰å®‰è£…ä»»ä½•æ‰“å°æœºï¼Œè¯·æ³¨é‡Šä»¥ [printers] å¼€å¤´çš„è¡Œ</p>



<p>[root@swouter-x86 ~]#&nbsp;&nbsp;vi /etc/samba/smb.conf</p>



<p>#Interface on which is Samba running</p>



<p>interfaces = lo, vlan1</p>



<p>#Name of our Windows workgroup</p>



<p>workgroup = Workgroup</p>



<p>#[printers]</p>



<p>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; comment = All Printers</p>



<p>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; path = /var/spool/samba</p>



<p>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; browseable = no</p>



<p>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; guest ok = no</p>



<p>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; writable = no</p>



<p>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printable = yes</p>



<p><strong>b)&nbsp;åˆ›å»º Samba ç”¨æˆ· brezular å¹¶è®¾ç½®ç”¨æˆ·å¯†ç </strong></p>



<p>[root@swouter-x86 ~]#&nbsp;smbpasswd -a brezular</p>



<p><strong>c)&nbsp;å¯åŠ¨ smb å®ˆæŠ¤è¿›ç¨‹å¹¶ä½¿å…¶åœ¨å¯åŠ¨æ—¶è‡ªåŠ¨å¯åŠ¨</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;/etc/init.d/smb start</p>



<p>[root@swouter-x86 ~]#&nbsp;chkconfig smb on</p>



<p><strong>4. é…ç½®é˜²ç«å¢™ä»¥å…è®¸å±€åŸŸç½‘ä¸Šçš„ä¸»æœºè®¿é—®ä»–ä»¬çš„ä¸»ç›®å½•</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;<code>iptables -A INPUT -i vlan1 -p tcp -m multiport --dport 137,138,139,445 -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#<code>iptables -A INPUT -i vlan1 -p udp -m multiport --dport 137,138,139,445 -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#<code>iptables -A OUTPUT -o vlan1 -p tcp -m multiport --sport 137,138,139,445 -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#<code>iptables -A OUTPUT -o vlan1 -p udp -m multiport --sport 137,138,139,445 -j ACCEPT</code></p>



<p>[root@swouter-x86 ~]#&nbsp;/etc/init.d/iptables save</p>



<p><strong>5. å°† SELinux ç­–ç•¥è®¾ç½®ä¸ºå…è®¸ Samba ç”¨æˆ·è®¿é—®ä»–ä»¬çš„ä¸»ç›®å½•</strong></p>



<p>[root@swouter-x86 ~]#&nbsp;setsebool -P samba_enable_home_dirs=1</p>



<p><strong>END.</strong></p>



<p>åœ¨ç¼–å†™æœ¬æ•™ç¨‹æ—¶ï¼Œä»¥ä¸‹æ–‡ç« è¢«å¹¿æ³›ä½¿ç”¨ã€‚</p>



<p>DHCP æœåŠ¡å™¨</p>



<p>http://www.linuxhelp.net/forums/Setup_Simple_Dhcp_Server_t4052.html</p>



<p>http://www.howtoforge.com/home-gateway-firewall-with-dhcp-server-for-connection-sharing-centos5</p>



<p>http://www.linuxjunkies.org/articles/dhcp-dejunkified.html</p>



<p>Samba æœåŠ¡å™¨</p>



<p>http://crazytoon.com/2007/05/22/samba-how-do-you-install-and-set-up-samba-in-linux-redhat-enterpriserhel-centos-fedora/</p>



<p>http://www.centos.org/docs/4/html/rhel-sag-en-4/s1-samba-configuring.html</p>



<p>http://troy.jdmz.net/samba/fw/</p>



<p>http://forums.fedoraforum.org/showthread.php?t=61018</p>



<p>http://www.redhatlinux.info/2011/11/configure-samba-server.html</p>
    </div>

    <!-- åº•éƒ¨å…ƒä¿¡æ¯ -->
    <div class="post-footmeta mb-4">
        <div class="row d-flex align-items-center">
            <div class="col-md-6 col-12">
                <div class="post-share justify-content-sm-start mb-3 mb-sm-0">
                    <div class="post-btnmeta">
                        <span class="post-like trans_2ms" :class="postMeta.postLike_on ? 'on' : ''" @click="_setlike"><i class="cxicon cxicon-zan-black"></i> <em style="font-style: normal" x-text="postMeta.postLike" x-show="postMeta.postLike !== 0"></em></span>
                    </div>
                    <i class="cxline-1"></i>
                    <ul class="social-icons" x-data="{'postThumb':'/wp-content/themes/meteor/assets/images/nothumb.png','postLink' : window.location.href, 'postTitle' : document.title}">
                        <li class="list-inline-item">
                            <a href="javascript:;" title="åˆ†äº«åˆ°å¾®ä¿¡" x-bind="weixinLink"><i class="cxicon cxicon-weixin"></i></a>
                        </li>
                        <li class="list-inline-item">
                            <a href="javascript:;" title="åˆ†äº«åˆ°å¾®åš" x-bind="weiboLink"><i class="cxicon cxicon-weibo"></i></a>
                        </li>
                        <li class="list-inline-item">
                            <a href="javascript:;" title="åˆ†äº«åˆ°QQ" x-bind="qqLink"><i class="cxicon cxicon-qq"></i></a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-md-6 col-12 text-center text-md-end">
                <div class="tags">
                                    </div>
            </div>
        </div>
    </div>

    <div class="about-author p-4 mt-5 flex-sm-row">
        <div class="thumb"><a class="author" href="/archives/author/guozhiman"><figure class="figure-avatar  btn-default userid-1"><img alt="" src="http://cn.cravatar.com/avatar/740a87cfff4579440e19183a73f02b68?s=100&#038;d=mm&#038;r=g" srcset="http://cn.cravatar.com/avatar/740a87cfff4579440e19183a73f02b68?s=200&#038;d=mm&#038;r=g 2x" class="avatar avatar-100 photo" height="100" width="100" decoding="async"></figure></a></div>        <div class="details ps-sm-4 mt-3 mt-sm-0 text-sm-start">
            <h4 class="name"><a href="/archives/author/guozhiman" title="æ–‡ç« ä½œè€… guozhiman" rel="author">guozhiman</a></h4>
            <p>æš‚æ— ä»‹ç»....</p>
            <ul class="social-icons list-unstyled list-inline mb-0">
                <!-- ç¤¾äº¤ä¿¡æ¯ -->
                <li class="list-inline-item">
                    <a href="#"><i class="cxicon cxicon-weixin"></i></a>
                </li>
                <li class="list-inline-item">
                    <a href="#" target="_blank"><i class="cxicon cxicon-weibo"></i></a>
                </li>
                <li class="list-inline-item">
                    <a href="#" target="_blank"><i class="cxicon cxicon-qq"></i></a>
                </li>
                <li class="list-inline-item">
                    <i class="cxline-1 ms-0 me-2"></i>
                    <a href="/archives/author/guozhiman" class="author-link">TAçš„ä¸»é¡µ <i class="cxicon cxicon-jtright font-inherit"></i></a>
                </li>
            </ul>
        </div>
    </div>

    <div class="row nextprev-post-wrapper mb-4">
        <div class="col-md-6 col-12 mb-3 mb-sm-0">
            <div class="nextprev-post prev">
                <span class="nextprev-text"> ä¸Šä¸€ç¯‡</span>
                <h5 class="post-title">
                    <a href="/archives/399" rel="prev">é€šå¤©æ˜ŸCMSV6 è½¦è½½è§†é¢‘ç›‘æ§å¹³å° ä¿¡æ¯æ³„éœ²æ¼æ´å¤ç°</a>                </h5>
            </div>
        </div>
        <div class="col-md-6 col-12">
            <div class="nextprev-post next text-sm-end">
                <span class="nextprev-text">ä¸‹ä¸€ç¯‡</span>
                <h5 class="post-title">
                    <a href="/archives/405" rel="next">å¸¦æœ‰ LXD å’Œ Multipass çš„å·¥ä½œç«™è™šæ‹Ÿæœº</a>                </h5>
            </div>
        </div>
    </div>

    <section class="comments">
        <!-- è¯„è®ºåŒºä»£ç  -->
    </section>

    <div class="mso nobg">
        <div class="module-tit item-center noborder">
            <h3 style="font-size:1rem">
<i class="cxline"></i>å»¶ä¼¸é˜…è¯»:</h3>
            <p></p>
        </div>
        <div class="module-content">
        <div class="item-jx item-blog small">
    <div class="jxbox">
        <div class="thumb">
            <a href="/archives/417">
                <div class="thumb-inner">
                    <img loading="lazy" decoding="async" src="/wp-content/uploads/2024/07/640-37.png" width="280" height="180" alt="OpenRestyå®æˆ˜ç³»åˆ— | å¼‚æ­¥éé˜»å¡HTTPå®¢æˆ·ç«¯åº“ Lua-Resty-Http">
                </div>
            </a> 
            <div class="sortbox">
                
                        <a href="/archives/category/%e6%8a%80%e6%9c%af%e6%96%87%e7%ab%a0" class="sort sort-5">æŠ€æœ¯æ–‡ç« </a>
                                    </div>                                           
        </div>
        <div class="subtitle">
            
            <!-- <p><span class="author">å°ç‰›çˆ±å¥‹æ–—</span>ï½œ<span class="time">2023.10.21</span></p> -->
            <h5><a href="/archives/417">OpenRestyå®æˆ˜ç³»åˆ— | å¼‚æ­¥éé˜»å¡HTTPå®¢æˆ·ç«¯åº“ Lua-Resty-Http</a></h5>
            <p class="pdesc">æ¦‚è¿° Lua-resty-http æ˜¯ä¸€ä¸ªåŸºäº OpenResty çš„ Lua åº“ï¼Œæ˜¯ OpenResty é¡¹ç›®ä¸­ä¸€ä¸ªé...</p>
            <div class="pmbox">
                <div class="l">
                    <a class="author" href="/archives/author/guozhiman"><figure class="figure-avatar  btn-default userid-1"><img alt="" src="http://cn.cravatar.com/avatar/740a87cfff4579440e19183a73f02b68?s=30&#038;d=mm&#038;r=g" srcset="http://cn.cravatar.com/avatar/740a87cfff4579440e19183a73f02b68?s=60&#038;d=mm&#038;r=g 2x" class="avatar avatar-30 photo" height="30" width="30" decoding="async"></figure>guozhiman</a> <i class="cxicon cxicon-dian color-grad"></i> <span class="time">2024å¹´7æœˆ22æ—¥</span>                </div>
                <div class="r">
                    <a href="/archives/417" class="more-link"><i class="cxicon cxicon-caidan-h"></i></a>
                </div>
                
            </div>
        </div>
    </div>
</div>
<div class="item-jx item-blog small">
    <div class="jxbox">
        <div class="thumb">
            <a href="/archives/407">
                <div class="thumb-inner">
                    <img loading="lazy" decoding="async" src="/wp-content/uploads/2024/07/640-2.jpeg" width="280" height="180" alt="æ ‘è“æ´¾ 4å®‰è£… OpenWrt">
                </div>
            </a> 
            <div class="sortbox">
                
                        <a href="/archives/category/%e6%8a%80%e6%9c%af%e6%96%87%e7%ab%a0" class="sort sort-5">æŠ€æœ¯æ–‡ç« </a>
                                    </div>                                           
        </div>
        <div class="subtitle">
            
            <!-- <p><span class="author">å°ç‰›çˆ±å¥‹æ–—</span>ï½œ<span class="time">2023.10.21</span></p> -->
            <h5><a href="/archives/407">æ ‘è“æ´¾ 4å®‰è£… OpenWrt</a></h5>
            <p class="pdesc">æ ‘è“æ´¾4Bæ¿å­ä¸Šçš„å„ä¸ªéƒ¨ä»¶ï¼šæ ‘è“æ´¾4Båˆ·OpenWRTæˆä¸ºè½¯è·¯ç”±åï¼šæˆ‘çš„é‡‡è´­æ¸…å•ï¼š è¦æ¯”è¾ƒå®Œç¾çš„åœ¨æ ‘è“æ´¾ä¸Šå®‰è£…Openw...</p>
            <div class="pmbox">
                <div class="l">
                    <a class="author" href="/archives/author/guozhiman"><figure class="figure-avatar  btn-default userid-1"><img alt="" src="http://cn.cravatar.com/avatar/740a87cfff4579440e19183a73f02b68?s=30&#038;d=mm&#038;r=g" srcset="http://cn.cravatar.com/avatar/740a87cfff4579440e19183a73f02b68?s=60&#038;d=mm&#038;r=g 2x" class="avatar avatar-30 photo" height="30" width="30" loading="lazy" decoding="async"></figure>guozhiman</a> <i class="cxicon cxicon-dian color-grad"></i> <span class="time">2024å¹´7æœˆ22æ—¥</span>                </div>
                <div class="r">
                    <a href="/archives/407" class="more-link"><i class="cxicon cxicon-caidan-h"></i></a>
                </div>
                
            </div>
        </div>
    </div>
</div>
<div class="item-jx item-blog small">
    <div class="jxbox">
        <div class="thumb">
            <a href="/archives/405">
                <div class="thumb-inner">
                    <img loading="lazy" decoding="async" src="/wp-content/uploads/2024/07/640-10.jpeg" width="280" height="180" alt="å¸¦æœ‰ LXD å’Œ Multipass çš„å·¥ä½œç«™è™šæ‹Ÿæœº">
                </div>
            </a> 
            <div class="sortbox">
                
                        <a href="/archives/category/%e6%8a%80%e6%9c%af%e6%96%87%e7%ab%a0" class="sort sort-5">æŠ€æœ¯æ–‡ç« </a>
                                    </div>                                           
        </div>
        <div class="subtitle">
            
            <!-- <p><span class="author">å°ç‰›çˆ±å¥‹æ–—</span>ï½œ<span class="time">2023.10.21</span></p> -->
            <h5><a href="/archives/405">å¸¦æœ‰ LXD å’Œ Multipass çš„å·¥ä½œç«™è™šæ‹Ÿæœº</a></h5>
            <p class="pdesc">ç›®å½• ä»‹ç» å®‰è£… / åˆ†é… ä½¿ç”¨Â Multipass æŒ‰éœ€è·å– Ubuntu LXDâ€¦â€¦ç”¨äºè™šæ‹Ÿæœºï¼Ÿ LXDÂ æ¡Œé¢è™šæ‹Ÿæœº...</p>
            <div class="pmbox">
                <div class="l">
                    <a class="author" href="/archives/author/guozhiman"><figure class="figure-avatar  btn-default userid-1"><img alt="" src="http://cn.cravatar.com/avatar/740a87cfff4579440e19183a73f02b68?s=30&#038;d=mm&#038;r=g" srcset="http://cn.cravatar.com/avatar/740a87cfff4579440e19183a73f02b68?s=60&#038;d=mm&#038;r=g 2x" class="avatar avatar-30 photo" height="30" width="30" loading="lazy" decoding="async"></figure>guozhiman</a> <i class="cxicon cxicon-dian color-grad"></i> <span class="time">2024å¹´7æœˆ22æ—¥</span>                </div>
                <div class="r">
                    <a href="/archives/405" class="more-link"><i class="cxicon cxicon-caidan-h"></i></a>
                </div>
                
            </div>
        </div>
    </div>
</div>
<div class="item-jx item-blog small">
    <div class="jxbox">
        <div class="thumb">
            <a href="/archives/403">
                <div class="thumb-inner">
                    <img loading="lazy" decoding="async" src="/wp-content/themes/meteor/assets/images/nothumb.png" width="280" height="180" alt="åœ¨ x86 ä¸Šæ„å»º Linux L3 äº¤æ¢æœº/è·¯ç”±å™¨">
                </div>
            </a> 
            <div class="sortbox">
                
                        <a href="/archives/category/%e6%8a%80%e6%9c%af%e6%96%87%e7%ab%a0" class="sort sort-5">æŠ€æœ¯æ–‡ç« </a>
                                    </div>                                           
        </div>
        <div class="subtitle">
            
            <!-- <p><span class="author">å°ç‰›çˆ±å¥‹æ–—</span>ï½œ<span class="time">2023.10.21</span></p> -->
            <h5><a href="/archives/403">åœ¨ x86 ä¸Šæ„å»º Linux L3 äº¤æ¢æœº/è·¯ç”±å™¨</a></h5>
            <p class="pdesc">ç¬¬ 1 éƒ¨åˆ† - ä»‹ç» 1.&nbsp;æ„å»º L3 äº¤æ¢æœºçš„æ•™ç¨‹éƒ½æä¾›äº†ä»€ä¹ˆå†…å®¹ï¼Ÿ å¦ç™½åœ°è¯´ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨æƒ³...</p>
            <div class="pmbox">
                <div class="l">
                    <a class="author" href="/archives/author/guozhiman"><figure class="figure-avatar  btn-default userid-1"><img alt="" src="http://cn.cravatar.com/avatar/740a87cfff4579440e19183a73f02b68?s=30&#038;d=mm&#038;r=g" srcset="http://cn.cravatar.com/avatar/740a87cfff4579440e19183a73f02b68?s=60&#038;d=mm&#038;r=g 2x" class="avatar avatar-30 photo" height="30" width="30" loading="lazy" decoding="async"></figure>guozhiman</a> <i class="cxicon cxicon-dian color-grad"></i> <span class="time">2024å¹´7æœˆ22æ—¥</span>                </div>
                <div class="r">
                    <a href="/archives/403" class="more-link"><i class="cxicon cxicon-caidan-h"></i></a>
                </div>
                
            </div>
        </div>
    </div>
</div>        </div>
    </div>
</article>                    </div>
                </div>
            </div>
            
            <div class="col-right" id="sidebar">
    <div class="rowright">
        <aside class="side-area">
            <div class="widget widget_block widget_search"><form role="search" method="get" action="/" class="wp-block-search__button-outside wp-block-search__text-button wp-block-search">
<label class="wp-block-search__label" for="wp-block-search__input-1">æœç´¢</label><div class="wp-block-search__inside-wrapper ">
<input class="wp-block-search__input" id="wp-block-search__input-1" placeholder="" value="" type="search" name="s" required><button aria-label="æœç´¢" class="wp-block-search__button wp-element-button" type="submit">æœç´¢</button>
</div>
</form></div>
<div class="widget widget_block">
<div class="wp-block-group"><div class="wp-block-group__inner-container is-layout-flow wp-block-group-is-layout-flow">
<h2 class="wp-block-heading">è¿‘æœŸæ–‡ç« </h2>


<ul class="wp-block-latest-posts__list wp-block-latest-posts">
<li><a class="wp-block-latest-posts__post-title" href="/archives/417">OpenRestyå®æˆ˜ç³»åˆ— | å¼‚æ­¥éé˜»å¡HTTPå®¢æˆ·ç«¯åº“ Lua-Resty-Http</a></li>
<li><a class="wp-block-latest-posts__post-title" href="/archives/415">GitHubä¸Šçš„å®è—ï¼šä¸€å¥—å…è´¹ã€å¼€æºçš„åŒ»é™¢ç®¡ç†ç³»ç»Ÿ</a></li>
<li><a class="wp-block-latest-posts__post-title" href="/archives/413">å¼€æºè¿œç¨‹æ¡Œé¢ï¼ŒTeamViewer çš„æ›¿ä»£å“</a></li>
<li><a class="wp-block-latest-posts__post-title" href="/archives/411">å…è´¹ï¼å°åŒºç‰©ä¸šç®¡ç†ç³»ç»Ÿ å¼€æº</a></li>
<li><a class="wp-block-latest-posts__post-title" href="/archives/409">ä¸€æ¬¾å¼€æºçš„è®¾å¤‡èµ„äº§ç®¡ç†ç³»ç»Ÿ</a></li>
</ul>
</div></div>
</div>
<div class="widget widget_block">
<div class="wp-block-group"><div class="wp-block-group__inner-container is-layout-flow wp-block-group-is-layout-flow">
<h2 class="wp-block-heading">è¿‘æœŸè¯„è®º</h2>


<div class="no-comments wp-block-latest-comments">æ²¡æœ‰è¯„è®ºå¯æ˜¾ç¤ºã€‚</div>
</div></div>
</div>
<div class="widget widget_block">
<div class="wp-block-group"><div class="wp-block-group__inner-container is-layout-flow wp-block-group-is-layout-flow">
<h2 class="wp-block-heading">åˆ†ç±»</h2>


<ul class="wp-block-categories-list wp-block-categories">	<li class="cat-item cat-item-4">
<a href="/archives/category/docker">Docker</a>
</li>
	<li class="cat-item cat-item-10">
<a href="/archives/category/caozuoxitong/linuxunix">Linux/Unix</a>
</li>
	<li class="cat-item cat-item-9">
<a href="/archives/category/caozuoxitong/windows">Winç³»ç»Ÿ</a>
</li>
	<li class="cat-item cat-item-3">
<a href="/archives/category/qianduan">å‰ç«¯</a>
</li>
	<li class="cat-item cat-item-1">
<a href="/archives/category/kaiyuan">å¼€æº</a>
</li>
	<li class="cat-item cat-item-5">
<a href="/archives/category/%e6%8a%80%e6%9c%af%e6%96%87%e7%ab%a0">æŠ€æœ¯æ–‡ç« </a>
</li>
	<li class="cat-item cat-item-6">
<a href="/archives/category/meirifenxiang">æ¯æ—¥åˆ†äº«</a>
</li>
	<li class="cat-item cat-item-7">
<a href="/archives/category/wangluoanquan">ç½‘ç»œå®‰å…¨</a>
</li>
</ul>
</div></div>
</div>        </aside>
    </div>
</div>        </div>
    </div>
</section>
<!-- 3.end -->

        </main><!-- main.end -->

        <footer class="footer-s1">
            <div class="linebox bg-auto"></div>
            <div class="foottop">
                <div class="container-xl">
                    <div class="footmain-box">
                        <div class="aboutus_link">
<a href="https://www.baidu.com/" target="_blank">ç™¾åº¦ä¸€ä¸‹</a><a href="https://yunsuo.qianxin.com/" target="_blank">äº‘é”</a><a href="https://www.d99net.net/" target="_blank">Dç›¾</a>
</div>
<div class="footer-desc">å…è´£å£°æ˜ï¼šæœ¬ç½‘ç«™éƒ¨åˆ†å†…å®¹ç”±ç”¨æˆ·è‡ªè¡Œä¸Šä¼ ï¼Œå¦‚æƒåˆ©äººå‘ç°å­˜åœ¨è¯¯ä¼ å…¶ä½œå“æƒ…å½¢ï¼Œè¯·åŠæ—¶ä¸æœ¬ç«™è”ç³»ã€‚</div>
<div class="foot-copyright">éƒ­æ™ºæ»¡ Â© 2024. All Rights Reserved</div>                    </div>
                </div>
            </div>
        </footer>
        <!-- å¼¹å‡ºå±‚ä»£ç  -->
        <div class="popbg-box trans_2ms" :class="{'visible': popBgshow}" @click="popBgshow = moibleMenu = false"></div>
        <div class="search-popup trans_2ms" :class="{'visible': searchPopup}">
            <button type="button" class="btn-close " aria-label="Close" @click="searchPopup = false"></button>
            <div class="search-content">
                <div class="search-form-box">
                    <form class="d-flex search-form" method="get" action="">
                        <input class="form-control me-2" placeholder="æœç´¢å¹¶æŒ‰å›è½¦é”®..." type="text" name="s" id="search" value="" aria-label="æœç´¢">
                        <button class="btn btn-default btn-lg" type="submit" style="padding: 9.5px 36px;"><i class="cxicon cxicon-search"></i></button>
                    </form>
                </div>
                
            </div>
        </div>
        <!-- .end -->
        </div>
        <!--.sit-wrapper-->
        <script type="text/javascript" src="/wp-content/themes/meteor/assets/js/swiper-bundle.min.js?ver=1.2" id="cxm2-swiper-js"></script>
<script type="text/javascript" src="/wp-content/themes/meteor/assets/js/plugins.min.js?ver=1.2" id="cxm2-plugins-js"></script>
<script type="text/javascript" id="cxm2-alpine-js-extra">
/* <![CDATA[ */
var cxjs = {"homeurl":"","jsonapi":"\/wp-json\/cxv1\/","themedir":"\/wp-content\/themes\/meteor","ajaxurl":"\/wp-admin\/admin-ajax.php","postId":"403"};
/* ]]> */
</script>
<script type="text/javascript" src="/wp-content/themes/meteor/assets/js/alpine.min.js?ver=3.13.10" id="cxm2-alpine-js"></script>
        </body>

        </html>